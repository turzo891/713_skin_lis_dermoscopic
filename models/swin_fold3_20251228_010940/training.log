2025-12-28 01:09:40 - INFO - Logging initialized. Log file: models/swin_fold3_20251228_010940/training.log
2025-12-28 01:09:40 - INFO - ================================================================================
2025-12-28 01:09:40 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-28 01:09:40 - INFO - ================================================================================
2025-12-28 01:09:40 - INFO - Model: swin
2025-12-28 01:09:40 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-28 01:09:40 - INFO - Fold: 3
2025-12-28 01:09:40 - INFO - Batch size: 16
2025-12-28 01:09:40 - INFO - Effective batch size: 16
2025-12-28 01:09:40 - INFO - Epochs: 50
2025-12-28 01:09:40 - INFO - Learning rate: 0.0001
2025-12-28 01:09:40 - INFO - Workers: 8
2025-12-28 01:09:40 - INFO - Mixed precision: True
2025-12-28 01:09:40 - INFO - Gradient accumulation: 1
2025-12-28 01:09:40 - INFO - Prefetch factor: 2
2025-12-28 01:09:40 - INFO - Focal loss: True
2025-12-28 01:09:40 - INFO - Skin tone sampling: True
2025-12-28 01:09:40 - INFO - Device: cuda
2025-12-28 01:09:40 - INFO - Output: models/swin_fold3_20251228_010940
2025-12-28 01:09:40 - INFO - ================================================================================
2025-12-28 01:09:40 - INFO - 
Creating data loaders...
2025-12-28 01:09:41 - INFO - Train samples: 21936
2025-12-28 01:09:41 - INFO - Val samples: 2438
2025-12-28 01:09:41 - INFO - 
Creating swin model...
2025-12-28 01:09:53 - INFO - 
Starting training...

2025-12-28 01:15:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:15:08 - INFO - 
Epoch 1/50 - 315.25s
2025-12-28 01:15:08 - INFO -   Train Loss: 0.3775, Train Acc: 0.6844
2025-12-28 01:15:08 - INFO -   Val Loss: 0.3501
2025-12-28 01:15:08 - INFO -   Val Accuracy: 0.6153
2025-12-28 01:15:08 - INFO -   Val Balanced Acc: 0.6427
2025-12-28 01:15:08 - INFO -   Val F1 (weighted): 0.6363
2025-12-28 01:15:08 - INFO -   Val F1 (macro): 0.5354
2025-12-28 01:15:08 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:15:08 - INFO -   LR: 0.000100
2025-12-28 01:15:09 - INFO -   Saved best model (balanced_accuracy: 0.6427)
2025-12-28 01:20:24 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:20:24 - INFO - 
Epoch 2/50 - 314.58s
2025-12-28 01:20:24 - INFO -   Train Loss: 0.2116, Train Acc: 0.7968
2025-12-28 01:20:24 - INFO -   Val Loss: 0.3026
2025-12-28 01:20:24 - INFO -   Val Accuracy: 0.6497
2025-12-28 01:20:24 - INFO -   Val Balanced Acc: 0.6975
2025-12-28 01:20:24 - INFO -   Val F1 (weighted): 0.6711
2025-12-28 01:20:24 - INFO -   Val F1 (macro): 0.5667
2025-12-28 01:20:24 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:20:24 - INFO -   LR: 0.000100
2025-12-28 01:20:26 - INFO -   Saved best model (balanced_accuracy: 0.6975)
2025-12-28 01:25:40 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:25:40 - INFO - 
Epoch 3/50 - 314.45s
2025-12-28 01:25:40 - INFO -   Train Loss: 0.1533, Train Acc: 0.8446
2025-12-28 01:25:40 - INFO -   Val Loss: 0.4332
2025-12-28 01:25:40 - INFO -   Val Accuracy: 0.4930
2025-12-28 01:25:40 - INFO -   Val Balanced Acc: 0.6203
2025-12-28 01:25:40 - INFO -   Val F1 (weighted): 0.4890
2025-12-28 01:25:40 - INFO -   Val F1 (macro): 0.4945
2025-12-28 01:25:40 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:25:40 - INFO -   LR: 0.000099
2025-12-28 01:25:40 - INFO -   No improvement (patience: 1/10)
2025-12-28 01:30:54 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:30:54 - INFO - 
Epoch 4/50 - 313.94s
2025-12-28 01:30:54 - INFO -   Train Loss: 0.1383, Train Acc: 0.8550
2025-12-28 01:30:54 - INFO -   Val Loss: 0.3008
2025-12-28 01:30:54 - INFO -   Val Accuracy: 0.6251
2025-12-28 01:30:54 - INFO -   Val Balanced Acc: 0.6669
2025-12-28 01:30:54 - INFO -   Val F1 (weighted): 0.6458
2025-12-28 01:30:54 - INFO -   Val F1 (macro): 0.5762
2025-12-28 01:30:54 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:30:54 - INFO -   LR: 0.000098
2025-12-28 01:30:54 - INFO -   No improvement (patience: 2/10)
2025-12-28 01:36:06 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:36:06 - INFO - 
Epoch 5/50 - 311.82s
2025-12-28 01:36:06 - INFO -   Train Loss: 0.1172, Train Acc: 0.8704
2025-12-28 01:36:06 - INFO -   Val Loss: 0.2711
2025-12-28 01:36:06 - INFO -   Val Accuracy: 0.6128
2025-12-28 01:36:06 - INFO -   Val Balanced Acc: 0.6793
2025-12-28 01:36:06 - INFO -   Val F1 (weighted): 0.6267
2025-12-28 01:36:06 - INFO -   Val F1 (macro): 0.6228
2025-12-28 01:36:06 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:36:06 - INFO -   LR: 0.000098
2025-12-28 01:36:06 - INFO -   No improvement (patience: 3/10)
2025-12-28 01:41:18 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:41:18 - INFO - 
Epoch 6/50 - 311.83s
2025-12-28 01:41:18 - INFO -   Train Loss: 0.1005, Train Acc: 0.8898
2025-12-28 01:41:18 - INFO -   Val Loss: 0.3392
2025-12-28 01:41:18 - INFO -   Val Accuracy: 0.5336
2025-12-28 01:41:18 - INFO -   Val Balanced Acc: 0.6670
2025-12-28 01:41:18 - INFO -   Val F1 (weighted): 0.5481
2025-12-28 01:41:18 - INFO -   Val F1 (macro): 0.5554
2025-12-28 01:41:18 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:41:18 - INFO -   LR: 0.000096
2025-12-28 01:41:18 - INFO -   No improvement (patience: 4/10)
2025-12-28 01:46:29 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:46:29 - INFO - 
Epoch 7/50 - 311.63s
2025-12-28 01:46:29 - INFO -   Train Loss: 0.0906, Train Acc: 0.8955
2025-12-28 01:46:29 - INFO -   Val Loss: 0.2893
2025-12-28 01:46:29 - INFO -   Val Accuracy: 0.6653
2025-12-28 01:46:29 - INFO -   Val Balanced Acc: 0.6734
2025-12-28 01:46:29 - INFO -   Val F1 (weighted): 0.6767
2025-12-28 01:46:29 - INFO -   Val F1 (macro): 0.6268
2025-12-28 01:46:29 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:46:29 - INFO -   LR: 0.000095
2025-12-28 01:46:29 - INFO -   No improvement (patience: 5/10)
2025-12-28 01:51:41 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:51:41 - INFO - 
Epoch 8/50 - 311.72s
2025-12-28 01:51:41 - INFO -   Train Loss: 0.0825, Train Acc: 0.9067
2025-12-28 01:51:41 - INFO -   Val Loss: 0.2496
2025-12-28 01:51:41 - INFO -   Val Accuracy: 0.6817
2025-12-28 01:51:41 - INFO -   Val Balanced Acc: 0.6779
2025-12-28 01:51:41 - INFO -   Val F1 (weighted): 0.6972
2025-12-28 01:51:41 - INFO -   Val F1 (macro): 0.6200
2025-12-28 01:51:41 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:51:41 - INFO -   LR: 0.000094
2025-12-28 01:51:41 - INFO -   No improvement (patience: 6/10)
2025-12-28 01:56:55 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 01:56:55 - INFO - 
Epoch 9/50 - 314.05s
2025-12-28 01:56:55 - INFO -   Train Loss: 0.0740, Train Acc: 0.9106
2025-12-28 01:56:55 - INFO -   Val Loss: 0.2538
2025-12-28 01:56:55 - INFO -   Val Accuracy: 0.6998
2025-12-28 01:56:55 - INFO -   Val Balanced Acc: 0.6890
2025-12-28 01:56:55 - INFO -   Val F1 (weighted): 0.7070
2025-12-28 01:56:55 - INFO -   Val F1 (macro): 0.6205
2025-12-28 01:56:55 - INFO -   Val AUC (macro): 0.0000
2025-12-28 01:56:55 - INFO -   LR: 0.000092
2025-12-28 01:56:55 - INFO -   No improvement (patience: 7/10)
2025-12-28 02:03:44 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:03:44 - INFO - 
Epoch 10/50 - 409.16s
2025-12-28 02:03:44 - INFO -   Train Loss: 0.0685, Train Acc: 0.9173
2025-12-28 02:03:44 - INFO -   Val Loss: 0.3140
2025-12-28 02:03:44 - INFO -   Val Accuracy: 0.6961
2025-12-28 02:03:44 - INFO -   Val Balanced Acc: 0.6531
2025-12-28 02:03:44 - INFO -   Val F1 (weighted): 0.7021
2025-12-28 02:03:44 - INFO -   Val F1 (macro): 0.6432
2025-12-28 02:03:44 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:03:44 - INFO -   LR: 0.000090
2025-12-28 02:03:44 - INFO -   No improvement (patience: 8/10)
2025-12-28 02:13:46 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:13:46 - INFO - 
Epoch 11/50 - 601.52s
2025-12-28 02:13:46 - INFO -   Train Loss: 0.0624, Train Acc: 0.9239
2025-12-28 02:13:46 - INFO -   Val Loss: 0.3106
2025-12-28 02:13:46 - INFO -   Val Accuracy: 0.6189
2025-12-28 02:13:46 - INFO -   Val Balanced Acc: 0.6926
2025-12-28 02:13:46 - INFO -   Val F1 (weighted): 0.6268
2025-12-28 02:13:46 - INFO -   Val F1 (macro): 0.5973
2025-12-28 02:13:46 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:13:46 - INFO -   LR: 0.000089
2025-12-28 02:13:46 - INFO -   No improvement (patience: 9/10)
2025-12-28 02:23:24 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:23:24 - INFO - 
Epoch 12/50 - 577.99s
2025-12-28 02:23:24 - INFO -   Train Loss: 0.0564, Train Acc: 0.9286
2025-12-28 02:23:24 - INFO -   Val Loss: 0.2913
2025-12-28 02:23:24 - INFO -   Val Accuracy: 0.6764
2025-12-28 02:23:24 - INFO -   Val Balanced Acc: 0.6940
2025-12-28 02:23:24 - INFO -   Val F1 (weighted): 0.6877
2025-12-28 02:23:24 - INFO -   Val F1 (macro): 0.6271
2025-12-28 02:23:24 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:23:24 - INFO -   LR: 0.000086
2025-12-28 02:23:24 - INFO -   No improvement (patience: 10/10)
2025-12-28 02:23:24 - INFO - 
Early stopping at epoch 12
2025-12-28 02:23:24 - INFO - 
================================================================================
2025-12-28 02:23:24 - INFO - TRAINING COMPLETE
2025-12-28 02:23:24 - INFO - ================================================================================
2025-12-28 02:23:24 - INFO - Total time: 73.52 minutes
2025-12-28 02:23:24 - INFO - Best balanced_accuracy: 0.6975 (epoch 2)
2025-12-28 02:23:24 - INFO - Average time per epoch: 367.59 seconds
2025-12-28 02:23:24 - INFO - Model saved to: models/swin_fold3_20251228_010940
2025-12-28 02:23:24 - INFO - 
Results saved to: models/swin_fold3_20251228_010940/final_results.json
