2025-12-24 03:49:11 - INFO - Logging initialized. Log file: models/resnet50_fold5_20251224_034911/training.log
2025-12-24 03:49:12 - INFO - ================================================================================
2025-12-24 03:49:12 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-24 03:49:12 - INFO - ================================================================================
2025-12-24 03:49:12 - INFO - Model: resnet50
2025-12-24 03:49:12 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-24 03:49:12 - INFO - Fold: 5
2025-12-24 03:49:12 - INFO - Batch size: 32
2025-12-24 03:49:12 - INFO - Effective batch size: 32
2025-12-24 03:49:12 - INFO - Epochs: 50
2025-12-24 03:49:12 - INFO - Learning rate: 0.0001
2025-12-24 03:49:12 - INFO - Workers: 8
2025-12-24 03:49:12 - INFO - Mixed precision: True
2025-12-24 03:49:12 - INFO - Gradient accumulation: 1
2025-12-24 03:49:12 - INFO - Prefetch factor: 2
2025-12-24 03:49:12 - INFO - Focal loss: True
2025-12-24 03:49:12 - INFO - Skin tone sampling: True
2025-12-24 03:49:12 - INFO - Device: cuda
2025-12-24 03:49:12 - INFO - Output: models/resnet50_fold5_20251224_034911
2025-12-24 03:49:12 - INFO - ================================================================================
2025-12-24 03:49:12 - INFO - 
Creating data loaders...
2025-12-24 03:49:12 - INFO - Train samples: 21937
2025-12-24 03:49:12 - INFO - Val samples: 2437
2025-12-24 03:49:12 - INFO - 
Creating resnet50 model...
2025-12-24 03:49:13 - INFO - 
Starting training...

2025-12-24 03:49:53 - INFO - 
Epoch 1/50 - 40.42s
2025-12-24 03:49:53 - INFO -   Train Loss: 0.4613, Train Acc: 0.6504
2025-12-24 03:49:53 - INFO -   Val Loss: 0.3939
2025-12-24 03:49:53 - INFO -   Val Accuracy: 0.5458
2025-12-24 03:49:53 - INFO -   Val Balanced Acc: 0.6140
2025-12-24 03:49:53 - INFO -   Val F1 (weighted): 0.5693
2025-12-24 03:49:53 - INFO -   Val F1 (macro): 0.4746
2025-12-24 03:49:53 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:49:53 - INFO -   LR: 0.000100
2025-12-24 03:49:54 - INFO -   Saved best model (balanced_accuracy: 0.6140)
2025-12-24 03:50:33 - INFO - 
Epoch 2/50 - 39.54s
2025-12-24 03:50:33 - INFO -   Train Loss: 0.2340, Train Acc: 0.7855
2025-12-24 03:50:33 - INFO -   Val Loss: 0.3107
2025-12-24 03:50:33 - INFO -   Val Accuracy: 0.6368
2025-12-24 03:50:33 - INFO -   Val Balanced Acc: 0.6378
2025-12-24 03:50:33 - INFO -   Val F1 (weighted): 0.6520
2025-12-24 03:50:33 - INFO -   Val F1 (macro): 0.5519
2025-12-24 03:50:33 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:50:33 - INFO -   LR: 0.000100
2025-12-24 03:50:34 - INFO -   Saved best model (balanced_accuracy: 0.6378)
2025-12-24 03:51:13 - INFO - 
Epoch 3/50 - 39.40s
2025-12-24 03:51:13 - INFO -   Train Loss: 0.1757, Train Acc: 0.8263
2025-12-24 03:51:13 - INFO -   Val Loss: 0.2984
2025-12-24 03:51:13 - INFO -   Val Accuracy: 0.6565
2025-12-24 03:51:13 - INFO -   Val Balanced Acc: 0.6879
2025-12-24 03:51:13 - INFO -   Val F1 (weighted): 0.6730
2025-12-24 03:51:13 - INFO -   Val F1 (macro): 0.6015
2025-12-24 03:51:13 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:51:13 - INFO -   LR: 0.000099
2025-12-24 03:51:14 - INFO -   Saved best model (balanced_accuracy: 0.6879)
2025-12-24 03:51:55 - INFO - 
Epoch 4/50 - 41.24s
2025-12-24 03:51:55 - INFO -   Train Loss: 0.1377, Train Acc: 0.8576
2025-12-24 03:51:55 - INFO -   Val Loss: 0.2936
2025-12-24 03:51:55 - INFO -   Val Accuracy: 0.6315
2025-12-24 03:51:55 - INFO -   Val Balanced Acc: 0.6830
2025-12-24 03:51:55 - INFO -   Val F1 (weighted): 0.6520
2025-12-24 03:51:55 - INFO -   Val F1 (macro): 0.5606
2025-12-24 03:51:55 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:51:55 - INFO -   LR: 0.000098
2025-12-24 03:51:55 - INFO -   No improvement (patience: 1/10)
2025-12-24 03:52:35 - INFO - 
Epoch 5/50 - 40.36s
2025-12-24 03:52:35 - INFO -   Train Loss: 0.1162, Train Acc: 0.8757
2025-12-24 03:52:35 - INFO -   Val Loss: 0.3109
2025-12-24 03:52:35 - INFO -   Val Accuracy: 0.6348
2025-12-24 03:52:35 - INFO -   Val Balanced Acc: 0.6970
2025-12-24 03:52:35 - INFO -   Val F1 (weighted): 0.6569
2025-12-24 03:52:35 - INFO -   Val F1 (macro): 0.5825
2025-12-24 03:52:35 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:52:35 - INFO -   LR: 0.000098
2025-12-24 03:52:36 - INFO -   Saved best model (balanced_accuracy: 0.6970)
2025-12-24 03:53:17 - INFO - 
Epoch 6/50 - 41.40s
2025-12-24 03:53:17 - INFO -   Train Loss: 0.1013, Train Acc: 0.8890
2025-12-24 03:53:17 - INFO -   Val Loss: 0.2779
2025-12-24 03:53:17 - INFO -   Val Accuracy: 0.6574
2025-12-24 03:53:17 - INFO -   Val Balanced Acc: 0.6991
2025-12-24 03:53:17 - INFO -   Val F1 (weighted): 0.6708
2025-12-24 03:53:17 - INFO -   Val F1 (macro): 0.6181
2025-12-24 03:53:17 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:53:17 - INFO -   LR: 0.000096
2025-12-24 03:53:18 - INFO -   Saved best model (balanced_accuracy: 0.6991)
2025-12-24 03:53:59 - INFO - 
Epoch 7/50 - 41.62s
2025-12-24 03:53:59 - INFO -   Train Loss: 0.0897, Train Acc: 0.8966
2025-12-24 03:53:59 - INFO -   Val Loss: 0.2921
2025-12-24 03:53:59 - INFO -   Val Accuracy: 0.6496
2025-12-24 03:53:59 - INFO -   Val Balanced Acc: 0.7183
2025-12-24 03:53:59 - INFO -   Val F1 (weighted): 0.6681
2025-12-24 03:53:59 - INFO -   Val F1 (macro): 0.6004
2025-12-24 03:53:59 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:53:59 - INFO -   LR: 0.000095
2025-12-24 03:54:00 - INFO -   Saved best model (balanced_accuracy: 0.7183)
2025-12-24 03:54:40 - INFO - 
Epoch 8/50 - 40.05s
2025-12-24 03:54:40 - INFO -   Train Loss: 0.0806, Train Acc: 0.9065
2025-12-24 03:54:40 - INFO -   Val Loss: 0.2883
2025-12-24 03:54:40 - INFO -   Val Accuracy: 0.6553
2025-12-24 03:54:40 - INFO -   Val Balanced Acc: 0.7057
2025-12-24 03:54:40 - INFO -   Val F1 (weighted): 0.6721
2025-12-24 03:54:40 - INFO -   Val F1 (macro): 0.6066
2025-12-24 03:54:40 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:54:40 - INFO -   LR: 0.000094
2025-12-24 03:54:40 - INFO -   No improvement (patience: 1/10)
2025-12-24 03:55:19 - INFO - 
Epoch 9/50 - 39.51s
2025-12-24 03:55:19 - INFO -   Train Loss: 0.0675, Train Acc: 0.9189
2025-12-24 03:55:19 - INFO -   Val Loss: 0.2880
2025-12-24 03:55:19 - INFO -   Val Accuracy: 0.6167
2025-12-24 03:55:19 - INFO -   Val Balanced Acc: 0.6845
2025-12-24 03:55:19 - INFO -   Val F1 (weighted): 0.6318
2025-12-24 03:55:19 - INFO -   Val F1 (macro): 0.5903
2025-12-24 03:55:19 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:55:19 - INFO -   LR: 0.000092
2025-12-24 03:55:19 - INFO -   No improvement (patience: 2/10)
2025-12-24 03:55:58 - INFO - 
Epoch 10/50 - 38.51s
2025-12-24 03:55:58 - INFO -   Train Loss: 0.0638, Train Acc: 0.9204
2025-12-24 03:55:58 - INFO -   Val Loss: 0.2749
2025-12-24 03:55:58 - INFO -   Val Accuracy: 0.6668
2025-12-24 03:55:58 - INFO -   Val Balanced Acc: 0.7263
2025-12-24 03:55:58 - INFO -   Val F1 (weighted): 0.6798
2025-12-24 03:55:58 - INFO -   Val F1 (macro): 0.6241
2025-12-24 03:55:58 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:55:58 - INFO -   LR: 0.000090
2025-12-24 03:55:58 - INFO -   Saved best model (balanced_accuracy: 0.7263)
2025-12-24 03:56:37 - INFO - 
Epoch 11/50 - 38.73s
2025-12-24 03:56:37 - INFO -   Train Loss: 0.0603, Train Acc: 0.9250
2025-12-24 03:56:37 - INFO -   Val Loss: 0.2757
2025-12-24 03:56:37 - INFO -   Val Accuracy: 0.6808
2025-12-24 03:56:37 - INFO -   Val Balanced Acc: 0.7347
2025-12-24 03:56:37 - INFO -   Val F1 (weighted): 0.6933
2025-12-24 03:56:37 - INFO -   Val F1 (macro): 0.6488
2025-12-24 03:56:37 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:56:37 - INFO -   LR: 0.000089
2025-12-24 03:56:38 - INFO -   Saved best model (balanced_accuracy: 0.7347)
2025-12-24 03:57:16 - INFO - 
Epoch 12/50 - 38.58s
2025-12-24 03:57:16 - INFO -   Train Loss: 0.0534, Train Acc: 0.9323
2025-12-24 03:57:16 - INFO -   Val Loss: 0.2372
2025-12-24 03:57:16 - INFO -   Val Accuracy: 0.7218
2025-12-24 03:57:16 - INFO -   Val Balanced Acc: 0.7386
2025-12-24 03:57:16 - INFO -   Val F1 (weighted): 0.7304
2025-12-24 03:57:16 - INFO -   Val F1 (macro): 0.6873
2025-12-24 03:57:16 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:57:16 - INFO -   LR: 0.000086
2025-12-24 03:57:17 - INFO -   Saved best model (balanced_accuracy: 0.7386)
2025-12-24 03:57:55 - INFO - 
Epoch 13/50 - 38.45s
2025-12-24 03:57:55 - INFO -   Train Loss: 0.0493, Train Acc: 0.9386
2025-12-24 03:57:55 - INFO -   Val Loss: 0.3013
2025-12-24 03:57:55 - INFO -   Val Accuracy: 0.6422
2025-12-24 03:57:55 - INFO -   Val Balanced Acc: 0.6951
2025-12-24 03:57:55 - INFO -   Val F1 (weighted): 0.6514
2025-12-24 03:57:55 - INFO -   Val F1 (macro): 0.6272
2025-12-24 03:57:55 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:57:55 - INFO -   LR: 0.000084
2025-12-24 03:57:55 - INFO -   No improvement (patience: 1/10)
2025-12-24 03:58:34 - INFO - 
Epoch 14/50 - 38.42s
2025-12-24 03:58:34 - INFO -   Train Loss: 0.0457, Train Acc: 0.9394
2025-12-24 03:58:34 - INFO -   Val Loss: 0.2665
2025-12-24 03:58:34 - INFO -   Val Accuracy: 0.6680
2025-12-24 03:58:34 - INFO -   Val Balanced Acc: 0.7247
2025-12-24 03:58:34 - INFO -   Val F1 (weighted): 0.6821
2025-12-24 03:58:34 - INFO -   Val F1 (macro): 0.6499
2025-12-24 03:58:34 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:58:34 - INFO -   LR: 0.000082
2025-12-24 03:58:34 - INFO -   No improvement (patience: 2/10)
2025-12-24 03:59:12 - INFO - 
Epoch 15/50 - 38.56s
2025-12-24 03:59:12 - INFO -   Train Loss: 0.0450, Train Acc: 0.9415
2025-12-24 03:59:12 - INFO -   Val Loss: 0.2718
2025-12-24 03:59:12 - INFO -   Val Accuracy: 0.6668
2025-12-24 03:59:12 - INFO -   Val Balanced Acc: 0.7286
2025-12-24 03:59:12 - INFO -   Val F1 (weighted): 0.6771
2025-12-24 03:59:12 - INFO -   Val F1 (macro): 0.6522
2025-12-24 03:59:12 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:59:12 - INFO -   LR: 0.000079
2025-12-24 03:59:12 - INFO -   No improvement (patience: 3/10)
2025-12-24 03:59:51 - INFO - 
Epoch 16/50 - 38.61s
2025-12-24 03:59:51 - INFO -   Train Loss: 0.0385, Train Acc: 0.9487
2025-12-24 03:59:51 - INFO -   Val Loss: 0.2557
2025-12-24 03:59:51 - INFO -   Val Accuracy: 0.6783
2025-12-24 03:59:51 - INFO -   Val Balanced Acc: 0.7180
2025-12-24 03:59:51 - INFO -   Val F1 (weighted): 0.6904
2025-12-24 03:59:51 - INFO -   Val F1 (macro): 0.6658
2025-12-24 03:59:51 - INFO -   Val AUC (macro): 0.0000
2025-12-24 03:59:51 - INFO -   LR: 0.000077
2025-12-24 03:59:51 - INFO -   No improvement (patience: 4/10)
2025-12-24 04:00:29 - INFO - 
Epoch 17/50 - 38.51s
2025-12-24 04:00:29 - INFO -   Train Loss: 0.0350, Train Acc: 0.9501
2025-12-24 04:00:29 - INFO -   Val Loss: 0.2670
2025-12-24 04:00:29 - INFO -   Val Accuracy: 0.6832
2025-12-24 04:00:29 - INFO -   Val Balanced Acc: 0.7182
2025-12-24 04:00:29 - INFO -   Val F1 (weighted): 0.6978
2025-12-24 04:00:29 - INFO -   Val F1 (macro): 0.6602
2025-12-24 04:00:29 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:00:29 - INFO -   LR: 0.000074
2025-12-24 04:00:29 - INFO -   No improvement (patience: 5/10)
2025-12-24 04:01:08 - INFO - 
Epoch 18/50 - 38.55s
2025-12-24 04:01:08 - INFO -   Train Loss: 0.0339, Train Acc: 0.9516
2025-12-24 04:01:08 - INFO -   Val Loss: 0.2560
2025-12-24 04:01:08 - INFO -   Val Accuracy: 0.7148
2025-12-24 04:01:08 - INFO -   Val Balanced Acc: 0.7263
2025-12-24 04:01:08 - INFO -   Val F1 (weighted): 0.7267
2025-12-24 04:01:08 - INFO -   Val F1 (macro): 0.6837
2025-12-24 04:01:08 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:01:08 - INFO -   LR: 0.000071
2025-12-24 04:01:08 - INFO -   No improvement (patience: 6/10)
2025-12-24 04:01:46 - INFO - 
Epoch 19/50 - 38.54s
2025-12-24 04:01:46 - INFO -   Train Loss: 0.0319, Train Acc: 0.9555
2025-12-24 04:01:46 - INFO -   Val Loss: 0.2400
2025-12-24 04:01:46 - INFO -   Val Accuracy: 0.7193
2025-12-24 04:01:46 - INFO -   Val Balanced Acc: 0.7450
2025-12-24 04:01:46 - INFO -   Val F1 (weighted): 0.7287
2025-12-24 04:01:46 - INFO -   Val F1 (macro): 0.6789
2025-12-24 04:01:46 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:01:46 - INFO -   LR: 0.000068
2025-12-24 04:01:47 - INFO -   Saved best model (balanced_accuracy: 0.7450)
2025-12-24 04:02:26 - INFO - 
Epoch 20/50 - 38.66s
2025-12-24 04:02:26 - INFO -   Train Loss: 0.0290, Train Acc: 0.9559
2025-12-24 04:02:26 - INFO -   Val Loss: 0.2474
2025-12-24 04:02:26 - INFO -   Val Accuracy: 0.6947
2025-12-24 04:02:26 - INFO -   Val Balanced Acc: 0.7346
2025-12-24 04:02:26 - INFO -   Val F1 (weighted): 0.7092
2025-12-24 04:02:26 - INFO -   Val F1 (macro): 0.6770
2025-12-24 04:02:26 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:02:26 - INFO -   LR: 0.000065
2025-12-24 04:02:26 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:03:06 - INFO - 
Epoch 21/50 - 40.08s
2025-12-24 04:03:06 - INFO -   Train Loss: 0.0299, Train Acc: 0.9552
2025-12-24 04:03:06 - INFO -   Val Loss: 0.2482
2025-12-24 04:03:06 - INFO -   Val Accuracy: 0.6935
2025-12-24 04:03:06 - INFO -   Val Balanced Acc: 0.7334
2025-12-24 04:03:06 - INFO -   Val F1 (weighted): 0.7058
2025-12-24 04:03:06 - INFO -   Val F1 (macro): 0.6842
2025-12-24 04:03:06 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:03:06 - INFO -   LR: 0.000062
2025-12-24 04:03:06 - INFO -   No improvement (patience: 2/10)
2025-12-24 04:03:47 - INFO - 
Epoch 22/50 - 41.69s
2025-12-24 04:03:47 - INFO -   Train Loss: 0.0254, Train Acc: 0.9604
2025-12-24 04:03:47 - INFO -   Val Loss: 0.2519
2025-12-24 04:03:47 - INFO -   Val Accuracy: 0.7050
2025-12-24 04:03:47 - INFO -   Val Balanced Acc: 0.7510
2025-12-24 04:03:47 - INFO -   Val F1 (weighted): 0.7161
2025-12-24 04:03:47 - INFO -   Val F1 (macro): 0.7001
2025-12-24 04:03:47 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:03:47 - INFO -   LR: 0.000059
2025-12-24 04:03:48 - INFO -   Saved best model (balanced_accuracy: 0.7510)
2025-12-24 04:04:30 - INFO - 
Epoch 23/50 - 42.15s
2025-12-24 04:04:30 - INFO -   Train Loss: 0.0240, Train Acc: 0.9641
2025-12-24 04:04:30 - INFO -   Val Loss: 0.2626
2025-12-24 04:04:30 - INFO -   Val Accuracy: 0.7263
2025-12-24 04:04:30 - INFO -   Val Balanced Acc: 0.7509
2025-12-24 04:04:30 - INFO -   Val F1 (weighted): 0.7358
2025-12-24 04:04:30 - INFO -   Val F1 (macro): 0.6976
2025-12-24 04:04:30 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:04:30 - INFO -   LR: 0.000056
2025-12-24 04:04:30 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:05:13 - INFO - 
Epoch 24/50 - 42.69s
2025-12-24 04:05:13 - INFO -   Train Loss: 0.0242, Train Acc: 0.9639
2025-12-24 04:05:13 - INFO -   Val Loss: 0.2539
2025-12-24 04:05:13 - INFO -   Val Accuracy: 0.7193
2025-12-24 04:05:13 - INFO -   Val Balanced Acc: 0.7476
2025-12-24 04:05:13 - INFO -   Val F1 (weighted): 0.7282
2025-12-24 04:05:13 - INFO -   Val F1 (macro): 0.6881
2025-12-24 04:05:13 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:05:13 - INFO -   LR: 0.000053
2025-12-24 04:05:13 - INFO -   No improvement (patience: 2/10)
2025-12-24 04:05:55 - INFO - 
Epoch 25/50 - 41.77s
2025-12-24 04:05:55 - INFO -   Train Loss: 0.0203, Train Acc: 0.9685
2025-12-24 04:05:55 - INFO -   Val Loss: 0.2590
2025-12-24 04:05:55 - INFO -   Val Accuracy: 0.7288
2025-12-24 04:05:55 - INFO -   Val Balanced Acc: 0.7299
2025-12-24 04:05:55 - INFO -   Val F1 (weighted): 0.7362
2025-12-24 04:05:55 - INFO -   Val F1 (macro): 0.6958
2025-12-24 04:05:55 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:05:55 - INFO -   LR: 0.000050
2025-12-24 04:05:55 - INFO -   No improvement (patience: 3/10)
2025-12-24 04:06:36 - INFO - 
Epoch 26/50 - 41.23s
2025-12-24 04:06:36 - INFO -   Train Loss: 0.0174, Train Acc: 0.9714
2025-12-24 04:06:36 - INFO -   Val Loss: 0.2671
2025-12-24 04:06:36 - INFO -   Val Accuracy: 0.7279
2025-12-24 04:06:36 - INFO -   Val Balanced Acc: 0.7643
2025-12-24 04:06:36 - INFO -   Val F1 (weighted): 0.7366
2025-12-24 04:06:36 - INFO -   Val F1 (macro): 0.7151
2025-12-24 04:06:36 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:06:36 - INFO -   LR: 0.000047
2025-12-24 04:06:36 - INFO -   Saved best model (balanced_accuracy: 0.7643)
2025-12-24 04:07:19 - INFO - 
Epoch 27/50 - 42.85s
2025-12-24 04:07:19 - INFO -   Train Loss: 0.0180, Train Acc: 0.9709
2025-12-24 04:07:19 - INFO -   Val Loss: 0.2418
2025-12-24 04:07:19 - INFO -   Val Accuracy: 0.7333
2025-12-24 04:07:19 - INFO -   Val Balanced Acc: 0.7740
2025-12-24 04:07:19 - INFO -   Val F1 (weighted): 0.7420
2025-12-24 04:07:19 - INFO -   Val F1 (macro): 0.7112
2025-12-24 04:07:19 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:07:19 - INFO -   LR: 0.000044
2025-12-24 04:07:20 - INFO -   Saved best model (balanced_accuracy: 0.7740)
2025-12-24 04:08:03 - INFO - 
Epoch 28/50 - 43.34s
2025-12-24 04:08:03 - INFO -   Train Loss: 0.0175, Train Acc: 0.9727
2025-12-24 04:08:03 - INFO -   Val Loss: 0.2338
2025-12-24 04:08:03 - INFO -   Val Accuracy: 0.7308
2025-12-24 04:08:03 - INFO -   Val Balanced Acc: 0.7590
2025-12-24 04:08:03 - INFO -   Val F1 (weighted): 0.7395
2025-12-24 04:08:03 - INFO -   Val F1 (macro): 0.7271
2025-12-24 04:08:03 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:08:03 - INFO -   LR: 0.000041
2025-12-24 04:08:03 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:08:46 - INFO - 
Epoch 29/50 - 43.06s
2025-12-24 04:08:46 - INFO -   Train Loss: 0.0141, Train Acc: 0.9750
2025-12-24 04:08:46 - INFO -   Val Loss: 0.2432
2025-12-24 04:08:46 - INFO -   Val Accuracy: 0.7333
2025-12-24 04:08:46 - INFO -   Val Balanced Acc: 0.7642
2025-12-24 04:08:46 - INFO -   Val F1 (weighted): 0.7416
2025-12-24 04:08:46 - INFO -   Val F1 (macro): 0.7176
2025-12-24 04:08:46 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:08:46 - INFO -   LR: 0.000038
2025-12-24 04:08:46 - INFO -   No improvement (patience: 2/10)
2025-12-24 04:09:28 - INFO - 
Epoch 30/50 - 42.16s
2025-12-24 04:09:28 - INFO -   Train Loss: 0.0147, Train Acc: 0.9740
2025-12-24 04:09:28 - INFO -   Val Loss: 0.2489
2025-12-24 04:09:28 - INFO -   Val Accuracy: 0.7481
2025-12-24 04:09:28 - INFO -   Val Balanced Acc: 0.7674
2025-12-24 04:09:28 - INFO -   Val F1 (weighted): 0.7562
2025-12-24 04:09:28 - INFO -   Val F1 (macro): 0.7419
2025-12-24 04:09:28 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:09:28 - INFO -   LR: 0.000035
2025-12-24 04:09:28 - INFO -   No improvement (patience: 3/10)
2025-12-24 04:10:10 - INFO - 
Epoch 31/50 - 41.43s
2025-12-24 04:10:10 - INFO -   Train Loss: 0.0128, Train Acc: 0.9780
2025-12-24 04:10:10 - INFO -   Val Loss: 0.2511
2025-12-24 04:10:10 - INFO -   Val Accuracy: 0.7608
2025-12-24 04:10:10 - INFO -   Val Balanced Acc: 0.7540
2025-12-24 04:10:10 - INFO -   Val F1 (weighted): 0.7671
2025-12-24 04:10:10 - INFO -   Val F1 (macro): 0.7175
2025-12-24 04:10:10 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:10:10 - INFO -   LR: 0.000032
2025-12-24 04:10:10 - INFO -   No improvement (patience: 4/10)
2025-12-24 04:10:51 - INFO - 
Epoch 32/50 - 41.03s
2025-12-24 04:10:51 - INFO -   Train Loss: 0.0116, Train Acc: 0.9795
2025-12-24 04:10:51 - INFO -   Val Loss: 0.2424
2025-12-24 04:10:51 - INFO -   Val Accuracy: 0.7431
2025-12-24 04:10:51 - INFO -   Val Balanced Acc: 0.7516
2025-12-24 04:10:51 - INFO -   Val F1 (weighted): 0.7509
2025-12-24 04:10:51 - INFO -   Val F1 (macro): 0.7179
2025-12-24 04:10:51 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:10:51 - INFO -   LR: 0.000029
2025-12-24 04:10:51 - INFO -   No improvement (patience: 5/10)
2025-12-24 04:11:32 - INFO - 
Epoch 33/50 - 41.43s
2025-12-24 04:11:32 - INFO -   Train Loss: 0.0125, Train Acc: 0.9778
2025-12-24 04:11:32 - INFO -   Val Loss: 0.2552
2025-12-24 04:11:32 - INFO -   Val Accuracy: 0.7337
2025-12-24 04:11:32 - INFO -   Val Balanced Acc: 0.7623
2025-12-24 04:11:32 - INFO -   Val F1 (weighted): 0.7407
2025-12-24 04:11:32 - INFO -   Val F1 (macro): 0.7256
2025-12-24 04:11:32 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:11:32 - INFO -   LR: 0.000026
2025-12-24 04:11:32 - INFO -   No improvement (patience: 6/10)
2025-12-24 04:12:13 - INFO - 
Epoch 34/50 - 41.03s
2025-12-24 04:12:13 - INFO -   Train Loss: 0.0109, Train Acc: 0.9813
2025-12-24 04:12:13 - INFO -   Val Loss: 0.2563
2025-12-24 04:12:13 - INFO -   Val Accuracy: 0.7423
2025-12-24 04:12:13 - INFO -   Val Balanced Acc: 0.7676
2025-12-24 04:12:13 - INFO -   Val F1 (weighted): 0.7490
2025-12-24 04:12:13 - INFO -   Val F1 (macro): 0.7194
2025-12-24 04:12:13 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:12:13 - INFO -   LR: 0.000023
2025-12-24 04:12:13 - INFO -   No improvement (patience: 7/10)
2025-12-24 04:12:54 - INFO - 
Epoch 35/50 - 40.89s
2025-12-24 04:12:54 - INFO -   Train Loss: 0.0086, Train Acc: 0.9812
2025-12-24 04:12:54 - INFO -   Val Loss: 0.2593
2025-12-24 04:12:54 - INFO -   Val Accuracy: 0.7509
2025-12-24 04:12:54 - INFO -   Val Balanced Acc: 0.7655
2025-12-24 04:12:54 - INFO -   Val F1 (weighted): 0.7568
2025-12-24 04:12:54 - INFO -   Val F1 (macro): 0.7339
2025-12-24 04:12:54 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:12:54 - INFO -   LR: 0.000021
2025-12-24 04:12:54 - INFO -   No improvement (patience: 8/10)
2025-12-24 04:13:35 - INFO - 
Epoch 36/50 - 41.03s
2025-12-24 04:13:35 - INFO -   Train Loss: 0.0085, Train Acc: 0.9840
2025-12-24 04:13:35 - INFO -   Val Loss: 0.2658
2025-12-24 04:13:35 - INFO -   Val Accuracy: 0.7723
2025-12-24 04:13:35 - INFO -   Val Balanced Acc: 0.7673
2025-12-24 04:13:35 - INFO -   Val F1 (weighted): 0.7778
2025-12-24 04:13:35 - INFO -   Val F1 (macro): 0.7407
2025-12-24 04:13:35 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:13:35 - INFO -   LR: 0.000018
2025-12-24 04:13:35 - INFO -   No improvement (patience: 9/10)
2025-12-24 04:14:16 - INFO - 
Epoch 37/50 - 41.09s
2025-12-24 04:14:16 - INFO -   Train Loss: 0.0081, Train Acc: 0.9830
2025-12-24 04:14:16 - INFO -   Val Loss: 0.2689
2025-12-24 04:14:16 - INFO -   Val Accuracy: 0.7723
2025-12-24 04:14:16 - INFO -   Val Balanced Acc: 0.7749
2025-12-24 04:14:16 - INFO -   Val F1 (weighted): 0.7767
2025-12-24 04:14:16 - INFO -   Val F1 (macro): 0.7517
2025-12-24 04:14:16 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:14:16 - INFO -   LR: 0.000016
2025-12-24 04:14:17 - INFO -   Saved best model (balanced_accuracy: 0.7749)
2025-12-24 04:14:58 - INFO - 
Epoch 38/50 - 41.04s
2025-12-24 04:14:58 - INFO -   Train Loss: 0.0079, Train Acc: 0.9843
2025-12-24 04:14:58 - INFO -   Val Loss: 0.2634
2025-12-24 04:14:58 - INFO -   Val Accuracy: 0.7698
2025-12-24 04:14:58 - INFO -   Val Balanced Acc: 0.7804
2025-12-24 04:14:58 - INFO -   Val F1 (weighted): 0.7757
2025-12-24 04:14:58 - INFO -   Val F1 (macro): 0.7592
2025-12-24 04:14:58 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:14:58 - INFO -   LR: 0.000014
2025-12-24 04:14:59 - INFO -   Saved best model (balanced_accuracy: 0.7804)
2025-12-24 04:15:39 - INFO - 
Epoch 39/50 - 40.88s
2025-12-24 04:15:39 - INFO -   Train Loss: 0.0082, Train Acc: 0.9836
2025-12-24 04:15:39 - INFO -   Val Loss: 0.2549
2025-12-24 04:15:39 - INFO -   Val Accuracy: 0.7805
2025-12-24 04:15:39 - INFO -   Val Balanced Acc: 0.7794
2025-12-24 04:15:39 - INFO -   Val F1 (weighted): 0.7846
2025-12-24 04:15:39 - INFO -   Val F1 (macro): 0.7536
2025-12-24 04:15:39 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:15:39 - INFO -   LR: 0.000011
2025-12-24 04:15:39 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:16:21 - INFO - 
Epoch 40/50 - 41.25s
2025-12-24 04:16:21 - INFO -   Train Loss: 0.0070, Train Acc: 0.9862
2025-12-24 04:16:21 - INFO -   Val Loss: 0.2585
2025-12-24 04:16:21 - INFO -   Val Accuracy: 0.7784
2025-12-24 04:16:21 - INFO -   Val Balanced Acc: 0.7834
2025-12-24 04:16:21 - INFO -   Val F1 (weighted): 0.7845
2025-12-24 04:16:21 - INFO -   Val F1 (macro): 0.7580
2025-12-24 04:16:21 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:16:21 - INFO -   LR: 0.000010
2025-12-24 04:16:21 - INFO -   Saved best model (balanced_accuracy: 0.7834)
2025-12-24 04:17:02 - INFO - 
Epoch 41/50 - 41.20s
2025-12-24 04:17:02 - INFO -   Train Loss: 0.0066, Train Acc: 0.9857
2025-12-24 04:17:02 - INFO -   Val Loss: 0.2562
2025-12-24 04:17:02 - INFO -   Val Accuracy: 0.7829
2025-12-24 04:17:02 - INFO -   Val Balanced Acc: 0.7778
2025-12-24 04:17:02 - INFO -   Val F1 (weighted): 0.7878
2025-12-24 04:17:02 - INFO -   Val F1 (macro): 0.7640
2025-12-24 04:17:02 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:17:02 - INFO -   LR: 0.000008
2025-12-24 04:17:02 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:17:44 - INFO - 
Epoch 42/50 - 41.16s
2025-12-24 04:17:44 - INFO -   Train Loss: 0.0059, Train Acc: 0.9874
2025-12-24 04:17:44 - INFO -   Val Loss: 0.2547
2025-12-24 04:17:44 - INFO -   Val Accuracy: 0.7796
2025-12-24 04:17:44 - INFO -   Val Balanced Acc: 0.7798
2025-12-24 04:17:44 - INFO -   Val F1 (weighted): 0.7852
2025-12-24 04:17:44 - INFO -   Val F1 (macro): 0.7511
2025-12-24 04:17:44 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:17:44 - INFO -   LR: 0.000006
2025-12-24 04:17:44 - INFO -   No improvement (patience: 2/10)
2025-12-24 04:18:25 - INFO - 
Epoch 43/50 - 41.23s
2025-12-24 04:18:25 - INFO -   Train Loss: 0.0060, Train Acc: 0.9873
2025-12-24 04:18:25 - INFO -   Val Loss: 0.2608
2025-12-24 04:18:25 - INFO -   Val Accuracy: 0.7829
2025-12-24 04:18:25 - INFO -   Val Balanced Acc: 0.7856
2025-12-24 04:18:25 - INFO -   Val F1 (weighted): 0.7879
2025-12-24 04:18:25 - INFO -   Val F1 (macro): 0.7623
2025-12-24 04:18:25 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:18:25 - INFO -   LR: 0.000005
2025-12-24 04:18:25 - INFO -   Saved best model (balanced_accuracy: 0.7856)
2025-12-24 04:19:07 - INFO - 
Epoch 44/50 - 41.30s
2025-12-24 04:19:07 - INFO -   Train Loss: 0.0057, Train Acc: 0.9866
2025-12-24 04:19:07 - INFO -   Val Loss: 0.2655
2025-12-24 04:19:07 - INFO -   Val Accuracy: 0.7842
2025-12-24 04:19:07 - INFO -   Val Balanced Acc: 0.7749
2025-12-24 04:19:07 - INFO -   Val F1 (weighted): 0.7888
2025-12-24 04:19:07 - INFO -   Val F1 (macro): 0.7601
2025-12-24 04:19:07 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:19:07 - INFO -   LR: 0.000004
2025-12-24 04:19:07 - INFO -   No improvement (patience: 1/10)
2025-12-24 04:19:48 - INFO - 
Epoch 45/50 - 40.91s
2025-12-24 04:19:48 - INFO -   Train Loss: 0.0056, Train Acc: 0.9868
2025-12-24 04:19:48 - INFO -   Val Loss: 0.2579
2025-12-24 04:19:48 - INFO -   Val Accuracy: 0.7858
2025-12-24 04:19:48 - INFO -   Val Balanced Acc: 0.7800
2025-12-24 04:19:48 - INFO -   Val F1 (weighted): 0.7906
2025-12-24 04:19:48 - INFO -   Val F1 (macro): 0.7650
2025-12-24 04:19:48 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:19:48 - INFO -   LR: 0.000002
2025-12-24 04:19:48 - INFO -   No improvement (patience: 2/10)
2025-12-24 04:20:28 - INFO - 
Epoch 46/50 - 40.52s
2025-12-24 04:20:28 - INFO -   Train Loss: 0.0053, Train Acc: 0.9881
2025-12-24 04:20:28 - INFO -   Val Loss: 0.2570
2025-12-24 04:20:28 - INFO -   Val Accuracy: 0.7895
2025-12-24 04:20:28 - INFO -   Val Balanced Acc: 0.7818
2025-12-24 04:20:28 - INFO -   Val F1 (weighted): 0.7938
2025-12-24 04:20:28 - INFO -   Val F1 (macro): 0.7676
2025-12-24 04:20:28 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:20:28 - INFO -   LR: 0.000002
2025-12-24 04:20:28 - INFO -   No improvement (patience: 3/10)
2025-12-24 04:21:09 - INFO - 
Epoch 47/50 - 40.67s
2025-12-24 04:21:09 - INFO -   Train Loss: 0.0056, Train Acc: 0.9871
2025-12-24 04:21:09 - INFO -   Val Loss: 0.2573
2025-12-24 04:21:09 - INFO -   Val Accuracy: 0.7924
2025-12-24 04:21:09 - INFO -   Val Balanced Acc: 0.7824
2025-12-24 04:21:09 - INFO -   Val F1 (weighted): 0.7968
2025-12-24 04:21:09 - INFO -   Val F1 (macro): 0.7668
2025-12-24 04:21:09 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:21:09 - INFO -   LR: 0.000001
2025-12-24 04:21:09 - INFO -   No improvement (patience: 4/10)
2025-12-24 04:21:50 - INFO - 
Epoch 48/50 - 40.90s
2025-12-24 04:21:50 - INFO -   Train Loss: 0.0051, Train Acc: 0.9869
2025-12-24 04:21:50 - INFO -   Val Loss: 0.2632
2025-12-24 04:21:50 - INFO -   Val Accuracy: 0.7838
2025-12-24 04:21:50 - INFO -   Val Balanced Acc: 0.7839
2025-12-24 04:21:50 - INFO -   Val F1 (weighted): 0.7885
2025-12-24 04:21:50 - INFO -   Val F1 (macro): 0.7638
2025-12-24 04:21:50 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:21:50 - INFO -   LR: 0.000000
2025-12-24 04:21:50 - INFO -   No improvement (patience: 5/10)
2025-12-24 04:22:30 - INFO - 
Epoch 49/50 - 40.70s
2025-12-24 04:22:30 - INFO -   Train Loss: 0.0052, Train Acc: 0.9861
2025-12-24 04:22:30 - INFO -   Val Loss: 0.2641
2025-12-24 04:22:30 - INFO -   Val Accuracy: 0.7858
2025-12-24 04:22:30 - INFO -   Val Balanced Acc: 0.7764
2025-12-24 04:22:30 - INFO -   Val F1 (weighted): 0.7905
2025-12-24 04:22:30 - INFO -   Val F1 (macro): 0.7647
2025-12-24 04:22:30 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:22:30 - INFO -   LR: 0.000000
2025-12-24 04:22:30 - INFO -   No improvement (patience: 6/10)
2025-12-24 04:23:11 - INFO - 
Epoch 50/50 - 40.79s
2025-12-24 04:23:11 - INFO -   Train Loss: 0.0049, Train Acc: 0.9884
2025-12-24 04:23:11 - INFO -   Val Loss: 0.2579
2025-12-24 04:23:11 - INFO -   Val Accuracy: 0.7772
2025-12-24 04:23:11 - INFO -   Val Balanced Acc: 0.7853
2025-12-24 04:23:11 - INFO -   Val F1 (weighted): 0.7828
2025-12-24 04:23:11 - INFO -   Val F1 (macro): 0.7664
2025-12-24 04:23:11 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:23:11 - INFO -   LR: 0.000000
2025-12-24 04:23:11 - INFO -   No improvement (patience: 7/10)
2025-12-24 04:23:11 - INFO - 
================================================================================
2025-12-24 04:23:11 - INFO - TRAINING COMPLETE
2025-12-24 04:23:11 - INFO - ================================================================================
2025-12-24 04:23:11 - INFO - Total time: 33.98 minutes
2025-12-24 04:23:11 - INFO - Best balanced_accuracy: 0.7856 (epoch 43)
2025-12-24 04:23:11 - INFO - Average time per epoch: 40.77 seconds
2025-12-24 04:23:11 - INFO - Model saved to: models/resnet50_fold5_20251224_034911
2025-12-24 04:23:11 - INFO - 
Results saved to: models/resnet50_fold5_20251224_034911/final_results.json
