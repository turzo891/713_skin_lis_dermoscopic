2025-12-28 08:52:42 - INFO - Logging initialized. Log file: models/swin_fold7_20251228_085242/training.log
2025-12-28 08:52:42 - INFO - ================================================================================
2025-12-28 08:52:42 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-28 08:52:42 - INFO - ================================================================================
2025-12-28 08:52:42 - INFO - Model: swin
2025-12-28 08:52:42 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-28 08:52:42 - INFO - Fold: 7
2025-12-28 08:52:42 - INFO - Batch size: 16
2025-12-28 08:52:42 - INFO - Effective batch size: 16
2025-12-28 08:52:42 - INFO - Epochs: 50
2025-12-28 08:52:42 - INFO - Learning rate: 0.0001
2025-12-28 08:52:42 - INFO - Workers: 8
2025-12-28 08:52:42 - INFO - Mixed precision: True
2025-12-28 08:52:42 - INFO - Gradient accumulation: 1
2025-12-28 08:52:42 - INFO - Prefetch factor: 2
2025-12-28 08:52:42 - INFO - Focal loss: True
2025-12-28 08:52:42 - INFO - Skin tone sampling: True
2025-12-28 08:52:42 - INFO - Device: cuda
2025-12-28 08:52:42 - INFO - Output: models/swin_fold7_20251228_085242
2025-12-28 08:52:42 - INFO - ================================================================================
2025-12-28 08:52:42 - INFO - 
Creating data loaders...
2025-12-28 08:52:43 - INFO - Train samples: 21937
2025-12-28 08:52:43 - INFO - Val samples: 2437
2025-12-28 08:52:43 - INFO - 
Creating swin model...
2025-12-28 08:52:45 - INFO - 
Starting training...

2025-12-28 08:57:57 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 08:57:57 - INFO - 
Epoch 1/50 - 312.37s
2025-12-28 08:57:57 - INFO -   Train Loss: 0.3846, Train Acc: 0.6789
2025-12-28 08:57:57 - INFO -   Val Loss: 0.3737
2025-12-28 08:57:57 - INFO -   Val Accuracy: 0.5843
2025-12-28 08:57:57 - INFO -   Val Balanced Acc: 0.6556
2025-12-28 08:57:57 - INFO -   Val F1 (weighted): 0.6122
2025-12-28 08:57:57 - INFO -   Val F1 (macro): 0.5165
2025-12-28 08:57:57 - INFO -   Val AUC (macro): 0.0000
2025-12-28 08:57:57 - INFO -   LR: 0.000100
2025-12-28 08:58:00 - INFO -   Saved best model (balanced_accuracy: 0.6556)
2025-12-28 09:03:10 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:03:10 - INFO - 
Epoch 2/50 - 310.74s
2025-12-28 09:03:10 - INFO -   Train Loss: 0.2091, Train Acc: 0.8008
2025-12-28 09:03:10 - INFO -   Val Loss: 0.2921
2025-12-28 09:03:10 - INFO -   Val Accuracy: 0.6730
2025-12-28 09:03:10 - INFO -   Val Balanced Acc: 0.7259
2025-12-28 09:03:10 - INFO -   Val F1 (weighted): 0.6911
2025-12-28 09:03:10 - INFO -   Val F1 (macro): 0.6066
2025-12-28 09:03:10 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:03:10 - INFO -   LR: 0.000100
2025-12-28 09:03:13 - INFO -   Saved best model (balanced_accuracy: 0.7259)
2025-12-28 09:08:23 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:08:23 - INFO - 
Epoch 3/50 - 310.06s
2025-12-28 09:08:23 - INFO -   Train Loss: 0.1515, Train Acc: 0.8415
2025-12-28 09:08:23 - INFO -   Val Loss: 0.3244
2025-12-28 09:08:23 - INFO -   Val Accuracy: 0.6594
2025-12-28 09:08:23 - INFO -   Val Balanced Acc: 0.6916
2025-12-28 09:08:23 - INFO -   Val F1 (weighted): 0.6810
2025-12-28 09:08:23 - INFO -   Val F1 (macro): 0.6122
2025-12-28 09:08:23 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:08:23 - INFO -   LR: 0.000099
2025-12-28 09:08:23 - INFO -   No improvement (patience: 1/10)
2025-12-28 09:13:33 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:13:33 - INFO - 
Epoch 4/50 - 310.08s
2025-12-28 09:13:33 - INFO -   Train Loss: 0.1291, Train Acc: 0.8628
2025-12-28 09:13:33 - INFO -   Val Loss: 0.2769
2025-12-28 09:13:33 - INFO -   Val Accuracy: 0.6040
2025-12-28 09:13:33 - INFO -   Val Balanced Acc: 0.7014
2025-12-28 09:13:33 - INFO -   Val F1 (weighted): 0.6111
2025-12-28 09:13:33 - INFO -   Val F1 (macro): 0.6327
2025-12-28 09:13:33 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:13:33 - INFO -   LR: 0.000098
2025-12-28 09:13:33 - INFO -   No improvement (patience: 2/10)
2025-12-28 09:18:43 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:18:43 - INFO - 
Epoch 5/50 - 309.86s
2025-12-28 09:18:43 - INFO -   Train Loss: 0.1150, Train Acc: 0.8757
2025-12-28 09:18:43 - INFO -   Val Loss: 0.3028
2025-12-28 09:18:43 - INFO -   Val Accuracy: 0.6094
2025-12-28 09:18:43 - INFO -   Val Balanced Acc: 0.6923
2025-12-28 09:18:43 - INFO -   Val F1 (weighted): 0.6218
2025-12-28 09:18:43 - INFO -   Val F1 (macro): 0.5802
2025-12-28 09:18:43 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:18:43 - INFO -   LR: 0.000098
2025-12-28 09:18:43 - INFO -   No improvement (patience: 3/10)
2025-12-28 09:23:53 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:23:53 - INFO - 
Epoch 6/50 - 310.35s
2025-12-28 09:23:53 - INFO -   Train Loss: 0.1044, Train Acc: 0.8837
2025-12-28 09:23:53 - INFO -   Val Loss: 0.2802
2025-12-28 09:23:53 - INFO -   Val Accuracy: 0.6077
2025-12-28 09:23:53 - INFO -   Val Balanced Acc: 0.6841
2025-12-28 09:23:53 - INFO -   Val F1 (weighted): 0.6223
2025-12-28 09:23:53 - INFO -   Val F1 (macro): 0.6102
2025-12-28 09:23:53 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:23:53 - INFO -   LR: 0.000096
2025-12-28 09:23:53 - INFO -   No improvement (patience: 4/10)
2025-12-28 09:29:03 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:29:03 - INFO - 
Epoch 7/50 - 309.52s
2025-12-28 09:29:03 - INFO -   Train Loss: 0.0839, Train Acc: 0.9031
2025-12-28 09:29:03 - INFO -   Val Loss: 0.2633
2025-12-28 09:29:03 - INFO -   Val Accuracy: 0.7485
2025-12-28 09:29:03 - INFO -   Val Balanced Acc: 0.7082
2025-12-28 09:29:03 - INFO -   Val F1 (weighted): 0.7549
2025-12-28 09:29:03 - INFO -   Val F1 (macro): 0.6713
2025-12-28 09:29:03 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:29:03 - INFO -   LR: 0.000095
2025-12-28 09:29:03 - INFO -   No improvement (patience: 5/10)
2025-12-28 09:34:13 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 09:34:13 - INFO - 
Epoch 8/50 - 309.84s
2025-12-28 09:34:13 - INFO -   Train Loss: 0.0870, Train Acc: 0.9015
2025-12-28 09:34:13 - INFO -   Val Loss: 0.2545
2025-12-28 09:34:13 - INFO -   Val Accuracy: 0.6393
2025-12-28 09:34:13 - INFO -   Val Balanced Acc: 0.7245
2025-12-28 09:34:13 - INFO -   Val F1 (weighted): 0.6479
2025-12-28 09:34:13 - INFO -   Val F1 (macro): 0.6467
2025-12-28 09:34:13 - INFO -   Val AUC (macro): 0.0000
2025-12-28 09:34:13 - INFO -   LR: 0.000094
2025-12-28 09:34:13 - INFO -   No improvement (patience: 6/10)
