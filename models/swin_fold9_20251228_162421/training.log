2025-12-28 16:24:21 - INFO - Logging initialized. Log file: models/swin_fold9_20251228_162421/training.log
2025-12-28 16:24:22 - INFO - ================================================================================
2025-12-28 16:24:22 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-28 16:24:22 - INFO - ================================================================================
2025-12-28 16:24:22 - INFO - Model: swin
2025-12-28 16:24:22 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-28 16:24:22 - INFO - Fold: 9
2025-12-28 16:24:22 - INFO - Batch size: 16
2025-12-28 16:24:22 - INFO - Effective batch size: 16
2025-12-28 16:24:22 - INFO - Epochs: 50
2025-12-28 16:24:22 - INFO - Learning rate: 0.0001
2025-12-28 16:24:22 - INFO - Workers: 8
2025-12-28 16:24:22 - INFO - Mixed precision: True
2025-12-28 16:24:22 - INFO - Gradient accumulation: 1
2025-12-28 16:24:22 - INFO - Prefetch factor: 2
2025-12-28 16:24:22 - INFO - Focal loss: True
2025-12-28 16:24:22 - INFO - Skin tone sampling: True
2025-12-28 16:24:22 - INFO - Device: cuda
2025-12-28 16:24:22 - INFO - Output: models/swin_fold9_20251228_162421
2025-12-28 16:24:22 - INFO - ================================================================================
2025-12-28 16:24:22 - INFO - 
Creating data loaders...
2025-12-28 16:24:22 - INFO - Train samples: 21937
2025-12-28 16:24:22 - INFO - Val samples: 2437
2025-12-28 16:24:22 - INFO - 
Creating swin model...
2025-12-28 16:24:34 - INFO - 
Starting training...

2025-12-28 16:29:47 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:29:47 - INFO - 
Epoch 1/50 - 312.89s
2025-12-28 16:29:47 - INFO -   Train Loss: 0.3937, Train Acc: 0.6794
2025-12-28 16:29:47 - INFO -   Val Loss: 0.3456
2025-12-28 16:29:47 - INFO -   Val Accuracy: 0.6319
2025-12-28 16:29:47 - INFO -   Val Balanced Acc: 0.6695
2025-12-28 16:29:47 - INFO -   Val F1 (weighted): 0.6526
2025-12-28 16:29:47 - INFO -   Val F1 (macro): 0.5472
2025-12-28 16:29:47 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:29:47 - INFO -   LR: 0.000100
2025-12-28 16:29:48 - INFO -   Saved best model (balanced_accuracy: 0.6695)
2025-12-28 16:34:59 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:34:59 - INFO - 
Epoch 2/50 - 310.71s
2025-12-28 16:34:59 - INFO -   Train Loss: 0.2168, Train Acc: 0.7922
2025-12-28 16:34:59 - INFO -   Val Loss: 0.3718
2025-12-28 16:34:59 - INFO -   Val Accuracy: 0.6254
2025-12-28 16:34:59 - INFO -   Val Balanced Acc: 0.6684
2025-12-28 16:34:59 - INFO -   Val F1 (weighted): 0.6518
2025-12-28 16:34:59 - INFO -   Val F1 (macro): 0.5326
2025-12-28 16:34:59 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:34:59 - INFO -   LR: 0.000100
2025-12-28 16:34:59 - INFO -   No improvement (patience: 1/10)
2025-12-28 16:40:10 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:40:10 - INFO - 
Epoch 3/50 - 310.38s
2025-12-28 16:40:10 - INFO -   Train Loss: 0.1625, Train Acc: 0.8342
2025-12-28 16:40:10 - INFO -   Val Loss: 0.3820
2025-12-28 16:40:10 - INFO -   Val Accuracy: 0.5794
2025-12-28 16:40:10 - INFO -   Val Balanced Acc: 0.6612
2025-12-28 16:40:10 - INFO -   Val F1 (weighted): 0.6180
2025-12-28 16:40:10 - INFO -   Val F1 (macro): 0.5796
2025-12-28 16:40:10 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:40:10 - INFO -   LR: 0.000099
2025-12-28 16:40:10 - INFO -   No improvement (patience: 2/10)
2025-12-28 16:45:19 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:45:19 - INFO - 
Epoch 4/50 - 309.82s
2025-12-28 16:45:19 - INFO -   Train Loss: 0.1335, Train Acc: 0.8582
2025-12-28 16:45:19 - INFO -   Val Loss: 0.4275
2025-12-28 16:45:19 - INFO -   Val Accuracy: 0.6172
2025-12-28 16:45:19 - INFO -   Val Balanced Acc: 0.6734
2025-12-28 16:45:19 - INFO -   Val F1 (weighted): 0.6529
2025-12-28 16:45:19 - INFO -   Val F1 (macro): 0.5417
2025-12-28 16:45:19 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:45:19 - INFO -   LR: 0.000098
2025-12-28 16:45:22 - INFO -   Saved best model (balanced_accuracy: 0.6734)
2025-12-28 16:50:32 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:50:32 - INFO - 
Epoch 5/50 - 309.92s
2025-12-28 16:50:32 - INFO -   Train Loss: 0.1144, Train Acc: 0.8719
2025-12-28 16:50:32 - INFO -   Val Loss: 0.3143
2025-12-28 16:50:32 - INFO -   Val Accuracy: 0.6385
2025-12-28 16:50:32 - INFO -   Val Balanced Acc: 0.7108
2025-12-28 16:50:32 - INFO -   Val F1 (weighted): 0.6645
2025-12-28 16:50:32 - INFO -   Val F1 (macro): 0.6113
2025-12-28 16:50:32 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:50:32 - INFO -   LR: 0.000098
2025-12-28 16:50:34 - INFO -   Saved best model (balanced_accuracy: 0.7108)
2025-12-28 16:55:44 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 16:55:44 - INFO - 
Epoch 6/50 - 309.92s
2025-12-28 16:55:44 - INFO -   Train Loss: 0.0988, Train Acc: 0.8871
2025-12-28 16:55:44 - INFO -   Val Loss: 0.3460
2025-12-28 16:55:44 - INFO -   Val Accuracy: 0.6274
2025-12-28 16:55:44 - INFO -   Val Balanced Acc: 0.7169
2025-12-28 16:55:44 - INFO -   Val F1 (weighted): 0.6529
2025-12-28 16:55:44 - INFO -   Val F1 (macro): 0.5640
2025-12-28 16:55:44 - INFO -   Val AUC (macro): 0.0000
2025-12-28 16:55:44 - INFO -   LR: 0.000096
2025-12-28 16:55:47 - INFO -   Saved best model (balanced_accuracy: 0.7169)
2025-12-28 17:00:57 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:00:57 - INFO - 
Epoch 7/50 - 310.04s
2025-12-28 17:00:57 - INFO -   Train Loss: 0.0935, Train Acc: 0.8935
2025-12-28 17:00:57 - INFO -   Val Loss: 0.2559
2025-12-28 17:00:57 - INFO -   Val Accuracy: 0.7197
2025-12-28 17:00:57 - INFO -   Val Balanced Acc: 0.7283
2025-12-28 17:00:57 - INFO -   Val F1 (weighted): 0.7284
2025-12-28 17:00:57 - INFO -   Val F1 (macro): 0.6494
2025-12-28 17:00:57 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:00:57 - INFO -   LR: 0.000095
2025-12-28 17:00:59 - INFO -   Saved best model (balanced_accuracy: 0.7283)
2025-12-28 17:06:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:06:09 - INFO - 
Epoch 8/50 - 309.67s
2025-12-28 17:06:09 - INFO -   Train Loss: 0.0805, Train Acc: 0.9055
2025-12-28 17:06:09 - INFO -   Val Loss: 0.3586
2025-12-28 17:06:09 - INFO -   Val Accuracy: 0.5892
2025-12-28 17:06:09 - INFO -   Val Balanced Acc: 0.7169
2025-12-28 17:06:09 - INFO -   Val F1 (weighted): 0.6046
2025-12-28 17:06:09 - INFO -   Val F1 (macro): 0.6103
2025-12-28 17:06:09 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:06:09 - INFO -   LR: 0.000094
2025-12-28 17:06:09 - INFO -   No improvement (patience: 1/10)
2025-12-28 17:11:19 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:11:19 - INFO - 
Epoch 9/50 - 309.83s
2025-12-28 17:11:19 - INFO -   Train Loss: 0.0714, Train Acc: 0.9138
2025-12-28 17:11:19 - INFO -   Val Loss: 0.2734
2025-12-28 17:11:19 - INFO -   Val Accuracy: 0.6902
2025-12-28 17:11:19 - INFO -   Val Balanced Acc: 0.7476
2025-12-28 17:11:19 - INFO -   Val F1 (weighted): 0.7024
2025-12-28 17:11:19 - INFO -   Val F1 (macro): 0.6381
2025-12-28 17:11:19 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:11:19 - INFO -   LR: 0.000092
2025-12-28 17:11:21 - INFO -   Saved best model (balanced_accuracy: 0.7476)
2025-12-28 17:16:31 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:16:31 - INFO - 
Epoch 10/50 - 310.12s
2025-12-28 17:16:31 - INFO -   Train Loss: 0.0653, Train Acc: 0.9179
2025-12-28 17:16:31 - INFO -   Val Loss: 0.2513
2025-12-28 17:16:31 - INFO -   Val Accuracy: 0.6750
2025-12-28 17:16:31 - INFO -   Val Balanced Acc: 0.7402
2025-12-28 17:16:31 - INFO -   Val F1 (weighted): 0.6853
2025-12-28 17:16:31 - INFO -   Val F1 (macro): 0.6796
2025-12-28 17:16:31 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:16:31 - INFO -   LR: 0.000090
2025-12-28 17:16:31 - INFO -   No improvement (patience: 1/10)
2025-12-28 17:21:41 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:21:41 - INFO - 
Epoch 11/50 - 309.59s
2025-12-28 17:21:41 - INFO -   Train Loss: 0.0634, Train Acc: 0.9236
2025-12-28 17:21:41 - INFO -   Val Loss: 0.2853
2025-12-28 17:21:41 - INFO -   Val Accuracy: 0.6418
2025-12-28 17:21:41 - INFO -   Val Balanced Acc: 0.7360
2025-12-28 17:21:41 - INFO -   Val F1 (weighted): 0.6478
2025-12-28 17:21:41 - INFO -   Val F1 (macro): 0.6627
2025-12-28 17:21:41 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:21:41 - INFO -   LR: 0.000089
2025-12-28 17:21:41 - INFO -   No improvement (patience: 2/10)
2025-12-28 17:26:50 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:26:50 - INFO - 
Epoch 12/50 - 309.68s
2025-12-28 17:26:50 - INFO -   Train Loss: 0.0565, Train Acc: 0.9299
2025-12-28 17:26:50 - INFO -   Val Loss: 0.2732
2025-12-28 17:26:50 - INFO -   Val Accuracy: 0.7165
2025-12-28 17:26:50 - INFO -   Val Balanced Acc: 0.7344
2025-12-28 17:26:50 - INFO -   Val F1 (weighted): 0.7313
2025-12-28 17:26:50 - INFO -   Val F1 (macro): 0.6313
2025-12-28 17:26:50 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:26:50 - INFO -   LR: 0.000086
2025-12-28 17:26:50 - INFO -   No improvement (patience: 3/10)
2025-12-28 17:31:59 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:31:59 - INFO - 
Epoch 13/50 - 309.24s
2025-12-28 17:31:59 - INFO -   Train Loss: 0.0530, Train Acc: 0.9331
2025-12-28 17:31:59 - INFO -   Val Loss: 0.2402
2025-12-28 17:31:59 - INFO -   Val Accuracy: 0.7403
2025-12-28 17:31:59 - INFO -   Val Balanced Acc: 0.7499
2025-12-28 17:31:59 - INFO -   Val F1 (weighted): 0.7466
2025-12-28 17:31:59 - INFO -   Val F1 (macro): 0.6781
2025-12-28 17:31:59 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:31:59 - INFO -   LR: 0.000084
2025-12-28 17:32:02 - INFO -   Saved best model (balanced_accuracy: 0.7499)
2025-12-28 17:37:11 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:37:11 - INFO - 
Epoch 14/50 - 309.76s
2025-12-28 17:37:11 - INFO -   Train Loss: 0.0465, Train Acc: 0.9397
2025-12-28 17:37:11 - INFO -   Val Loss: 0.3045
2025-12-28 17:37:11 - INFO -   Val Accuracy: 0.6508
2025-12-28 17:37:11 - INFO -   Val Balanced Acc: 0.7535
2025-12-28 17:37:11 - INFO -   Val F1 (weighted): 0.6685
2025-12-28 17:37:11 - INFO -   Val F1 (macro): 0.6567
2025-12-28 17:37:11 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:37:11 - INFO -   LR: 0.000082
2025-12-28 17:37:14 - INFO -   Saved best model (balanced_accuracy: 0.7535)
2025-12-28 17:42:23 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:42:23 - INFO - 
Epoch 15/50 - 309.59s
2025-12-28 17:42:23 - INFO -   Train Loss: 0.0492, Train Acc: 0.9387
2025-12-28 17:42:23 - INFO -   Val Loss: 0.2718
2025-12-28 17:42:23 - INFO -   Val Accuracy: 0.6381
2025-12-28 17:42:23 - INFO -   Val Balanced Acc: 0.7397
2025-12-28 17:42:23 - INFO -   Val F1 (weighted): 0.6451
2025-12-28 17:42:23 - INFO -   Val F1 (macro): 0.6667
2025-12-28 17:42:23 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:42:23 - INFO -   LR: 0.000079
2025-12-28 17:42:23 - INFO -   No improvement (patience: 1/10)
2025-12-28 17:47:32 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:47:32 - INFO - 
Epoch 16/50 - 309.28s
2025-12-28 17:47:32 - INFO -   Train Loss: 0.0426, Train Acc: 0.9422
2025-12-28 17:47:32 - INFO -   Val Loss: 0.2727
2025-12-28 17:47:32 - INFO -   Val Accuracy: 0.7050
2025-12-28 17:47:32 - INFO -   Val Balanced Acc: 0.7327
2025-12-28 17:47:32 - INFO -   Val F1 (weighted): 0.7153
2025-12-28 17:47:32 - INFO -   Val F1 (macro): 0.6852
2025-12-28 17:47:32 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:47:32 - INFO -   LR: 0.000077
2025-12-28 17:47:32 - INFO -   No improvement (patience: 2/10)
2025-12-28 17:52:42 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:52:42 - INFO - 
Epoch 17/50 - 309.42s
2025-12-28 17:52:42 - INFO -   Train Loss: 0.0412, Train Acc: 0.9476
2025-12-28 17:52:42 - INFO -   Val Loss: 0.2558
2025-12-28 17:52:42 - INFO -   Val Accuracy: 0.6996
2025-12-28 17:52:42 - INFO -   Val Balanced Acc: 0.7365
2025-12-28 17:52:42 - INFO -   Val F1 (weighted): 0.7106
2025-12-28 17:52:42 - INFO -   Val F1 (macro): 0.6477
2025-12-28 17:52:42 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:52:42 - INFO -   LR: 0.000074
2025-12-28 17:52:42 - INFO -   No improvement (patience: 3/10)
2025-12-28 17:57:51 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 17:57:51 - INFO - 
Epoch 18/50 - 309.41s
2025-12-28 17:57:51 - INFO -   Train Loss: 0.0375, Train Acc: 0.9517
2025-12-28 17:57:51 - INFO -   Val Loss: 0.2421
2025-12-28 17:57:51 - INFO -   Val Accuracy: 0.7103
2025-12-28 17:57:51 - INFO -   Val Balanced Acc: 0.7618
2025-12-28 17:57:51 - INFO -   Val F1 (weighted): 0.7153
2025-12-28 17:57:51 - INFO -   Val F1 (macro): 0.6969
2025-12-28 17:57:51 - INFO -   Val AUC (macro): 0.0000
2025-12-28 17:57:51 - INFO -   LR: 0.000071
2025-12-28 17:57:53 - INFO -   Saved best model (balanced_accuracy: 0.7618)
2025-12-28 18:03:03 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:03:03 - INFO - 
Epoch 19/50 - 309.64s
2025-12-28 18:03:03 - INFO -   Train Loss: 0.0335, Train Acc: 0.9551
2025-12-28 18:03:03 - INFO -   Val Loss: 0.2446
2025-12-28 18:03:03 - INFO -   Val Accuracy: 0.7255
2025-12-28 18:03:03 - INFO -   Val Balanced Acc: 0.7826
2025-12-28 18:03:03 - INFO -   Val F1 (weighted): 0.7336
2025-12-28 18:03:03 - INFO -   Val F1 (macro): 0.7054
2025-12-28 18:03:03 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:03:03 - INFO -   LR: 0.000068
2025-12-28 18:03:05 - INFO -   Saved best model (balanced_accuracy: 0.7826)
2025-12-28 18:08:14 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:08:14 - INFO - 
Epoch 20/50 - 309.70s
2025-12-28 18:08:14 - INFO -   Train Loss: 0.0326, Train Acc: 0.9549
2025-12-28 18:08:14 - INFO -   Val Loss: 0.2427
2025-12-28 18:08:14 - INFO -   Val Accuracy: 0.7645
2025-12-28 18:08:14 - INFO -   Val Balanced Acc: 0.7727
2025-12-28 18:08:14 - INFO -   Val F1 (weighted): 0.7704
2025-12-28 18:08:14 - INFO -   Val F1 (macro): 0.7294
2025-12-28 18:08:14 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:08:14 - INFO -   LR: 0.000065
2025-12-28 18:08:14 - INFO -   No improvement (patience: 1/10)
2025-12-28 18:13:24 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:13:24 - INFO - 
Epoch 21/50 - 309.45s
2025-12-28 18:13:24 - INFO -   Train Loss: 0.0257, Train Acc: 0.9613
2025-12-28 18:13:24 - INFO -   Val Loss: 0.2754
2025-12-28 18:13:24 - INFO -   Val Accuracy: 0.7271
2025-12-28 18:13:24 - INFO -   Val Balanced Acc: 0.7577
2025-12-28 18:13:24 - INFO -   Val F1 (weighted): 0.7371
2025-12-28 18:13:24 - INFO -   Val F1 (macro): 0.6947
2025-12-28 18:13:24 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:13:24 - INFO -   LR: 0.000062
2025-12-28 18:13:24 - INFO -   No improvement (patience: 2/10)
2025-12-28 18:18:33 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:18:33 - INFO - 
Epoch 22/50 - 309.60s
2025-12-28 18:18:33 - INFO -   Train Loss: 0.0270, Train Acc: 0.9609
2025-12-28 18:18:33 - INFO -   Val Loss: 0.2594
2025-12-28 18:18:33 - INFO -   Val Accuracy: 0.7608
2025-12-28 18:18:33 - INFO -   Val Balanced Acc: 0.7721
2025-12-28 18:18:33 - INFO -   Val F1 (weighted): 0.7682
2025-12-28 18:18:33 - INFO -   Val F1 (macro): 0.7218
2025-12-28 18:18:33 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:18:33 - INFO -   LR: 0.000059
2025-12-28 18:18:33 - INFO -   No improvement (patience: 3/10)
2025-12-28 18:23:43 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:23:43 - INFO - 
Epoch 23/50 - 309.18s
2025-12-28 18:23:43 - INFO -   Train Loss: 0.0235, Train Acc: 0.9662
2025-12-28 18:23:43 - INFO -   Val Loss: 0.2503
2025-12-28 18:23:43 - INFO -   Val Accuracy: 0.7542
2025-12-28 18:23:43 - INFO -   Val Balanced Acc: 0.7794
2025-12-28 18:23:43 - INFO -   Val F1 (weighted): 0.7633
2025-12-28 18:23:43 - INFO -   Val F1 (macro): 0.6997
2025-12-28 18:23:43 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:23:43 - INFO -   LR: 0.000056
2025-12-28 18:23:43 - INFO -   No improvement (patience: 4/10)
2025-12-28 18:28:52 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:28:52 - INFO - 
Epoch 24/50 - 309.14s
2025-12-28 18:28:52 - INFO -   Train Loss: 0.0231, Train Acc: 0.9673
2025-12-28 18:28:52 - INFO -   Val Loss: 0.2257
2025-12-28 18:28:52 - INFO -   Val Accuracy: 0.7698
2025-12-28 18:28:52 - INFO -   Val Balanced Acc: 0.7689
2025-12-28 18:28:52 - INFO -   Val F1 (weighted): 0.7743
2025-12-28 18:28:52 - INFO -   Val F1 (macro): 0.7366
2025-12-28 18:28:52 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:28:52 - INFO -   LR: 0.000053
2025-12-28 18:28:52 - INFO -   No improvement (patience: 5/10)
2025-12-28 18:34:01 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:34:01 - INFO - 
Epoch 25/50 - 309.06s
2025-12-28 18:34:01 - INFO -   Train Loss: 0.0186, Train Acc: 0.9710
2025-12-28 18:34:01 - INFO -   Val Loss: 0.2625
2025-12-28 18:34:01 - INFO -   Val Accuracy: 0.7222
2025-12-28 18:34:01 - INFO -   Val Balanced Acc: 0.7626
2025-12-28 18:34:01 - INFO -   Val F1 (weighted): 0.7341
2025-12-28 18:34:01 - INFO -   Val F1 (macro): 0.7033
2025-12-28 18:34:01 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:34:01 - INFO -   LR: 0.000050
2025-12-28 18:34:01 - INFO -   No improvement (patience: 6/10)
2025-12-28 18:39:10 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:39:10 - INFO - 
Epoch 26/50 - 308.91s
2025-12-28 18:39:10 - INFO -   Train Loss: 0.0195, Train Acc: 0.9716
2025-12-28 18:39:10 - INFO -   Val Loss: 0.2369
2025-12-28 18:39:10 - INFO -   Val Accuracy: 0.7423
2025-12-28 18:39:10 - INFO -   Val Balanced Acc: 0.7829
2025-12-28 18:39:10 - INFO -   Val F1 (weighted): 0.7523
2025-12-28 18:39:10 - INFO -   Val F1 (macro): 0.7216
2025-12-28 18:39:10 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:39:10 - INFO -   LR: 0.000047
2025-12-28 18:39:12 - INFO -   Saved best model (balanced_accuracy: 0.7829)
2025-12-28 18:44:21 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:44:21 - INFO - 
Epoch 27/50 - 309.03s
2025-12-28 18:44:21 - INFO -   Train Loss: 0.0160, Train Acc: 0.9757
2025-12-28 18:44:21 - INFO -   Val Loss: 0.2276
2025-12-28 18:44:21 - INFO -   Val Accuracy: 0.7969
2025-12-28 18:44:21 - INFO -   Val Balanced Acc: 0.7822
2025-12-28 18:44:21 - INFO -   Val F1 (weighted): 0.8014
2025-12-28 18:44:21 - INFO -   Val F1 (macro): 0.7601
2025-12-28 18:44:21 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:44:21 - INFO -   LR: 0.000044
2025-12-28 18:44:21 - INFO -   No improvement (patience: 1/10)
2025-12-28 18:49:30 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:49:30 - INFO - 
Epoch 28/50 - 308.71s
2025-12-28 18:49:30 - INFO -   Train Loss: 0.0146, Train Acc: 0.9760
2025-12-28 18:49:30 - INFO -   Val Loss: 0.2634
2025-12-28 18:49:30 - INFO -   Val Accuracy: 0.7760
2025-12-28 18:49:30 - INFO -   Val Balanced Acc: 0.7682
2025-12-28 18:49:30 - INFO -   Val F1 (weighted): 0.7824
2025-12-28 18:49:30 - INFO -   Val F1 (macro): 0.7345
2025-12-28 18:49:30 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:49:30 - INFO -   LR: 0.000041
2025-12-28 18:49:30 - INFO -   No improvement (patience: 2/10)
2025-12-28 18:54:39 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:54:39 - INFO - 
Epoch 29/50 - 309.07s
2025-12-28 18:54:39 - INFO -   Train Loss: 0.0146, Train Acc: 0.9775
2025-12-28 18:54:39 - INFO -   Val Loss: 0.2491
2025-12-28 18:54:39 - INFO -   Val Accuracy: 0.7879
2025-12-28 18:54:39 - INFO -   Val Balanced Acc: 0.7870
2025-12-28 18:54:39 - INFO -   Val F1 (weighted): 0.7911
2025-12-28 18:54:39 - INFO -   Val F1 (macro): 0.7601
2025-12-28 18:54:39 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:54:39 - INFO -   LR: 0.000038
2025-12-28 18:54:41 - INFO -   Saved best model (balanced_accuracy: 0.7870)
2025-12-28 18:59:50 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 18:59:50 - INFO - 
Epoch 30/50 - 309.08s
2025-12-28 18:59:50 - INFO -   Train Loss: 0.0115, Train Acc: 0.9800
2025-12-28 18:59:50 - INFO -   Val Loss: 0.2413
2025-12-28 18:59:50 - INFO -   Val Accuracy: 0.7608
2025-12-28 18:59:50 - INFO -   Val Balanced Acc: 0.7717
2025-12-28 18:59:50 - INFO -   Val F1 (weighted): 0.7672
2025-12-28 18:59:50 - INFO -   Val F1 (macro): 0.7461
2025-12-28 18:59:50 - INFO -   Val AUC (macro): 0.0000
2025-12-28 18:59:50 - INFO -   LR: 0.000035
2025-12-28 18:59:50 - INFO -   No improvement (patience: 1/10)
2025-12-28 19:04:59 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:04:59 - INFO - 
Epoch 31/50 - 309.01s
2025-12-28 19:04:59 - INFO -   Train Loss: 0.0105, Train Acc: 0.9814
2025-12-28 19:04:59 - INFO -   Val Loss: 0.2614
2025-12-28 19:04:59 - INFO -   Val Accuracy: 0.7563
2025-12-28 19:04:59 - INFO -   Val Balanced Acc: 0.7832
2025-12-28 19:04:59 - INFO -   Val F1 (weighted): 0.7626
2025-12-28 19:04:59 - INFO -   Val F1 (macro): 0.7552
2025-12-28 19:04:59 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:04:59 - INFO -   LR: 0.000032
2025-12-28 19:04:59 - INFO -   No improvement (patience: 2/10)
2025-12-28 19:10:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:10:08 - INFO - 
Epoch 32/50 - 308.87s
2025-12-28 19:10:08 - INFO -   Train Loss: 0.0101, Train Acc: 0.9805
2025-12-28 19:10:08 - INFO -   Val Loss: 0.2611
2025-12-28 19:10:08 - INFO -   Val Accuracy: 0.7998
2025-12-28 19:10:08 - INFO -   Val Balanced Acc: 0.7895
2025-12-28 19:10:08 - INFO -   Val F1 (weighted): 0.8042
2025-12-28 19:10:08 - INFO -   Val F1 (macro): 0.7656
2025-12-28 19:10:08 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:10:08 - INFO -   LR: 0.000029
2025-12-28 19:10:10 - INFO -   Saved best model (balanced_accuracy: 0.7895)
2025-12-28 19:15:19 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:15:19 - INFO - 
Epoch 33/50 - 309.28s
2025-12-28 19:15:19 - INFO -   Train Loss: 0.0089, Train Acc: 0.9836
2025-12-28 19:15:19 - INFO -   Val Loss: 0.2526
2025-12-28 19:15:19 - INFO -   Val Accuracy: 0.7747
2025-12-28 19:15:19 - INFO -   Val Balanced Acc: 0.7993
2025-12-28 19:15:19 - INFO -   Val F1 (weighted): 0.7819
2025-12-28 19:15:19 - INFO -   Val F1 (macro): 0.7589
2025-12-28 19:15:19 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:15:19 - INFO -   LR: 0.000026
2025-12-28 19:15:21 - INFO -   Saved best model (balanced_accuracy: 0.7993)
2025-12-28 19:20:30 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:20:30 - INFO - 
Epoch 34/50 - 309.11s
2025-12-28 19:20:30 - INFO -   Train Loss: 0.0074, Train Acc: 0.9846
2025-12-28 19:20:30 - INFO -   Val Loss: 0.2674
2025-12-28 19:20:30 - INFO -   Val Accuracy: 0.7858
2025-12-28 19:20:30 - INFO -   Val Balanced Acc: 0.7805
2025-12-28 19:20:30 - INFO -   Val F1 (weighted): 0.7895
2025-12-28 19:20:30 - INFO -   Val F1 (macro): 0.7696
2025-12-28 19:20:30 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:20:30 - INFO -   LR: 0.000023
2025-12-28 19:20:30 - INFO -   No improvement (patience: 1/10)
2025-12-28 19:25:39 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:25:39 - INFO - 
Epoch 35/50 - 308.91s
2025-12-28 19:25:39 - INFO -   Train Loss: 0.0066, Train Acc: 0.9871
2025-12-28 19:25:39 - INFO -   Val Loss: 0.2720
2025-12-28 19:25:39 - INFO -   Val Accuracy: 0.7821
2025-12-28 19:25:39 - INFO -   Val Balanced Acc: 0.8114
2025-12-28 19:25:39 - INFO -   Val F1 (weighted): 0.7874
2025-12-28 19:25:39 - INFO -   Val F1 (macro): 0.7782
2025-12-28 19:25:39 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:25:39 - INFO -   LR: 0.000021
2025-12-28 19:25:40 - INFO -   Saved best model (balanced_accuracy: 0.8114)
2025-12-28 19:30:49 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:30:49 - INFO - 
Epoch 36/50 - 308.86s
2025-12-28 19:30:49 - INFO -   Train Loss: 0.0080, Train Acc: 0.9835
2025-12-28 19:30:49 - INFO -   Val Loss: 0.2368
2025-12-28 19:30:49 - INFO -   Val Accuracy: 0.8260
2025-12-28 19:30:49 - INFO -   Val Balanced Acc: 0.8170
2025-12-28 19:30:49 - INFO -   Val F1 (weighted): 0.8292
2025-12-28 19:30:49 - INFO -   Val F1 (macro): 0.7980
2025-12-28 19:30:49 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:30:49 - INFO -   LR: 0.000018
2025-12-28 19:30:51 - INFO -   Saved best model (balanced_accuracy: 0.8170)
2025-12-28 19:36:00 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:36:00 - INFO - 
Epoch 37/50 - 309.09s
2025-12-28 19:36:00 - INFO -   Train Loss: 0.0061, Train Acc: 0.9859
2025-12-28 19:36:00 - INFO -   Val Loss: 0.2502
2025-12-28 19:36:00 - INFO -   Val Accuracy: 0.8158
2025-12-28 19:36:00 - INFO -   Val Balanced Acc: 0.8029
2025-12-28 19:36:00 - INFO -   Val F1 (weighted): 0.8193
2025-12-28 19:36:00 - INFO -   Val F1 (macro): 0.7799
2025-12-28 19:36:00 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:36:00 - INFO -   LR: 0.000016
2025-12-28 19:36:00 - INFO -   No improvement (patience: 1/10)
2025-12-28 19:41:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:41:09 - INFO - 
Epoch 38/50 - 308.69s
2025-12-28 19:41:09 - INFO -   Train Loss: 0.0057, Train Acc: 0.9873
2025-12-28 19:41:09 - INFO -   Val Loss: 0.2570
2025-12-28 19:41:09 - INFO -   Val Accuracy: 0.8039
2025-12-28 19:41:09 - INFO -   Val Balanced Acc: 0.8047
2025-12-28 19:41:09 - INFO -   Val F1 (weighted): 0.8082
2025-12-28 19:41:09 - INFO -   Val F1 (macro): 0.7814
2025-12-28 19:41:09 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:41:09 - INFO -   LR: 0.000014
2025-12-28 19:41:09 - INFO -   No improvement (patience: 2/10)
2025-12-28 19:46:18 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:46:18 - INFO - 
Epoch 39/50 - 308.94s
2025-12-28 19:46:18 - INFO -   Train Loss: 0.0042, Train Acc: 0.9892
2025-12-28 19:46:18 - INFO -   Val Loss: 0.2590
2025-12-28 19:46:18 - INFO -   Val Accuracy: 0.8240
2025-12-28 19:46:18 - INFO -   Val Balanced Acc: 0.8134
2025-12-28 19:46:18 - INFO -   Val F1 (weighted): 0.8268
2025-12-28 19:46:18 - INFO -   Val F1 (macro): 0.7968
2025-12-28 19:46:18 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:46:18 - INFO -   LR: 0.000011
2025-12-28 19:46:18 - INFO -   No improvement (patience: 3/10)
2025-12-28 19:51:26 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:51:26 - INFO - 
Epoch 40/50 - 308.40s
2025-12-28 19:51:26 - INFO -   Train Loss: 0.0044, Train Acc: 0.9896
2025-12-28 19:51:26 - INFO -   Val Loss: 0.2528
2025-12-28 19:51:26 - INFO -   Val Accuracy: 0.8231
2025-12-28 19:51:26 - INFO -   Val Balanced Acc: 0.8114
2025-12-28 19:51:26 - INFO -   Val F1 (weighted): 0.8256
2025-12-28 19:51:26 - INFO -   Val F1 (macro): 0.7962
2025-12-28 19:51:26 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:51:26 - INFO -   LR: 0.000010
2025-12-28 19:51:26 - INFO -   No improvement (patience: 4/10)
2025-12-28 19:56:35 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 19:56:35 - INFO - 
Epoch 41/50 - 308.44s
2025-12-28 19:56:35 - INFO -   Train Loss: 0.0035, Train Acc: 0.9909
2025-12-28 19:56:35 - INFO -   Val Loss: 0.2669
2025-12-28 19:56:35 - INFO -   Val Accuracy: 0.8125
2025-12-28 19:56:35 - INFO -   Val Balanced Acc: 0.8070
2025-12-28 19:56:35 - INFO -   Val F1 (weighted): 0.8160
2025-12-28 19:56:35 - INFO -   Val F1 (macro): 0.7842
2025-12-28 19:56:35 - INFO -   Val AUC (macro): 0.0000
2025-12-28 19:56:35 - INFO -   LR: 0.000008
2025-12-28 19:56:35 - INFO -   No improvement (patience: 5/10)
2025-12-28 20:01:43 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 20:01:43 - INFO - 
Epoch 42/50 - 308.39s
2025-12-28 20:01:43 - INFO -   Train Loss: 0.0033, Train Acc: 0.9914
2025-12-28 20:01:43 - INFO -   Val Loss: 0.2729
2025-12-28 20:01:43 - INFO -   Val Accuracy: 0.8141
2025-12-28 20:01:43 - INFO -   Val Balanced Acc: 0.8036
2025-12-28 20:01:43 - INFO -   Val F1 (weighted): 0.8167
2025-12-28 20:01:43 - INFO -   Val F1 (macro): 0.7864
2025-12-28 20:01:43 - INFO -   Val AUC (macro): 0.0000
2025-12-28 20:01:43 - INFO -   LR: 0.000006
2025-12-28 20:01:43 - INFO -   No improvement (patience: 6/10)
2025-12-28 20:06:52 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 20:06:52 - INFO - 
Epoch 43/50 - 308.89s
2025-12-28 20:06:52 - INFO -   Train Loss: 0.0034, Train Acc: 0.9906
2025-12-28 20:06:52 - INFO -   Val Loss: 0.2655
2025-12-28 20:06:52 - INFO -   Val Accuracy: 0.8256
2025-12-28 20:06:52 - INFO -   Val Balanced Acc: 0.8061
2025-12-28 20:06:52 - INFO -   Val F1 (weighted): 0.8286
2025-12-28 20:06:52 - INFO -   Val F1 (macro): 0.7914
2025-12-28 20:06:52 - INFO -   Val AUC (macro): 0.0000
2025-12-28 20:06:52 - INFO -   LR: 0.000005
2025-12-28 20:06:52 - INFO -   No improvement (patience: 7/10)
2025-12-28 20:12:01 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 20:12:01 - INFO - 
Epoch 44/50 - 308.60s
2025-12-28 20:12:01 - INFO -   Train Loss: 0.0031, Train Acc: 0.9915
2025-12-28 20:12:01 - INFO -   Val Loss: 0.2637
2025-12-28 20:12:01 - INFO -   Val Accuracy: 0.8034
2025-12-28 20:12:01 - INFO -   Val Balanced Acc: 0.8072
2025-12-28 20:12:01 - INFO -   Val F1 (weighted): 0.8073
2025-12-28 20:12:01 - INFO -   Val F1 (macro): 0.7868
2025-12-28 20:12:01 - INFO -   Val AUC (macro): 0.0000
2025-12-28 20:12:01 - INFO -   LR: 0.000004
2025-12-28 20:12:01 - INFO -   No improvement (patience: 8/10)
2025-12-28 20:17:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 20:17:09 - INFO - 
Epoch 45/50 - 308.50s
2025-12-28 20:17:09 - INFO -   Train Loss: 0.0026, Train Acc: 0.9921
2025-12-28 20:17:09 - INFO -   Val Loss: 0.2677
2025-12-28 20:17:09 - INFO -   Val Accuracy: 0.8084
2025-12-28 20:17:09 - INFO -   Val Balanced Acc: 0.8081
2025-12-28 20:17:09 - INFO -   Val F1 (weighted): 0.8127
2025-12-28 20:17:09 - INFO -   Val F1 (macro): 0.7927
2025-12-28 20:17:09 - INFO -   Val AUC (macro): 0.0000
2025-12-28 20:17:09 - INFO -   LR: 0.000002
2025-12-28 20:17:09 - INFO -   No improvement (patience: 9/10)
2025-12-28 20:22:18 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 20:22:18 - INFO - 
Epoch 46/50 - 308.30s
2025-12-28 20:22:18 - INFO -   Train Loss: 0.0024, Train Acc: 0.9922
2025-12-28 20:22:18 - INFO -   Val Loss: 0.2695
2025-12-28 20:22:18 - INFO -   Val Accuracy: 0.8215
2025-12-28 20:22:18 - INFO -   Val Balanced Acc: 0.8106
2025-12-28 20:22:18 - INFO -   Val F1 (weighted): 0.8248
2025-12-28 20:22:18 - INFO -   Val F1 (macro): 0.7957
2025-12-28 20:22:18 - INFO -   Val AUC (macro): 0.0000
2025-12-28 20:22:18 - INFO -   LR: 0.000002
2025-12-28 20:22:18 - INFO -   No improvement (patience: 10/10)
2025-12-28 20:22:18 - INFO - 
Early stopping at epoch 46
2025-12-28 20:22:18 - INFO - 
================================================================================
2025-12-28 20:22:18 - INFO - TRAINING COMPLETE
2025-12-28 20:22:18 - INFO - ================================================================================
2025-12-28 20:22:18 - INFO - Total time: 237.72 minutes
2025-12-28 20:22:18 - INFO - Best balanced_accuracy: 0.8170 (epoch 36)
2025-12-28 20:22:18 - INFO - Average time per epoch: 310.07 seconds
2025-12-28 20:22:18 - INFO - Model saved to: models/swin_fold9_20251228_162421
2025-12-28 20:22:18 - INFO - 
Results saved to: models/swin_fold9_20251228_162421/final_results.json
