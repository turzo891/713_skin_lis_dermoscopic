2025-12-27 16:51:02 - INFO - Logging initialized. Log file: models/swin_fold0_20251227_165102/training.log
2025-12-27 16:51:02 - INFO - ================================================================================
2025-12-27 16:51:02 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-27 16:51:02 - INFO - ================================================================================
2025-12-27 16:51:02 - INFO - Model: swin
2025-12-27 16:51:02 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-27 16:51:02 - INFO - Fold: 0
2025-12-27 16:51:02 - INFO - Batch size: 16
2025-12-27 16:51:02 - INFO - Effective batch size: 16
2025-12-27 16:51:02 - INFO - Epochs: 50
2025-12-27 16:51:02 - INFO - Learning rate: 0.0001
2025-12-27 16:51:02 - INFO - Workers: 8
2025-12-27 16:51:02 - INFO - Mixed precision: True
2025-12-27 16:51:02 - INFO - Gradient accumulation: 1
2025-12-27 16:51:02 - INFO - Prefetch factor: 2
2025-12-27 16:51:02 - INFO - Focal loss: True
2025-12-27 16:51:02 - INFO - Skin tone sampling: True
2025-12-27 16:51:02 - INFO - Device: cuda
2025-12-27 16:51:02 - INFO - Output: models/swin_fold0_20251227_165102
2025-12-27 16:51:02 - INFO - ================================================================================
2025-12-27 16:51:02 - INFO - 
Creating data loaders...
2025-12-27 16:51:03 - INFO - Train samples: 21936
2025-12-27 16:51:03 - INFO - Val samples: 2438
2025-12-27 16:51:03 - INFO - 
Creating swin model...
2025-12-27 16:51:05 - INFO - 
Starting training...

2025-12-27 16:56:22 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 16:56:22 - INFO - 
Epoch 1/50 - 316.33s
2025-12-27 16:56:22 - INFO -   Train Loss: 0.4071, Train Acc: 0.6688
2025-12-27 16:56:22 - INFO -   Val Loss: 0.4350
2025-12-27 16:56:22 - INFO -   Val Accuracy: 0.4729
2025-12-27 16:56:22 - INFO -   Val Balanced Acc: 0.5971
2025-12-27 16:56:22 - INFO -   Val F1 (weighted): 0.5041
2025-12-27 16:56:22 - INFO -   Val F1 (macro): 0.4710
2025-12-27 16:56:22 - INFO -   Val AUC (macro): 0.0000
2025-12-27 16:56:22 - INFO -   LR: 0.000100
2025-12-27 16:56:23 - INFO -   Saved best model (balanced_accuracy: 0.5971)
2025-12-27 17:01:38 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:01:38 - INFO - 
Epoch 2/50 - 314.53s
2025-12-27 17:01:38 - INFO -   Train Loss: 0.2061, Train Acc: 0.8053
2025-12-27 17:01:38 - INFO -   Val Loss: 0.3402
2025-12-27 17:01:38 - INFO -   Val Accuracy: 0.5833
2025-12-27 17:01:38 - INFO -   Val Balanced Acc: 0.6766
2025-12-27 17:01:38 - INFO -   Val F1 (weighted): 0.6018
2025-12-27 17:01:38 - INFO -   Val F1 (macro): 0.5812
2025-12-27 17:01:38 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:01:38 - INFO -   LR: 0.000100
2025-12-27 17:01:40 - INFO -   Saved best model (balanced_accuracy: 0.6766)
2025-12-27 17:06:54 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:06:54 - INFO - 
Epoch 3/50 - 314.13s
2025-12-27 17:06:54 - INFO -   Train Loss: 0.1618, Train Acc: 0.8317
2025-12-27 17:06:54 - INFO -   Val Loss: 0.2981
2025-12-27 17:06:54 - INFO -   Val Accuracy: 0.5595
2025-12-27 17:06:54 - INFO -   Val Balanced Acc: 0.6929
2025-12-27 17:06:54 - INFO -   Val F1 (weighted): 0.5685
2025-12-27 17:06:54 - INFO -   Val F1 (macro): 0.5809
2025-12-27 17:06:54 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:06:54 - INFO -   LR: 0.000099
2025-12-27 17:06:56 - INFO -   Saved best model (balanced_accuracy: 0.6929)
2025-12-27 17:12:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:12:09 - INFO - 
Epoch 4/50 - 312.50s
2025-12-27 17:12:09 - INFO -   Train Loss: 0.1351, Train Acc: 0.8510
2025-12-27 17:12:09 - INFO -   Val Loss: 0.3696
2025-12-27 17:12:09 - INFO -   Val Accuracy: 0.5217
2025-12-27 17:12:09 - INFO -   Val Balanced Acc: 0.6740
2025-12-27 17:12:09 - INFO -   Val F1 (weighted): 0.5261
2025-12-27 17:12:09 - INFO -   Val F1 (macro): 0.5385
2025-12-27 17:12:09 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:12:09 - INFO -   LR: 0.000098
2025-12-27 17:12:09 - INFO -   No improvement (patience: 1/10)
2025-12-27 17:17:22 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:17:22 - INFO - 
Epoch 5/50 - 313.48s
2025-12-27 17:17:22 - INFO -   Train Loss: 0.1213, Train Acc: 0.8657
2025-12-27 17:17:22 - INFO -   Val Loss: 0.3703
2025-12-27 17:17:22 - INFO -   Val Accuracy: 0.5619
2025-12-27 17:17:22 - INFO -   Val Balanced Acc: 0.6968
2025-12-27 17:17:22 - INFO -   Val F1 (weighted): 0.5718
2025-12-27 17:17:22 - INFO -   Val F1 (macro): 0.5475
2025-12-27 17:17:22 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:17:22 - INFO -   LR: 0.000098
2025-12-27 17:17:24 - INFO -   Saved best model (balanced_accuracy: 0.6968)
2025-12-27 17:22:38 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:22:38 - INFO - 
Epoch 6/50 - 313.54s
2025-12-27 17:22:38 - INFO -   Train Loss: 0.0983, Train Acc: 0.8866
2025-12-27 17:22:38 - INFO -   Val Loss: 0.2753
2025-12-27 17:22:38 - INFO -   Val Accuracy: 0.6829
2025-12-27 17:22:38 - INFO -   Val Balanced Acc: 0.7230
2025-12-27 17:22:38 - INFO -   Val F1 (weighted): 0.6931
2025-12-27 17:22:38 - INFO -   Val F1 (macro): 0.6662
2025-12-27 17:22:38 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:22:38 - INFO -   LR: 0.000096
2025-12-27 17:22:40 - INFO -   Saved best model (balanced_accuracy: 0.7230)
2025-12-27 17:27:53 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:27:53 - INFO - 
Epoch 7/50 - 313.28s
2025-12-27 17:27:53 - INFO -   Train Loss: 0.0933, Train Acc: 0.8908
2025-12-27 17:27:53 - INFO -   Val Loss: 0.2913
2025-12-27 17:27:53 - INFO -   Val Accuracy: 0.7457
2025-12-27 17:27:53 - INFO -   Val Balanced Acc: 0.7531
2025-12-27 17:27:53 - INFO -   Val F1 (weighted): 0.7514
2025-12-27 17:27:53 - INFO -   Val F1 (macro): 0.6517
2025-12-27 17:27:53 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:27:53 - INFO -   LR: 0.000095
2025-12-27 17:27:55 - INFO -   Saved best model (balanced_accuracy: 0.7531)
2025-12-27 17:33:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:33:08 - INFO - 
Epoch 8/50 - 312.99s
2025-12-27 17:33:08 - INFO -   Train Loss: 0.0809, Train Acc: 0.9021
2025-12-27 17:33:08 - INFO -   Val Loss: 0.4234
2025-12-27 17:33:08 - INFO -   Val Accuracy: 0.5931
2025-12-27 17:33:08 - INFO -   Val Balanced Acc: 0.6515
2025-12-27 17:33:08 - INFO -   Val F1 (weighted): 0.6270
2025-12-27 17:33:08 - INFO -   Val F1 (macro): 0.5416
2025-12-27 17:33:08 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:33:08 - INFO -   LR: 0.000094
2025-12-27 17:33:08 - INFO -   No improvement (patience: 1/10)
2025-12-27 17:38:21 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:38:21 - INFO - 
Epoch 9/50 - 312.50s
2025-12-27 17:38:21 - INFO -   Train Loss: 0.0734, Train Acc: 0.9120
2025-12-27 17:38:21 - INFO -   Val Loss: 0.2759
2025-12-27 17:38:21 - INFO -   Val Accuracy: 0.5919
2025-12-27 17:38:21 - INFO -   Val Balanced Acc: 0.7211
2025-12-27 17:38:21 - INFO -   Val F1 (weighted): 0.6057
2025-12-27 17:38:21 - INFO -   Val F1 (macro): 0.6329
2025-12-27 17:38:21 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:38:21 - INFO -   LR: 0.000092
2025-12-27 17:38:21 - INFO -   No improvement (patience: 2/10)
2025-12-27 17:43:33 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:43:33 - INFO - 
Epoch 10/50 - 312.90s
2025-12-27 17:43:33 - INFO -   Train Loss: 0.0702, Train Acc: 0.9162
2025-12-27 17:43:33 - INFO -   Val Loss: 0.2842
2025-12-27 17:43:33 - INFO -   Val Accuracy: 0.6489
2025-12-27 17:43:33 - INFO -   Val Balanced Acc: 0.7398
2025-12-27 17:43:33 - INFO -   Val F1 (weighted): 0.6654
2025-12-27 17:43:33 - INFO -   Val F1 (macro): 0.6330
2025-12-27 17:43:33 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:43:33 - INFO -   LR: 0.000090
2025-12-27 17:43:33 - INFO -   No improvement (patience: 3/10)
2025-12-27 17:48:47 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:48:47 - INFO - 
Epoch 11/50 - 313.42s
2025-12-27 17:48:47 - INFO -   Train Loss: 0.0634, Train Acc: 0.9215
2025-12-27 17:48:47 - INFO -   Val Loss: 0.2580
2025-12-27 17:48:47 - INFO -   Val Accuracy: 0.7211
2025-12-27 17:48:47 - INFO -   Val Balanced Acc: 0.7228
2025-12-27 17:48:47 - INFO -   Val F1 (weighted): 0.7293
2025-12-27 17:48:47 - INFO -   Val F1 (macro): 0.6781
2025-12-27 17:48:47 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:48:47 - INFO -   LR: 0.000089
2025-12-27 17:48:47 - INFO -   No improvement (patience: 4/10)
2025-12-27 17:54:00 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:54:00 - INFO - 
Epoch 12/50 - 313.14s
2025-12-27 17:54:00 - INFO -   Train Loss: 0.0603, Train Acc: 0.9258
2025-12-27 17:54:00 - INFO -   Val Loss: 0.2586
2025-12-27 17:54:00 - INFO -   Val Accuracy: 0.6920
2025-12-27 17:54:00 - INFO -   Val Balanced Acc: 0.7702
2025-12-27 17:54:00 - INFO -   Val F1 (weighted): 0.6991
2025-12-27 17:54:00 - INFO -   Val F1 (macro): 0.6808
2025-12-27 17:54:00 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:54:00 - INFO -   LR: 0.000086
2025-12-27 17:54:02 - INFO -   Saved best model (balanced_accuracy: 0.7702)
2025-12-27 17:59:14 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 17:59:14 - INFO - 
Epoch 13/50 - 311.58s
2025-12-27 17:59:14 - INFO -   Train Loss: 0.0532, Train Acc: 0.9331
2025-12-27 17:59:14 - INFO -   Val Loss: 0.2318
2025-12-27 17:59:14 - INFO -   Val Accuracy: 0.7231
2025-12-27 17:59:14 - INFO -   Val Balanced Acc: 0.7464
2025-12-27 17:59:14 - INFO -   Val F1 (weighted): 0.7287
2025-12-27 17:59:14 - INFO -   Val F1 (macro): 0.7020
2025-12-27 17:59:14 - INFO -   Val AUC (macro): 0.0000
2025-12-27 17:59:14 - INFO -   LR: 0.000084
2025-12-27 17:59:14 - INFO -   No improvement (patience: 1/10)
2025-12-27 18:04:26 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:04:26 - INFO - 
Epoch 14/50 - 311.77s
2025-12-27 18:04:26 - INFO -   Train Loss: 0.0514, Train Acc: 0.9342
2025-12-27 18:04:26 - INFO -   Val Loss: 0.2696
2025-12-27 18:04:26 - INFO -   Val Accuracy: 0.7194
2025-12-27 18:04:26 - INFO -   Val Balanced Acc: 0.7501
2025-12-27 18:04:26 - INFO -   Val F1 (weighted): 0.7277
2025-12-27 18:04:26 - INFO -   Val F1 (macro): 0.6609
2025-12-27 18:04:26 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:04:26 - INFO -   LR: 0.000082
2025-12-27 18:04:26 - INFO -   No improvement (patience: 2/10)
2025-12-27 18:09:39 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:09:39 - INFO - 
Epoch 15/50 - 313.12s
2025-12-27 18:09:39 - INFO -   Train Loss: 0.0435, Train Acc: 0.9419
2025-12-27 18:09:39 - INFO -   Val Loss: 0.2617
2025-12-27 18:09:39 - INFO -   Val Accuracy: 0.6419
2025-12-27 18:09:39 - INFO -   Val Balanced Acc: 0.7278
2025-12-27 18:09:39 - INFO -   Val F1 (weighted): 0.6613
2025-12-27 18:09:39 - INFO -   Val F1 (macro): 0.6669
2025-12-27 18:09:39 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:09:39 - INFO -   LR: 0.000079
2025-12-27 18:09:39 - INFO -   No improvement (patience: 3/10)
2025-12-27 18:14:52 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:14:52 - INFO - 
Epoch 16/50 - 313.11s
2025-12-27 18:14:52 - INFO -   Train Loss: 0.0394, Train Acc: 0.9462
2025-12-27 18:14:52 - INFO -   Val Loss: 0.2686
2025-12-27 18:14:52 - INFO -   Val Accuracy: 0.6850
2025-12-27 18:14:52 - INFO -   Val Balanced Acc: 0.7510
2025-12-27 18:14:52 - INFO -   Val F1 (weighted): 0.6982
2025-12-27 18:14:52 - INFO -   Val F1 (macro): 0.6316
2025-12-27 18:14:52 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:14:52 - INFO -   LR: 0.000077
2025-12-27 18:14:52 - INFO -   No improvement (patience: 4/10)
2025-12-27 18:20:04 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:20:04 - INFO - 
Epoch 17/50 - 312.56s
2025-12-27 18:20:04 - INFO -   Train Loss: 0.0387, Train Acc: 0.9496
2025-12-27 18:20:04 - INFO -   Val Loss: 0.2492
2025-12-27 18:20:04 - INFO -   Val Accuracy: 0.6760
2025-12-27 18:20:04 - INFO -   Val Balanced Acc: 0.7414
2025-12-27 18:20:04 - INFO -   Val F1 (weighted): 0.6833
2025-12-27 18:20:04 - INFO -   Val F1 (macro): 0.6968
2025-12-27 18:20:04 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:20:04 - INFO -   LR: 0.000074
2025-12-27 18:20:04 - INFO -   No improvement (patience: 5/10)
2025-12-27 18:25:15 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:25:15 - INFO - 
Epoch 18/50 - 311.03s
2025-12-27 18:25:15 - INFO -   Train Loss: 0.0373, Train Acc: 0.9493
2025-12-27 18:25:15 - INFO -   Val Loss: 0.2924
2025-12-27 18:25:15 - INFO -   Val Accuracy: 0.6916
2025-12-27 18:25:15 - INFO -   Val Balanced Acc: 0.7483
2025-12-27 18:25:15 - INFO -   Val F1 (weighted): 0.6995
2025-12-27 18:25:15 - INFO -   Val F1 (macro): 0.6817
2025-12-27 18:25:15 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:25:15 - INFO -   LR: 0.000071
2025-12-27 18:25:15 - INFO -   No improvement (patience: 6/10)
2025-12-27 18:30:26 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:30:26 - INFO - 
Epoch 19/50 - 310.88s
2025-12-27 18:30:26 - INFO -   Train Loss: 0.0353, Train Acc: 0.9515
2025-12-27 18:30:26 - INFO -   Val Loss: 0.2405
2025-12-27 18:30:26 - INFO -   Val Accuracy: 0.6985
2025-12-27 18:30:26 - INFO -   Val Balanced Acc: 0.7788
2025-12-27 18:30:26 - INFO -   Val F1 (weighted): 0.7052
2025-12-27 18:30:26 - INFO -   Val F1 (macro): 0.6945
2025-12-27 18:30:26 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:30:26 - INFO -   LR: 0.000068
2025-12-27 18:30:28 - INFO -   Saved best model (balanced_accuracy: 0.7788)
2025-12-27 18:35:39 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:35:39 - INFO - 
Epoch 20/50 - 310.62s
2025-12-27 18:35:39 - INFO -   Train Loss: 0.0302, Train Acc: 0.9573
2025-12-27 18:35:39 - INFO -   Val Loss: 0.2557
2025-12-27 18:35:39 - INFO -   Val Accuracy: 0.6645
2025-12-27 18:35:39 - INFO -   Val Balanced Acc: 0.7249
2025-12-27 18:35:39 - INFO -   Val F1 (weighted): 0.6740
2025-12-27 18:35:39 - INFO -   Val F1 (macro): 0.6730
2025-12-27 18:35:39 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:35:39 - INFO -   LR: 0.000065
2025-12-27 18:35:39 - INFO -   No improvement (patience: 1/10)
2025-12-27 18:40:50 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:40:50 - INFO - 
Epoch 21/50 - 310.85s
2025-12-27 18:40:50 - INFO -   Train Loss: 0.0289, Train Acc: 0.9580
2025-12-27 18:40:50 - INFO -   Val Loss: 0.2342
2025-12-27 18:40:50 - INFO -   Val Accuracy: 0.6940
2025-12-27 18:40:50 - INFO -   Val Balanced Acc: 0.7373
2025-12-27 18:40:50 - INFO -   Val F1 (weighted): 0.6969
2025-12-27 18:40:50 - INFO -   Val F1 (macro): 0.6980
2025-12-27 18:40:50 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:40:50 - INFO -   LR: 0.000062
2025-12-27 18:40:50 - INFO -   No improvement (patience: 2/10)
2025-12-27 18:46:02 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:46:02 - INFO - 
Epoch 22/50 - 312.45s
2025-12-27 18:46:02 - INFO -   Train Loss: 0.0251, Train Acc: 0.9639
2025-12-27 18:46:02 - INFO -   Val Loss: 0.2228
2025-12-27 18:46:02 - INFO -   Val Accuracy: 0.7691
2025-12-27 18:46:02 - INFO -   Val Balanced Acc: 0.7719
2025-12-27 18:46:02 - INFO -   Val F1 (weighted): 0.7743
2025-12-27 18:46:02 - INFO -   Val F1 (macro): 0.7201
2025-12-27 18:46:02 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:46:02 - INFO -   LR: 0.000059
2025-12-27 18:46:02 - INFO -   No improvement (patience: 3/10)
2025-12-27 18:51:15 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:51:15 - INFO - 
Epoch 23/50 - 312.91s
2025-12-27 18:51:15 - INFO -   Train Loss: 0.0232, Train Acc: 0.9669
2025-12-27 18:51:15 - INFO -   Val Loss: 0.2547
2025-12-27 18:51:15 - INFO -   Val Accuracy: 0.6813
2025-12-27 18:51:15 - INFO -   Val Balanced Acc: 0.7203
2025-12-27 18:51:15 - INFO -   Val F1 (weighted): 0.6854
2025-12-27 18:51:15 - INFO -   Val F1 (macro): 0.6942
2025-12-27 18:51:15 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:51:15 - INFO -   LR: 0.000056
2025-12-27 18:51:15 - INFO -   No improvement (patience: 4/10)
2025-12-27 18:56:28 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 18:56:28 - INFO - 
Epoch 24/50 - 312.96s
2025-12-27 18:56:28 - INFO -   Train Loss: 0.0217, Train Acc: 0.9659
2025-12-27 18:56:28 - INFO -   Val Loss: 0.2453
2025-12-27 18:56:28 - INFO -   Val Accuracy: 0.7322
2025-12-27 18:56:28 - INFO -   Val Balanced Acc: 0.7356
2025-12-27 18:56:28 - INFO -   Val F1 (weighted): 0.7448
2025-12-27 18:56:28 - INFO -   Val F1 (macro): 0.7108
2025-12-27 18:56:28 - INFO -   Val AUC (macro): 0.0000
2025-12-27 18:56:28 - INFO -   LR: 0.000053
2025-12-27 18:56:28 - INFO -   No improvement (patience: 5/10)
2025-12-27 19:01:40 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:01:40 - INFO - 
Epoch 25/50 - 312.26s
2025-12-27 19:01:40 - INFO -   Train Loss: 0.0216, Train Acc: 0.9694
2025-12-27 19:01:40 - INFO -   Val Loss: 0.2516
2025-12-27 19:01:40 - INFO -   Val Accuracy: 0.7219
2025-12-27 19:01:40 - INFO -   Val Balanced Acc: 0.7755
2025-12-27 19:01:40 - INFO -   Val F1 (weighted): 0.7329
2025-12-27 19:01:40 - INFO -   Val F1 (macro): 0.6909
2025-12-27 19:01:40 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:01:40 - INFO -   LR: 0.000050
2025-12-27 19:01:40 - INFO -   No improvement (patience: 6/10)
2025-12-27 19:06:51 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:06:51 - INFO - 
Epoch 26/50 - 310.66s
2025-12-27 19:06:51 - INFO -   Train Loss: 0.0178, Train Acc: 0.9695
2025-12-27 19:06:51 - INFO -   Val Loss: 0.2361
2025-12-27 19:06:51 - INFO -   Val Accuracy: 0.7941
2025-12-27 19:06:51 - INFO -   Val Balanced Acc: 0.7776
2025-12-27 19:06:51 - INFO -   Val F1 (weighted): 0.7978
2025-12-27 19:06:51 - INFO -   Val F1 (macro): 0.7424
2025-12-27 19:06:51 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:06:51 - INFO -   LR: 0.000047
2025-12-27 19:06:51 - INFO -   No improvement (patience: 7/10)
2025-12-27 19:12:02 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:12:02 - INFO - 
Epoch 27/50 - 310.80s
2025-12-27 19:12:02 - INFO -   Train Loss: 0.0166, Train Acc: 0.9722
2025-12-27 19:12:02 - INFO -   Val Loss: 0.2163
2025-12-27 19:12:02 - INFO -   Val Accuracy: 0.7018
2025-12-27 19:12:02 - INFO -   Val Balanced Acc: 0.7582
2025-12-27 19:12:02 - INFO -   Val F1 (weighted): 0.7050
2025-12-27 19:12:02 - INFO -   Val F1 (macro): 0.7213
2025-12-27 19:12:02 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:12:02 - INFO -   LR: 0.000044
2025-12-27 19:12:02 - INFO -   No improvement (patience: 8/10)
2025-12-27 19:17:12 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:17:12 - INFO - 
Epoch 28/50 - 310.64s
2025-12-27 19:17:12 - INFO -   Train Loss: 0.0157, Train Acc: 0.9733
2025-12-27 19:17:12 - INFO -   Val Loss: 0.2262
2025-12-27 19:17:12 - INFO -   Val Accuracy: 0.7326
2025-12-27 19:17:12 - INFO -   Val Balanced Acc: 0.7753
2025-12-27 19:17:12 - INFO -   Val F1 (weighted): 0.7420
2025-12-27 19:17:12 - INFO -   Val F1 (macro): 0.7465
2025-12-27 19:17:12 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:17:12 - INFO -   LR: 0.000041
2025-12-27 19:17:12 - INFO -   No improvement (patience: 9/10)
2025-12-27 19:22:23 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:22:23 - INFO - 
Epoch 29/50 - 310.80s
2025-12-27 19:22:23 - INFO -   Train Loss: 0.0141, Train Acc: 0.9766
2025-12-27 19:22:23 - INFO -   Val Loss: 0.2277
2025-12-27 19:22:23 - INFO -   Val Accuracy: 0.7875
2025-12-27 19:22:23 - INFO -   Val Balanced Acc: 0.7713
2025-12-27 19:22:23 - INFO -   Val F1 (weighted): 0.7900
2025-12-27 19:22:23 - INFO -   Val F1 (macro): 0.7530
2025-12-27 19:22:23 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:22:23 - INFO -   LR: 0.000038
2025-12-27 19:22:23 - INFO -   No improvement (patience: 10/10)
2025-12-27 19:22:23 - INFO - 
Early stopping at epoch 29
2025-12-27 19:22:23 - INFO - 
================================================================================
2025-12-27 19:22:23 - INFO - TRAINING COMPLETE
2025-12-27 19:22:23 - INFO - ================================================================================
2025-12-27 19:22:23 - INFO - Total time: 151.30 minutes
2025-12-27 19:22:23 - INFO - Best balanced_accuracy: 0.7788 (epoch 19)
2025-12-27 19:22:23 - INFO - Average time per epoch: 313.03 seconds
2025-12-27 19:22:23 - INFO - Model saved to: models/swin_fold0_20251227_165102
2025-12-27 19:22:23 - INFO - 
Results saved to: models/swin_fold0_20251227_165102/final_results.json
