2025-12-24 04:57:53 - INFO - Logging initialized. Log file: models/densenet_fold5_20251224_045753/training.log
2025-12-24 04:57:54 - INFO - ================================================================================
2025-12-24 04:57:54 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-24 04:57:54 - INFO - ================================================================================
2025-12-24 04:57:54 - INFO - Model: densenet
2025-12-24 04:57:54 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-24 04:57:54 - INFO - Fold: 5
2025-12-24 04:57:54 - INFO - Batch size: 32
2025-12-24 04:57:54 - INFO - Effective batch size: 32
2025-12-24 04:57:54 - INFO - Epochs: 50
2025-12-24 04:57:54 - INFO - Learning rate: 0.0001
2025-12-24 04:57:54 - INFO - Workers: 8
2025-12-24 04:57:54 - INFO - Mixed precision: True
2025-12-24 04:57:54 - INFO - Gradient accumulation: 1
2025-12-24 04:57:54 - INFO - Prefetch factor: 2
2025-12-24 04:57:54 - INFO - Focal loss: True
2025-12-24 04:57:54 - INFO - Skin tone sampling: True
2025-12-24 04:57:54 - INFO - Device: cuda
2025-12-24 04:57:54 - INFO - Output: models/densenet_fold5_20251224_045753
2025-12-24 04:57:54 - INFO - ================================================================================
2025-12-24 04:57:54 - INFO - 
Creating data loaders...
2025-12-24 04:57:54 - INFO - Train samples: 21937
2025-12-24 04:57:54 - INFO - Val samples: 2437
2025-12-24 04:57:54 - INFO - 
Creating densenet model...
2025-12-24 04:57:55 - INFO - 
Starting training...

2025-12-24 04:59:34 - INFO - 
Epoch 1/50 - 98.96s
2025-12-24 04:59:34 - INFO -   Train Loss: 0.4000, Train Acc: 0.6791
2025-12-24 04:59:34 - INFO -   Val Loss: 0.3921
2025-12-24 04:59:34 - INFO -   Val Accuracy: 0.5585
2025-12-24 04:59:34 - INFO -   Val Balanced Acc: 0.6270
2025-12-24 04:59:34 - INFO -   Val F1 (weighted): 0.5900
2025-12-24 04:59:34 - INFO -   Val F1 (macro): 0.4943
2025-12-24 04:59:34 - INFO -   Val AUC (macro): 0.0000
2025-12-24 04:59:34 - INFO -   LR: 0.000100
2025-12-24 04:59:34 - INFO -   Saved best model (balanced_accuracy: 0.6270)
2025-12-24 05:01:12 - INFO - 
Epoch 2/50 - 97.82s
2025-12-24 05:01:12 - INFO -   Train Loss: 0.2203, Train Acc: 0.7938
2025-12-24 05:01:12 - INFO -   Val Loss: 0.2844
2025-12-24 05:01:12 - INFO -   Val Accuracy: 0.6713
2025-12-24 05:01:12 - INFO -   Val Balanced Acc: 0.6890
2025-12-24 05:01:12 - INFO -   Val F1 (weighted): 0.6854
2025-12-24 05:01:12 - INFO -   Val F1 (macro): 0.5835
2025-12-24 05:01:12 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:01:12 - INFO -   LR: 0.000100
2025-12-24 05:01:13 - INFO -   Saved best model (balanced_accuracy: 0.6890)
2025-12-24 05:02:49 - INFO - 
Epoch 3/50 - 96.02s
2025-12-24 05:02:49 - INFO -   Train Loss: 0.1710, Train Acc: 0.8313
2025-12-24 05:02:49 - INFO -   Val Loss: 0.2807
2025-12-24 05:02:49 - INFO -   Val Accuracy: 0.6368
2025-12-24 05:02:49 - INFO -   Val Balanced Acc: 0.6786
2025-12-24 05:02:49 - INFO -   Val F1 (weighted): 0.6518
2025-12-24 05:02:49 - INFO -   Val F1 (macro): 0.6068
2025-12-24 05:02:49 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:02:49 - INFO -   LR: 0.000099
2025-12-24 05:02:49 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:04:23 - INFO - 
Epoch 4/50 - 94.56s
2025-12-24 05:04:23 - INFO -   Train Loss: 0.1383, Train Acc: 0.8569
2025-12-24 05:04:23 - INFO -   Val Loss: 0.3066
2025-12-24 05:04:23 - INFO -   Val Accuracy: 0.6496
2025-12-24 05:04:23 - INFO -   Val Balanced Acc: 0.7058
2025-12-24 05:04:23 - INFO -   Val F1 (weighted): 0.6682
2025-12-24 05:04:23 - INFO -   Val F1 (macro): 0.6221
2025-12-24 05:04:23 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:04:23 - INFO -   LR: 0.000098
2025-12-24 05:04:24 - INFO -   Saved best model (balanced_accuracy: 0.7058)
2025-12-24 05:05:59 - INFO - 
Epoch 5/50 - 94.82s
2025-12-24 05:05:59 - INFO -   Train Loss: 0.1192, Train Acc: 0.8724
2025-12-24 05:05:59 - INFO -   Val Loss: 0.2713
2025-12-24 05:05:59 - INFO -   Val Accuracy: 0.6709
2025-12-24 05:05:59 - INFO -   Val Balanced Acc: 0.7173
2025-12-24 05:05:59 - INFO -   Val F1 (weighted): 0.6854
2025-12-24 05:05:59 - INFO -   Val F1 (macro): 0.6014
2025-12-24 05:05:59 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:05:59 - INFO -   LR: 0.000098
2025-12-24 05:05:59 - INFO -   Saved best model (balanced_accuracy: 0.7173)
2025-12-24 05:07:34 - INFO - 
Epoch 6/50 - 94.51s
2025-12-24 05:07:34 - INFO -   Train Loss: 0.0973, Train Acc: 0.8926
2025-12-24 05:07:34 - INFO -   Val Loss: 0.2640
2025-12-24 05:07:34 - INFO -   Val Accuracy: 0.6524
2025-12-24 05:07:34 - INFO -   Val Balanced Acc: 0.7138
2025-12-24 05:07:34 - INFO -   Val F1 (weighted): 0.6681
2025-12-24 05:07:34 - INFO -   Val F1 (macro): 0.6248
2025-12-24 05:07:34 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:07:34 - INFO -   LR: 0.000096
2025-12-24 05:07:34 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:09:08 - INFO - 
Epoch 7/50 - 94.08s
2025-12-24 05:09:08 - INFO -   Train Loss: 0.0948, Train Acc: 0.8913
2025-12-24 05:09:08 - INFO -   Val Loss: 0.2702
2025-12-24 05:09:08 - INFO -   Val Accuracy: 0.6902
2025-12-24 05:09:08 - INFO -   Val Balanced Acc: 0.7345
2025-12-24 05:09:08 - INFO -   Val F1 (weighted): 0.7092
2025-12-24 05:09:08 - INFO -   Val F1 (macro): 0.6056
2025-12-24 05:09:08 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:09:08 - INFO -   LR: 0.000095
2025-12-24 05:09:08 - INFO -   Saved best model (balanced_accuracy: 0.7345)
2025-12-24 05:10:43 - INFO - 
Epoch 8/50 - 94.40s
2025-12-24 05:10:43 - INFO -   Train Loss: 0.0786, Train Acc: 0.9086
2025-12-24 05:10:43 - INFO -   Val Loss: 0.2808
2025-12-24 05:10:43 - INFO -   Val Accuracy: 0.6906
2025-12-24 05:10:43 - INFO -   Val Balanced Acc: 0.7039
2025-12-24 05:10:43 - INFO -   Val F1 (weighted): 0.7050
2025-12-24 05:10:43 - INFO -   Val F1 (macro): 0.6427
2025-12-24 05:10:43 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:10:43 - INFO -   LR: 0.000094
2025-12-24 05:10:43 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:12:17 - INFO - 
Epoch 9/50 - 94.10s
2025-12-24 05:12:17 - INFO -   Train Loss: 0.0728, Train Acc: 0.9126
2025-12-24 05:12:17 - INFO -   Val Loss: 0.2614
2025-12-24 05:12:17 - INFO -   Val Accuracy: 0.6648
2025-12-24 05:12:17 - INFO -   Val Balanced Acc: 0.7096
2025-12-24 05:12:17 - INFO -   Val F1 (weighted): 0.6744
2025-12-24 05:12:17 - INFO -   Val F1 (macro): 0.6434
2025-12-24 05:12:17 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:12:17 - INFO -   LR: 0.000092
2025-12-24 05:12:17 - INFO -   No improvement (patience: 2/10)
2025-12-24 05:13:52 - INFO - 
Epoch 10/50 - 94.80s
2025-12-24 05:13:52 - INFO -   Train Loss: 0.0693, Train Acc: 0.9165
2025-12-24 05:13:52 - INFO -   Val Loss: 0.2308
2025-12-24 05:13:52 - INFO -   Val Accuracy: 0.7259
2025-12-24 05:13:52 - INFO -   Val Balanced Acc: 0.7688
2025-12-24 05:13:52 - INFO -   Val F1 (weighted): 0.7382
2025-12-24 05:13:52 - INFO -   Val F1 (macro): 0.7015
2025-12-24 05:13:52 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:13:52 - INFO -   LR: 0.000090
2025-12-24 05:13:52 - INFO -   Saved best model (balanced_accuracy: 0.7688)
2025-12-24 05:15:27 - INFO - 
Epoch 11/50 - 94.36s
2025-12-24 05:15:27 - INFO -   Train Loss: 0.0597, Train Acc: 0.9232
2025-12-24 05:15:27 - INFO -   Val Loss: 0.2785
2025-12-24 05:15:27 - INFO -   Val Accuracy: 0.6771
2025-12-24 05:15:27 - INFO -   Val Balanced Acc: 0.7385
2025-12-24 05:15:27 - INFO -   Val F1 (weighted): 0.6907
2025-12-24 05:15:27 - INFO -   Val F1 (macro): 0.6646
2025-12-24 05:15:27 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:15:27 - INFO -   LR: 0.000089
2025-12-24 05:15:27 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:17:01 - INFO - 
Epoch 12/50 - 94.58s
2025-12-24 05:17:01 - INFO -   Train Loss: 0.0574, Train Acc: 0.9292
2025-12-24 05:17:01 - INFO -   Val Loss: 0.2218
2025-12-24 05:17:01 - INFO -   Val Accuracy: 0.7214
2025-12-24 05:17:01 - INFO -   Val Balanced Acc: 0.7323
2025-12-24 05:17:01 - INFO -   Val F1 (weighted): 0.7308
2025-12-24 05:17:01 - INFO -   Val F1 (macro): 0.6595
2025-12-24 05:17:01 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:17:01 - INFO -   LR: 0.000086
2025-12-24 05:17:01 - INFO -   No improvement (patience: 2/10)
2025-12-24 05:18:38 - INFO - 
Epoch 13/50 - 97.11s
2025-12-24 05:18:38 - INFO -   Train Loss: 0.0529, Train Acc: 0.9327
2025-12-24 05:18:38 - INFO -   Val Loss: 0.2551
2025-12-24 05:18:38 - INFO -   Val Accuracy: 0.6890
2025-12-24 05:18:38 - INFO -   Val Balanced Acc: 0.7566
2025-12-24 05:18:38 - INFO -   Val F1 (weighted): 0.7001
2025-12-24 05:18:38 - INFO -   Val F1 (macro): 0.6686
2025-12-24 05:18:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:18:38 - INFO -   LR: 0.000084
2025-12-24 05:18:38 - INFO -   No improvement (patience: 3/10)
2025-12-24 05:20:13 - INFO - 
Epoch 14/50 - 94.53s
2025-12-24 05:20:13 - INFO -   Train Loss: 0.0463, Train Acc: 0.9384
2025-12-24 05:20:13 - INFO -   Val Loss: 0.2529
2025-12-24 05:20:13 - INFO -   Val Accuracy: 0.7222
2025-12-24 05:20:13 - INFO -   Val Balanced Acc: 0.7473
2025-12-24 05:20:13 - INFO -   Val F1 (weighted): 0.7327
2025-12-24 05:20:13 - INFO -   Val F1 (macro): 0.6861
2025-12-24 05:20:13 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:20:13 - INFO -   LR: 0.000082
2025-12-24 05:20:13 - INFO -   No improvement (patience: 4/10)
2025-12-24 05:21:47 - INFO - 
Epoch 15/50 - 94.19s
2025-12-24 05:21:47 - INFO -   Train Loss: 0.0461, Train Acc: 0.9398
2025-12-24 05:21:47 - INFO -   Val Loss: 0.2371
2025-12-24 05:21:47 - INFO -   Val Accuracy: 0.6939
2025-12-24 05:21:47 - INFO -   Val Balanced Acc: 0.7485
2025-12-24 05:21:47 - INFO -   Val F1 (weighted): 0.7039
2025-12-24 05:21:47 - INFO -   Val F1 (macro): 0.6885
2025-12-24 05:21:47 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:21:47 - INFO -   LR: 0.000079
2025-12-24 05:21:47 - INFO -   No improvement (patience: 5/10)
2025-12-24 05:23:21 - INFO - 
Epoch 16/50 - 94.31s
2025-12-24 05:23:21 - INFO -   Train Loss: 0.0404, Train Acc: 0.9442
2025-12-24 05:23:21 - INFO -   Val Loss: 0.2282
2025-12-24 05:23:21 - INFO -   Val Accuracy: 0.7173
2025-12-24 05:23:21 - INFO -   Val Balanced Acc: 0.7675
2025-12-24 05:23:21 - INFO -   Val F1 (weighted): 0.7291
2025-12-24 05:23:21 - INFO -   Val F1 (macro): 0.7061
2025-12-24 05:23:21 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:23:21 - INFO -   LR: 0.000077
2025-12-24 05:23:21 - INFO -   No improvement (patience: 6/10)
2025-12-24 05:24:55 - INFO - 
Epoch 17/50 - 93.94s
2025-12-24 05:24:55 - INFO -   Train Loss: 0.0376, Train Acc: 0.9469
2025-12-24 05:24:55 - INFO -   Val Loss: 0.2504
2025-12-24 05:24:55 - INFO -   Val Accuracy: 0.7275
2025-12-24 05:24:55 - INFO -   Val Balanced Acc: 0.7617
2025-12-24 05:24:55 - INFO -   Val F1 (weighted): 0.7352
2025-12-24 05:24:55 - INFO -   Val F1 (macro): 0.6915
2025-12-24 05:24:55 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:24:55 - INFO -   LR: 0.000074
2025-12-24 05:24:55 - INFO -   No improvement (patience: 7/10)
2025-12-24 05:26:30 - INFO - 
Epoch 18/50 - 94.49s
2025-12-24 05:26:30 - INFO -   Train Loss: 0.0372, Train Acc: 0.9487
2025-12-24 05:26:30 - INFO -   Val Loss: 0.2514
2025-12-24 05:26:30 - INFO -   Val Accuracy: 0.7025
2025-12-24 05:26:30 - INFO -   Val Balanced Acc: 0.7378
2025-12-24 05:26:30 - INFO -   Val F1 (weighted): 0.7132
2025-12-24 05:26:30 - INFO -   Val F1 (macro): 0.6933
2025-12-24 05:26:30 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:26:30 - INFO -   LR: 0.000071
2025-12-24 05:26:30 - INFO -   No improvement (patience: 8/10)
2025-12-24 05:28:04 - INFO - 
Epoch 19/50 - 94.33s
2025-12-24 05:28:04 - INFO -   Train Loss: 0.0326, Train Acc: 0.9546
2025-12-24 05:28:04 - INFO -   Val Loss: 0.2358
2025-12-24 05:28:04 - INFO -   Val Accuracy: 0.6943
2025-12-24 05:28:04 - INFO -   Val Balanced Acc: 0.7303
2025-12-24 05:28:04 - INFO -   Val F1 (weighted): 0.7048
2025-12-24 05:28:04 - INFO -   Val F1 (macro): 0.6725
2025-12-24 05:28:04 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:28:04 - INFO -   LR: 0.000068
2025-12-24 05:28:04 - INFO -   No improvement (patience: 9/10)
2025-12-24 05:29:38 - INFO - 
Epoch 20/50 - 94.42s
2025-12-24 05:29:38 - INFO -   Train Loss: 0.0308, Train Acc: 0.9546
2025-12-24 05:29:38 - INFO -   Val Loss: 0.2299
2025-12-24 05:29:38 - INFO -   Val Accuracy: 0.7489
2025-12-24 05:29:38 - INFO -   Val Balanced Acc: 0.7722
2025-12-24 05:29:38 - INFO -   Val F1 (weighted): 0.7575
2025-12-24 05:29:38 - INFO -   Val F1 (macro): 0.7039
2025-12-24 05:29:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:29:38 - INFO -   LR: 0.000065
2025-12-24 05:29:39 - INFO -   Saved best model (balanced_accuracy: 0.7722)
2025-12-24 05:31:14 - INFO - 
Epoch 21/50 - 94.77s
2025-12-24 05:31:14 - INFO -   Train Loss: 0.0305, Train Acc: 0.9555
2025-12-24 05:31:14 - INFO -   Val Loss: 0.2323
2025-12-24 05:31:14 - INFO -   Val Accuracy: 0.7193
2025-12-24 05:31:14 - INFO -   Val Balanced Acc: 0.7458
2025-12-24 05:31:14 - INFO -   Val F1 (weighted): 0.7300
2025-12-24 05:31:14 - INFO -   Val F1 (macro): 0.6955
2025-12-24 05:31:14 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:31:14 - INFO -   LR: 0.000062
2025-12-24 05:31:14 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:32:48 - INFO - 
Epoch 22/50 - 94.59s
2025-12-24 05:32:48 - INFO -   Train Loss: 0.0277, Train Acc: 0.9579
2025-12-24 05:32:48 - INFO -   Val Loss: 0.2309
2025-12-24 05:32:48 - INFO -   Val Accuracy: 0.7144
2025-12-24 05:32:48 - INFO -   Val Balanced Acc: 0.7757
2025-12-24 05:32:48 - INFO -   Val F1 (weighted): 0.7237
2025-12-24 05:32:48 - INFO -   Val F1 (macro): 0.7087
2025-12-24 05:32:48 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:32:48 - INFO -   LR: 0.000059
2025-12-24 05:32:49 - INFO -   Saved best model (balanced_accuracy: 0.7757)
2025-12-24 05:34:24 - INFO - 
Epoch 23/50 - 95.01s
2025-12-24 05:34:24 - INFO -   Train Loss: 0.0246, Train Acc: 0.9634
2025-12-24 05:34:24 - INFO -   Val Loss: 0.2515
2025-12-24 05:34:24 - INFO -   Val Accuracy: 0.7345
2025-12-24 05:34:24 - INFO -   Val Balanced Acc: 0.7625
2025-12-24 05:34:24 - INFO -   Val F1 (weighted): 0.7421
2025-12-24 05:34:24 - INFO -   Val F1 (macro): 0.7183
2025-12-24 05:34:24 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:34:24 - INFO -   LR: 0.000056
2025-12-24 05:34:24 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:36:00 - INFO - 
Epoch 24/50 - 95.69s
2025-12-24 05:36:00 - INFO -   Train Loss: 0.0245, Train Acc: 0.9628
2025-12-24 05:36:00 - INFO -   Val Loss: 0.2331
2025-12-24 05:36:00 - INFO -   Val Accuracy: 0.7460
2025-12-24 05:36:00 - INFO -   Val Balanced Acc: 0.7828
2025-12-24 05:36:00 - INFO -   Val F1 (weighted): 0.7539
2025-12-24 05:36:00 - INFO -   Val F1 (macro): 0.7136
2025-12-24 05:36:00 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:36:00 - INFO -   LR: 0.000053
2025-12-24 05:36:00 - INFO -   Saved best model (balanced_accuracy: 0.7828)
2025-12-24 05:37:34 - INFO - 
Epoch 25/50 - 93.68s
2025-12-24 05:37:34 - INFO -   Train Loss: 0.0215, Train Acc: 0.9682
2025-12-24 05:37:34 - INFO -   Val Loss: 0.2354
2025-12-24 05:37:34 - INFO -   Val Accuracy: 0.7485
2025-12-24 05:37:34 - INFO -   Val Balanced Acc: 0.7623
2025-12-24 05:37:34 - INFO -   Val F1 (weighted): 0.7533
2025-12-24 05:37:34 - INFO -   Val F1 (macro): 0.7360
2025-12-24 05:37:34 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:37:34 - INFO -   LR: 0.000050
2025-12-24 05:37:34 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:39:09 - INFO - 
Epoch 26/50 - 94.70s
2025-12-24 05:39:09 - INFO -   Train Loss: 0.0191, Train Acc: 0.9690
2025-12-24 05:39:09 - INFO -   Val Loss: 0.2281
2025-12-24 05:39:09 - INFO -   Val Accuracy: 0.7382
2025-12-24 05:39:09 - INFO -   Val Balanced Acc: 0.7721
2025-12-24 05:39:09 - INFO -   Val F1 (weighted): 0.7469
2025-12-24 05:39:09 - INFO -   Val F1 (macro): 0.7444
2025-12-24 05:39:09 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:39:09 - INFO -   LR: 0.000047
2025-12-24 05:39:09 - INFO -   No improvement (patience: 2/10)
2025-12-24 05:40:43 - INFO - 
Epoch 27/50 - 94.48s
2025-12-24 05:40:43 - INFO -   Train Loss: 0.0165, Train Acc: 0.9722
2025-12-24 05:40:43 - INFO -   Val Loss: 0.2319
2025-12-24 05:40:43 - INFO -   Val Accuracy: 0.7374
2025-12-24 05:40:43 - INFO -   Val Balanced Acc: 0.7667
2025-12-24 05:40:43 - INFO -   Val F1 (weighted): 0.7458
2025-12-24 05:40:43 - INFO -   Val F1 (macro): 0.7366
2025-12-24 05:40:43 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:40:43 - INFO -   LR: 0.000044
2025-12-24 05:40:43 - INFO -   No improvement (patience: 3/10)
2025-12-24 05:42:18 - INFO - 
Epoch 28/50 - 95.16s
2025-12-24 05:42:18 - INFO -   Train Loss: 0.0173, Train Acc: 0.9719
2025-12-24 05:42:18 - INFO -   Val Loss: 0.2403
2025-12-24 05:42:18 - INFO -   Val Accuracy: 0.7177
2025-12-24 05:42:18 - INFO -   Val Balanced Acc: 0.7728
2025-12-24 05:42:18 - INFO -   Val F1 (weighted): 0.7251
2025-12-24 05:42:18 - INFO -   Val F1 (macro): 0.7247
2025-12-24 05:42:18 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:42:18 - INFO -   LR: 0.000041
2025-12-24 05:42:18 - INFO -   No improvement (patience: 4/10)
2025-12-24 05:43:53 - INFO - 
Epoch 29/50 - 94.65s
2025-12-24 05:43:53 - INFO -   Train Loss: 0.0157, Train Acc: 0.9748
2025-12-24 05:43:53 - INFO -   Val Loss: 0.2418
2025-12-24 05:43:53 - INFO -   Val Accuracy: 0.7472
2025-12-24 05:43:53 - INFO -   Val Balanced Acc: 0.7762
2025-12-24 05:43:53 - INFO -   Val F1 (weighted): 0.7545
2025-12-24 05:43:53 - INFO -   Val F1 (macro): 0.7432
2025-12-24 05:43:53 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:43:53 - INFO -   LR: 0.000038
2025-12-24 05:43:53 - INFO -   No improvement (patience: 5/10)
2025-12-24 05:45:27 - INFO - 
Epoch 30/50 - 94.20s
2025-12-24 05:45:27 - INFO -   Train Loss: 0.0132, Train Acc: 0.9764
2025-12-24 05:45:27 - INFO -   Val Loss: 0.2390
2025-12-24 05:45:27 - INFO -   Val Accuracy: 0.7550
2025-12-24 05:45:27 - INFO -   Val Balanced Acc: 0.7722
2025-12-24 05:45:27 - INFO -   Val F1 (weighted): 0.7613
2025-12-24 05:45:27 - INFO -   Val F1 (macro): 0.7598
2025-12-24 05:45:27 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:45:27 - INFO -   LR: 0.000035
2025-12-24 05:45:27 - INFO -   No improvement (patience: 6/10)
2025-12-24 05:47:02 - INFO - 
Epoch 31/50 - 94.43s
2025-12-24 05:47:02 - INFO -   Train Loss: 0.0133, Train Acc: 0.9782
2025-12-24 05:47:02 - INFO -   Val Loss: 0.2362
2025-12-24 05:47:02 - INFO -   Val Accuracy: 0.7624
2025-12-24 05:47:02 - INFO -   Val Balanced Acc: 0.7799
2025-12-24 05:47:02 - INFO -   Val F1 (weighted): 0.7676
2025-12-24 05:47:02 - INFO -   Val F1 (macro): 0.7550
2025-12-24 05:47:02 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:47:02 - INFO -   LR: 0.000032
2025-12-24 05:47:02 - INFO -   No improvement (patience: 7/10)
2025-12-24 05:48:36 - INFO - 
Epoch 32/50 - 94.51s
2025-12-24 05:48:36 - INFO -   Train Loss: 0.0112, Train Acc: 0.9800
2025-12-24 05:48:36 - INFO -   Val Loss: 0.2397
2025-12-24 05:48:36 - INFO -   Val Accuracy: 0.7645
2025-12-24 05:48:36 - INFO -   Val Balanced Acc: 0.7877
2025-12-24 05:48:36 - INFO -   Val F1 (weighted): 0.7709
2025-12-24 05:48:36 - INFO -   Val F1 (macro): 0.7557
2025-12-24 05:48:36 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:48:36 - INFO -   LR: 0.000029
2025-12-24 05:48:37 - INFO -   Saved best model (balanced_accuracy: 0.7877)
2025-12-24 05:50:11 - INFO - 
Epoch 33/50 - 94.83s
2025-12-24 05:50:11 - INFO -   Train Loss: 0.0103, Train Acc: 0.9814
2025-12-24 05:50:11 - INFO -   Val Loss: 0.2590
2025-12-24 05:50:11 - INFO -   Val Accuracy: 0.7517
2025-12-24 05:50:11 - INFO -   Val Balanced Acc: 0.7571
2025-12-24 05:50:11 - INFO -   Val F1 (weighted): 0.7574
2025-12-24 05:50:11 - INFO -   Val F1 (macro): 0.7398
2025-12-24 05:50:11 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:50:11 - INFO -   LR: 0.000026
2025-12-24 05:50:11 - INFO -   No improvement (patience: 1/10)
2025-12-24 05:51:46 - INFO - 
Epoch 34/50 - 94.60s
2025-12-24 05:51:46 - INFO -   Train Loss: 0.0104, Train Acc: 0.9824
2025-12-24 05:51:46 - INFO -   Val Loss: 0.2301
2025-12-24 05:51:46 - INFO -   Val Accuracy: 0.7501
2025-12-24 05:51:46 - INFO -   Val Balanced Acc: 0.7788
2025-12-24 05:51:46 - INFO -   Val F1 (weighted): 0.7569
2025-12-24 05:51:46 - INFO -   Val F1 (macro): 0.7521
2025-12-24 05:51:46 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:51:46 - INFO -   LR: 0.000023
2025-12-24 05:51:46 - INFO -   No improvement (patience: 2/10)
2025-12-24 05:53:20 - INFO - 
Epoch 35/50 - 94.37s
2025-12-24 05:53:20 - INFO -   Train Loss: 0.0084, Train Acc: 0.9831
2025-12-24 05:53:20 - INFO -   Val Loss: 0.2436
2025-12-24 05:53:20 - INFO -   Val Accuracy: 0.7530
2025-12-24 05:53:20 - INFO -   Val Balanced Acc: 0.7582
2025-12-24 05:53:20 - INFO -   Val F1 (weighted): 0.7594
2025-12-24 05:53:20 - INFO -   Val F1 (macro): 0.7524
2025-12-24 05:53:20 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:53:20 - INFO -   LR: 0.000021
2025-12-24 05:53:20 - INFO -   No improvement (patience: 3/10)
2025-12-24 05:54:55 - INFO - 
Epoch 36/50 - 94.45s
2025-12-24 05:54:55 - INFO -   Train Loss: 0.0077, Train Acc: 0.9832
2025-12-24 05:54:55 - INFO -   Val Loss: 0.2402
2025-12-24 05:54:55 - INFO -   Val Accuracy: 0.7829
2025-12-24 05:54:55 - INFO -   Val Balanced Acc: 0.7769
2025-12-24 05:54:55 - INFO -   Val F1 (weighted): 0.7872
2025-12-24 05:54:55 - INFO -   Val F1 (macro): 0.7693
2025-12-24 05:54:55 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:54:55 - INFO -   LR: 0.000018
2025-12-24 05:54:55 - INFO -   No improvement (patience: 4/10)
2025-12-24 05:56:29 - INFO - 
Epoch 37/50 - 94.41s
2025-12-24 05:56:29 - INFO -   Train Loss: 0.0081, Train Acc: 0.9835
2025-12-24 05:56:29 - INFO -   Val Loss: 0.2557
2025-12-24 05:56:29 - INFO -   Val Accuracy: 0.7653
2025-12-24 05:56:29 - INFO -   Val Balanced Acc: 0.7777
2025-12-24 05:56:29 - INFO -   Val F1 (weighted): 0.7708
2025-12-24 05:56:29 - INFO -   Val F1 (macro): 0.7624
2025-12-24 05:56:29 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:56:29 - INFO -   LR: 0.000016
2025-12-24 05:56:29 - INFO -   No improvement (patience: 5/10)
2025-12-24 05:58:04 - INFO - 
Epoch 38/50 - 94.32s
2025-12-24 05:58:04 - INFO -   Train Loss: 0.0076, Train Acc: 0.9829
2025-12-24 05:58:04 - INFO -   Val Loss: 0.2431
2025-12-24 05:58:04 - INFO -   Val Accuracy: 0.7710
2025-12-24 05:58:04 - INFO -   Val Balanced Acc: 0.7780
2025-12-24 05:58:04 - INFO -   Val F1 (weighted): 0.7759
2025-12-24 05:58:04 - INFO -   Val F1 (macro): 0.7610
2025-12-24 05:58:04 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:58:04 - INFO -   LR: 0.000014
2025-12-24 05:58:04 - INFO -   No improvement (patience: 6/10)
2025-12-24 05:59:38 - INFO - 
Epoch 39/50 - 94.13s
2025-12-24 05:59:38 - INFO -   Train Loss: 0.0072, Train Acc: 0.9853
2025-12-24 05:59:38 - INFO -   Val Loss: 0.2271
2025-12-24 05:59:38 - INFO -   Val Accuracy: 0.7920
2025-12-24 05:59:38 - INFO -   Val Balanced Acc: 0.7855
2025-12-24 05:59:38 - INFO -   Val F1 (weighted): 0.7965
2025-12-24 05:59:38 - INFO -   Val F1 (macro): 0.7754
2025-12-24 05:59:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 05:59:38 - INFO -   LR: 0.000011
2025-12-24 05:59:38 - INFO -   No improvement (patience: 7/10)
2025-12-24 06:01:12 - INFO - 
Epoch 40/50 - 94.15s
2025-12-24 06:01:12 - INFO -   Train Loss: 0.0070, Train Acc: 0.9860
2025-12-24 06:01:12 - INFO -   Val Loss: 0.2427
2025-12-24 06:01:12 - INFO -   Val Accuracy: 0.7768
2025-12-24 06:01:12 - INFO -   Val Balanced Acc: 0.7815
2025-12-24 06:01:12 - INFO -   Val F1 (weighted): 0.7831
2025-12-24 06:01:12 - INFO -   Val F1 (macro): 0.7674
2025-12-24 06:01:12 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:01:12 - INFO -   LR: 0.000010
2025-12-24 06:01:12 - INFO -   No improvement (patience: 8/10)
2025-12-24 06:02:47 - INFO - 
Epoch 41/50 - 94.69s
2025-12-24 06:02:47 - INFO -   Train Loss: 0.0059, Train Acc: 0.9877
2025-12-24 06:02:47 - INFO -   Val Loss: 0.2531
2025-12-24 06:02:47 - INFO -   Val Accuracy: 0.7866
2025-12-24 06:02:47 - INFO -   Val Balanced Acc: 0.7779
2025-12-24 06:02:47 - INFO -   Val F1 (weighted): 0.7910
2025-12-24 06:02:47 - INFO -   Val F1 (macro): 0.7725
2025-12-24 06:02:47 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:02:47 - INFO -   LR: 0.000008
2025-12-24 06:02:47 - INFO -   No improvement (patience: 9/10)
2025-12-24 06:04:22 - INFO - 
Epoch 42/50 - 95.09s
2025-12-24 06:04:22 - INFO -   Train Loss: 0.0051, Train Acc: 0.9877
2025-12-24 06:04:22 - INFO -   Val Loss: 0.2554
2025-12-24 06:04:22 - INFO -   Val Accuracy: 0.7842
2025-12-24 06:04:22 - INFO -   Val Balanced Acc: 0.7775
2025-12-24 06:04:22 - INFO -   Val F1 (weighted): 0.7882
2025-12-24 06:04:22 - INFO -   Val F1 (macro): 0.7702
2025-12-24 06:04:22 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:04:22 - INFO -   LR: 0.000006
2025-12-24 06:04:22 - INFO -   No improvement (patience: 10/10)
2025-12-24 06:04:22 - INFO - 
Early stopping at epoch 42
2025-12-24 06:04:22 - INFO - 
================================================================================
2025-12-24 06:04:22 - INFO - TRAINING COMPLETE
2025-12-24 06:04:22 - INFO - ================================================================================
2025-12-24 06:04:22 - INFO - Total time: 66.45 minutes
2025-12-24 06:04:22 - INFO - Best balanced_accuracy: 0.7877 (epoch 32)
2025-12-24 06:04:22 - INFO - Average time per epoch: 94.93 seconds
2025-12-24 06:04:22 - INFO - Model saved to: models/densenet_fold5_20251224_045753
2025-12-24 06:04:22 - INFO - 
Results saved to: models/densenet_fold5_20251224_045753/final_results.json
