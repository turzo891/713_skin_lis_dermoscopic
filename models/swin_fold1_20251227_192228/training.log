2025-12-27 19:22:28 - INFO - Logging initialized. Log file: models/swin_fold1_20251227_192228/training.log
2025-12-27 19:22:29 - INFO - ================================================================================
2025-12-27 19:22:29 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-27 19:22:29 - INFO - ================================================================================
2025-12-27 19:22:29 - INFO - Model: swin
2025-12-27 19:22:29 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-27 19:22:29 - INFO - Fold: 1
2025-12-27 19:22:29 - INFO - Batch size: 16
2025-12-27 19:22:29 - INFO - Effective batch size: 16
2025-12-27 19:22:29 - INFO - Epochs: 50
2025-12-27 19:22:29 - INFO - Learning rate: 0.0001
2025-12-27 19:22:29 - INFO - Workers: 8
2025-12-27 19:22:29 - INFO - Mixed precision: True
2025-12-27 19:22:29 - INFO - Gradient accumulation: 1
2025-12-27 19:22:29 - INFO - Prefetch factor: 2
2025-12-27 19:22:29 - INFO - Focal loss: True
2025-12-27 19:22:29 - INFO - Skin tone sampling: True
2025-12-27 19:22:29 - INFO - Device: cuda
2025-12-27 19:22:29 - INFO - Output: models/swin_fold1_20251227_192228
2025-12-27 19:22:29 - INFO - ================================================================================
2025-12-27 19:22:29 - INFO - 
Creating data loaders...
2025-12-27 19:22:29 - INFO - Train samples: 21936
2025-12-27 19:22:29 - INFO - Val samples: 2438
2025-12-27 19:22:29 - INFO - 
Creating swin model...
2025-12-27 19:22:41 - INFO - 
Starting training...

2025-12-27 19:27:54 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:27:54 - INFO - 
Epoch 1/50 - 313.79s
2025-12-27 19:27:54 - INFO -   Train Loss: 0.3840, Train Acc: 0.6846
2025-12-27 19:27:54 - INFO -   Val Loss: 0.5282
2025-12-27 19:27:54 - INFO -   Val Accuracy: 0.4081
2025-12-27 19:27:54 - INFO -   Val Balanced Acc: 0.5751
2025-12-27 19:27:54 - INFO -   Val F1 (weighted): 0.3979
2025-12-27 19:27:54 - INFO -   Val F1 (macro): 0.4209
2025-12-27 19:27:54 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:27:54 - INFO -   LR: 0.000100
2025-12-27 19:27:56 - INFO -   Saved best model (balanced_accuracy: 0.5751)
2025-12-27 19:33:07 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:33:07 - INFO - 
Epoch 2/50 - 311.45s
2025-12-27 19:33:07 - INFO -   Train Loss: 0.2042, Train Acc: 0.8037
2025-12-27 19:33:07 - INFO -   Val Loss: 0.3339
2025-12-27 19:33:07 - INFO -   Val Accuracy: 0.5939
2025-12-27 19:33:07 - INFO -   Val Balanced Acc: 0.6042
2025-12-27 19:33:07 - INFO -   Val F1 (weighted): 0.6099
2025-12-27 19:33:07 - INFO -   Val F1 (macro): 0.5512
2025-12-27 19:33:07 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:33:07 - INFO -   LR: 0.000100
2025-12-27 19:33:09 - INFO -   Saved best model (balanced_accuracy: 0.6042)
2025-12-27 19:38:21 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:38:21 - INFO - 
Epoch 3/50 - 311.56s
2025-12-27 19:38:21 - INFO -   Train Loss: 0.1614, Train Acc: 0.8330
2025-12-27 19:38:21 - INFO -   Val Loss: 0.3598
2025-12-27 19:38:21 - INFO -   Val Accuracy: 0.5853
2025-12-27 19:38:21 - INFO -   Val Balanced Acc: 0.6555
2025-12-27 19:38:21 - INFO -   Val F1 (weighted): 0.5955
2025-12-27 19:38:21 - INFO -   Val F1 (macro): 0.5494
2025-12-27 19:38:21 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:38:21 - INFO -   LR: 0.000099
2025-12-27 19:38:22 - INFO -   Saved best model (balanced_accuracy: 0.6555)
2025-12-27 19:43:34 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:43:34 - INFO - 
Epoch 4/50 - 311.55s
2025-12-27 19:43:34 - INFO -   Train Loss: 0.1344, Train Acc: 0.8558
2025-12-27 19:43:34 - INFO -   Val Loss: 0.3625
2025-12-27 19:43:34 - INFO -   Val Accuracy: 0.5566
2025-12-27 19:43:34 - INFO -   Val Balanced Acc: 0.6858
2025-12-27 19:43:34 - INFO -   Val F1 (weighted): 0.5725
2025-12-27 19:43:34 - INFO -   Val F1 (macro): 0.5562
2025-12-27 19:43:34 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:43:34 - INFO -   LR: 0.000098
2025-12-27 19:43:36 - INFO -   Saved best model (balanced_accuracy: 0.6858)
2025-12-27 19:48:47 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:48:47 - INFO - 
Epoch 5/50 - 311.34s
2025-12-27 19:48:47 - INFO -   Train Loss: 0.1128, Train Acc: 0.8753
2025-12-27 19:48:47 - INFO -   Val Loss: 0.2387
2025-12-27 19:48:47 - INFO -   Val Accuracy: 0.7133
2025-12-27 19:48:47 - INFO -   Val Balanced Acc: 0.7064
2025-12-27 19:48:47 - INFO -   Val F1 (weighted): 0.7214
2025-12-27 19:48:47 - INFO -   Val F1 (macro): 0.6624
2025-12-27 19:48:47 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:48:47 - INFO -   LR: 0.000098
2025-12-27 19:48:49 - INFO -   Saved best model (balanced_accuracy: 0.7064)
2025-12-27 19:54:00 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:54:00 - INFO - 
Epoch 6/50 - 311.42s
2025-12-27 19:54:00 - INFO -   Train Loss: 0.0986, Train Acc: 0.8870
2025-12-27 19:54:00 - INFO -   Val Loss: 0.3217
2025-12-27 19:54:00 - INFO -   Val Accuracy: 0.5730
2025-12-27 19:54:00 - INFO -   Val Balanced Acc: 0.6719
2025-12-27 19:54:00 - INFO -   Val F1 (weighted): 0.5754
2025-12-27 19:54:00 - INFO -   Val F1 (macro): 0.5690
2025-12-27 19:54:00 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:54:00 - INFO -   LR: 0.000096
2025-12-27 19:54:00 - INFO -   No improvement (patience: 1/10)
2025-12-27 19:59:12 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 19:59:12 - INFO - 
Epoch 7/50 - 311.10s
2025-12-27 19:59:12 - INFO -   Train Loss: 0.0936, Train Acc: 0.8925
2025-12-27 19:59:12 - INFO -   Val Loss: 0.2434
2025-12-27 19:59:12 - INFO -   Val Accuracy: 0.6883
2025-12-27 19:59:12 - INFO -   Val Balanced Acc: 0.7411
2025-12-27 19:59:12 - INFO -   Val F1 (weighted): 0.7018
2025-12-27 19:59:12 - INFO -   Val F1 (macro): 0.6494
2025-12-27 19:59:12 - INFO -   Val AUC (macro): 0.0000
2025-12-27 19:59:12 - INFO -   LR: 0.000095
2025-12-27 19:59:14 - INFO -   Saved best model (balanced_accuracy: 0.7411)
2025-12-27 20:04:25 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:04:25 - INFO - 
Epoch 8/50 - 311.37s
2025-12-27 20:04:25 - INFO -   Train Loss: 0.0799, Train Acc: 0.9089
2025-12-27 20:04:25 - INFO -   Val Loss: 0.2308
2025-12-27 20:04:25 - INFO -   Val Accuracy: 0.7383
2025-12-27 20:04:25 - INFO -   Val Balanced Acc: 0.7259
2025-12-27 20:04:25 - INFO -   Val F1 (weighted): 0.7474
2025-12-27 20:04:25 - INFO -   Val F1 (macro): 0.6701
2025-12-27 20:04:25 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:04:25 - INFO -   LR: 0.000094
2025-12-27 20:04:25 - INFO -   No improvement (patience: 1/10)
2025-12-27 20:09:36 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:09:36 - INFO - 
Epoch 9/50 - 311.00s
2025-12-27 20:09:36 - INFO -   Train Loss: 0.0735, Train Acc: 0.9134
2025-12-27 20:09:36 - INFO -   Val Loss: 0.2913
2025-12-27 20:09:36 - INFO -   Val Accuracy: 0.6817
2025-12-27 20:09:36 - INFO -   Val Balanced Acc: 0.7004
2025-12-27 20:09:36 - INFO -   Val F1 (weighted): 0.6887
2025-12-27 20:09:36 - INFO -   Val F1 (macro): 0.6097
2025-12-27 20:09:36 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:09:36 - INFO -   LR: 0.000092
2025-12-27 20:09:36 - INFO -   No improvement (patience: 2/10)
2025-12-27 20:14:47 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:14:47 - INFO - 
Epoch 10/50 - 311.25s
2025-12-27 20:14:47 - INFO -   Train Loss: 0.0681, Train Acc: 0.9196
2025-12-27 20:14:47 - INFO -   Val Loss: 0.2861
2025-12-27 20:14:47 - INFO -   Val Accuracy: 0.6296
2025-12-27 20:14:47 - INFO -   Val Balanced Acc: 0.6931
2025-12-27 20:14:47 - INFO -   Val F1 (weighted): 0.6407
2025-12-27 20:14:47 - INFO -   Val F1 (macro): 0.6161
2025-12-27 20:14:47 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:14:47 - INFO -   LR: 0.000090
2025-12-27 20:14:47 - INFO -   No improvement (patience: 3/10)
2025-12-27 20:19:58 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:19:58 - INFO - 
Epoch 11/50 - 310.93s
2025-12-27 20:19:58 - INFO -   Train Loss: 0.0564, Train Acc: 0.9303
2025-12-27 20:19:58 - INFO -   Val Loss: 0.2609
2025-12-27 20:19:58 - INFO -   Val Accuracy: 0.7215
2025-12-27 20:19:58 - INFO -   Val Balanced Acc: 0.7148
2025-12-27 20:19:58 - INFO -   Val F1 (weighted): 0.7352
2025-12-27 20:19:58 - INFO -   Val F1 (macro): 0.6524
2025-12-27 20:19:58 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:19:58 - INFO -   LR: 0.000089
2025-12-27 20:19:58 - INFO -   No improvement (patience: 4/10)
2025-12-27 20:25:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:25:09 - INFO - 
Epoch 12/50 - 311.01s
2025-12-27 20:25:09 - INFO -   Train Loss: 0.0563, Train Acc: 0.9332
2025-12-27 20:25:09 - INFO -   Val Loss: 0.2885
2025-12-27 20:25:09 - INFO -   Val Accuracy: 0.6657
2025-12-27 20:25:09 - INFO -   Val Balanced Acc: 0.7104
2025-12-27 20:25:09 - INFO -   Val F1 (weighted): 0.6821
2025-12-27 20:25:09 - INFO -   Val F1 (macro): 0.6468
2025-12-27 20:25:09 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:25:09 - INFO -   LR: 0.000086
2025-12-27 20:25:09 - INFO -   No improvement (patience: 5/10)
2025-12-27 20:30:20 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:30:20 - INFO - 
Epoch 13/50 - 310.92s
2025-12-27 20:30:20 - INFO -   Train Loss: 0.0502, Train Acc: 0.9340
2025-12-27 20:30:20 - INFO -   Val Loss: 0.2855
2025-12-27 20:30:20 - INFO -   Val Accuracy: 0.7297
2025-12-27 20:30:20 - INFO -   Val Balanced Acc: 0.7253
2025-12-27 20:30:20 - INFO -   Val F1 (weighted): 0.7368
2025-12-27 20:30:20 - INFO -   Val F1 (macro): 0.6347
2025-12-27 20:30:20 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:30:20 - INFO -   LR: 0.000084
2025-12-27 20:30:20 - INFO -   No improvement (patience: 6/10)
2025-12-27 20:35:31 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:35:31 - INFO - 
Epoch 14/50 - 311.13s
2025-12-27 20:35:31 - INFO -   Train Loss: 0.0515, Train Acc: 0.9368
2025-12-27 20:35:31 - INFO -   Val Loss: 0.2600
2025-12-27 20:35:31 - INFO -   Val Accuracy: 0.7018
2025-12-27 20:35:31 - INFO -   Val Balanced Acc: 0.7375
2025-12-27 20:35:31 - INFO -   Val F1 (weighted): 0.7206
2025-12-27 20:35:31 - INFO -   Val F1 (macro): 0.6470
2025-12-27 20:35:31 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:35:31 - INFO -   LR: 0.000082
2025-12-27 20:35:31 - INFO -   No improvement (patience: 7/10)
2025-12-27 20:40:42 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:40:42 - INFO - 
Epoch 15/50 - 311.05s
2025-12-27 20:40:42 - INFO -   Train Loss: 0.0454, Train Acc: 0.9447
2025-12-27 20:40:42 - INFO -   Val Loss: 0.2725
2025-12-27 20:40:42 - INFO -   Val Accuracy: 0.6747
2025-12-27 20:40:42 - INFO -   Val Balanced Acc: 0.7299
2025-12-27 20:40:42 - INFO -   Val F1 (weighted): 0.6897
2025-12-27 20:40:42 - INFO -   Val F1 (macro): 0.6392
2025-12-27 20:40:42 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:40:42 - INFO -   LR: 0.000079
2025-12-27 20:40:42 - INFO -   No improvement (patience: 8/10)
2025-12-27 20:45:53 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:45:53 - INFO - 
Epoch 16/50 - 311.05s
2025-12-27 20:45:53 - INFO -   Train Loss: 0.0422, Train Acc: 0.9460
2025-12-27 20:45:53 - INFO -   Val Loss: 0.2578
2025-12-27 20:45:53 - INFO -   Val Accuracy: 0.6854
2025-12-27 20:45:53 - INFO -   Val Balanced Acc: 0.7051
2025-12-27 20:45:53 - INFO -   Val F1 (weighted): 0.6990
2025-12-27 20:45:53 - INFO -   Val F1 (macro): 0.6672
2025-12-27 20:45:53 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:45:53 - INFO -   LR: 0.000077
2025-12-27 20:45:53 - INFO -   No improvement (patience: 9/10)
2025-12-27 20:51:04 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-27 20:51:04 - INFO - 
Epoch 17/50 - 311.12s
2025-12-27 20:51:04 - INFO -   Train Loss: 0.0390, Train Acc: 0.9474
2025-12-27 20:51:04 - INFO -   Val Loss: 0.2420
2025-12-27 20:51:04 - INFO -   Val Accuracy: 0.6788
2025-12-27 20:51:04 - INFO -   Val Balanced Acc: 0.7000
2025-12-27 20:51:04 - INFO -   Val F1 (weighted): 0.6892
2025-12-27 20:51:04 - INFO -   Val F1 (macro): 0.6534
2025-12-27 20:51:04 - INFO -   Val AUC (macro): 0.0000
2025-12-27 20:51:04 - INFO -   LR: 0.000074
2025-12-27 20:51:04 - INFO -   No improvement (patience: 10/10)
2025-12-27 20:51:04 - INFO - 
Early stopping at epoch 17
2025-12-27 20:51:04 - INFO - 
================================================================================
2025-12-27 20:51:04 - INFO - TRAINING COMPLETE
2025-12-27 20:51:04 - INFO - ================================================================================
2025-12-27 20:51:04 - INFO - Total time: 88.40 minutes
2025-12-27 20:51:04 - INFO - Best balanced_accuracy: 0.7411 (epoch 7)
2025-12-27 20:51:04 - INFO - Average time per epoch: 311.99 seconds
2025-12-27 20:51:04 - INFO - Model saved to: models/swin_fold1_20251227_192228
2025-12-27 20:51:04 - INFO - 
Results saved to: models/swin_fold1_20251227_192228/final_results.json
