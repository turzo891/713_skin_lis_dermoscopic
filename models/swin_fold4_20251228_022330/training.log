2025-12-28 02:23:30 - INFO - Logging initialized. Log file: models/swin_fold4_20251228_022330/training.log
2025-12-28 02:23:31 - INFO - ================================================================================
2025-12-28 02:23:31 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-28 02:23:31 - INFO - ================================================================================
2025-12-28 02:23:31 - INFO - Model: swin
2025-12-28 02:23:31 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-28 02:23:31 - INFO - Fold: 4
2025-12-28 02:23:31 - INFO - Batch size: 16
2025-12-28 02:23:31 - INFO - Effective batch size: 16
2025-12-28 02:23:31 - INFO - Epochs: 50
2025-12-28 02:23:31 - INFO - Learning rate: 0.0001
2025-12-28 02:23:31 - INFO - Workers: 8
2025-12-28 02:23:31 - INFO - Mixed precision: True
2025-12-28 02:23:31 - INFO - Gradient accumulation: 1
2025-12-28 02:23:31 - INFO - Prefetch factor: 2
2025-12-28 02:23:31 - INFO - Focal loss: True
2025-12-28 02:23:31 - INFO - Skin tone sampling: True
2025-12-28 02:23:31 - INFO - Device: cuda
2025-12-28 02:23:31 - INFO - Output: models/swin_fold4_20251228_022330
2025-12-28 02:23:31 - INFO - ================================================================================
2025-12-28 02:23:31 - INFO - 
Creating data loaders...
2025-12-28 02:23:32 - INFO - Train samples: 21937
2025-12-28 02:23:32 - INFO - Val samples: 2437
2025-12-28 02:23:32 - INFO - 
Creating swin model...
2025-12-28 02:23:34 - INFO - 
Starting training...

2025-12-28 02:30:39 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:30:39 - INFO - 
Epoch 1/50 - 425.67s
2025-12-28 02:30:39 - INFO -   Train Loss: 0.3772, Train Acc: 0.6842
2025-12-28 02:30:39 - INFO -   Val Loss: 0.3544
2025-12-28 02:30:39 - INFO -   Val Accuracy: 0.5778
2025-12-28 02:30:39 - INFO -   Val Balanced Acc: 0.6773
2025-12-28 02:30:39 - INFO -   Val F1 (weighted): 0.6005
2025-12-28 02:30:39 - INFO -   Val F1 (macro): 0.5296
2025-12-28 02:30:39 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:30:39 - INFO -   LR: 0.000100
2025-12-28 02:30:41 - INFO -   Saved best model (balanced_accuracy: 0.6773)
2025-12-28 02:42:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:42:08 - INFO - 
Epoch 2/50 - 686.93s
2025-12-28 02:42:08 - INFO -   Train Loss: 0.2042, Train Acc: 0.8028
2025-12-28 02:42:08 - INFO -   Val Loss: 0.3704
2025-12-28 02:42:08 - INFO -   Val Accuracy: 0.6085
2025-12-28 02:42:08 - INFO -   Val Balanced Acc: 0.6687
2025-12-28 02:42:08 - INFO -   Val F1 (weighted): 0.6345
2025-12-28 02:42:08 - INFO -   Val F1 (macro): 0.5617
2025-12-28 02:42:08 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:42:08 - INFO -   LR: 0.000100
2025-12-28 02:42:08 - INFO -   No improvement (patience: 1/10)
2025-12-28 02:47:20 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:47:20 - INFO - 
Epoch 3/50 - 311.79s
2025-12-28 02:47:20 - INFO -   Train Loss: 0.1587, Train Acc: 0.8322
2025-12-28 02:47:20 - INFO -   Val Loss: 0.2906
2025-12-28 02:47:20 - INFO -   Val Accuracy: 0.6451
2025-12-28 02:47:20 - INFO -   Val Balanced Acc: 0.6801
2025-12-28 02:47:20 - INFO -   Val F1 (weighted): 0.6589
2025-12-28 02:47:20 - INFO -   Val F1 (macro): 0.5770
2025-12-28 02:47:20 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:47:20 - INFO -   LR: 0.000099
2025-12-28 02:47:22 - INFO -   Saved best model (balanced_accuracy: 0.6801)
2025-12-28 02:52:33 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:52:33 - INFO - 
Epoch 4/50 - 311.05s
2025-12-28 02:52:33 - INFO -   Train Loss: 0.1345, Train Acc: 0.8556
2025-12-28 02:52:33 - INFO -   Val Loss: 0.2704
2025-12-28 02:52:33 - INFO -   Val Accuracy: 0.7152
2025-12-28 02:52:33 - INFO -   Val Balanced Acc: 0.7233
2025-12-28 02:52:33 - INFO -   Val F1 (weighted): 0.7287
2025-12-28 02:52:33 - INFO -   Val F1 (macro): 0.6419
2025-12-28 02:52:33 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:52:33 - INFO -   LR: 0.000098
2025-12-28 02:52:35 - INFO -   Saved best model (balanced_accuracy: 0.7233)
2025-12-28 02:57:46 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 02:57:46 - INFO - 
Epoch 5/50 - 311.14s
2025-12-28 02:57:46 - INFO -   Train Loss: 0.1128, Train Acc: 0.8728
2025-12-28 02:57:46 - INFO -   Val Loss: 0.2799
2025-12-28 02:57:46 - INFO -   Val Accuracy: 0.6890
2025-12-28 02:57:46 - INFO -   Val Balanced Acc: 0.7374
2025-12-28 02:57:46 - INFO -   Val F1 (weighted): 0.7001
2025-12-28 02:57:46 - INFO -   Val F1 (macro): 0.6168
2025-12-28 02:57:46 - INFO -   Val AUC (macro): 0.0000
2025-12-28 02:57:46 - INFO -   LR: 0.000098
2025-12-28 02:57:49 - INFO -   Saved best model (balanced_accuracy: 0.7374)
2025-12-28 03:03:00 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:03:00 - INFO - 
Epoch 6/50 - 310.89s
2025-12-28 03:03:00 - INFO -   Train Loss: 0.0996, Train Acc: 0.8849
2025-12-28 03:03:00 - INFO -   Val Loss: 0.3589
2025-12-28 03:03:00 - INFO -   Val Accuracy: 0.5593
2025-12-28 03:03:00 - INFO -   Val Balanced Acc: 0.6680
2025-12-28 03:03:00 - INFO -   Val F1 (weighted): 0.5684
2025-12-28 03:03:00 - INFO -   Val F1 (macro): 0.5813
2025-12-28 03:03:00 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:03:00 - INFO -   LR: 0.000096
2025-12-28 03:03:00 - INFO -   No improvement (patience: 1/10)
2025-12-28 03:08:10 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:08:10 - INFO - 
Epoch 7/50 - 310.73s
2025-12-28 03:08:10 - INFO -   Train Loss: 0.0913, Train Acc: 0.8910
2025-12-28 03:08:10 - INFO -   Val Loss: 0.3094
2025-12-28 03:08:10 - INFO -   Val Accuracy: 0.6167
2025-12-28 03:08:10 - INFO -   Val Balanced Acc: 0.6837
2025-12-28 03:08:10 - INFO -   Val F1 (weighted): 0.6253
2025-12-28 03:08:10 - INFO -   Val F1 (macro): 0.6025
2025-12-28 03:08:10 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:08:10 - INFO -   LR: 0.000095
2025-12-28 03:08:10 - INFO -   No improvement (patience: 2/10)
2025-12-28 03:13:21 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:13:21 - INFO - 
Epoch 8/50 - 310.12s
2025-12-28 03:13:21 - INFO -   Train Loss: 0.0755, Train Acc: 0.9094
2025-12-28 03:13:21 - INFO -   Val Loss: 0.2742
2025-12-28 03:13:21 - INFO -   Val Accuracy: 0.6541
2025-12-28 03:13:21 - INFO -   Val Balanced Acc: 0.6928
2025-12-28 03:13:21 - INFO -   Val F1 (weighted): 0.6656
2025-12-28 03:13:21 - INFO -   Val F1 (macro): 0.6403
2025-12-28 03:13:21 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:13:21 - INFO -   LR: 0.000094
2025-12-28 03:13:21 - INFO -   No improvement (patience: 3/10)
2025-12-28 03:18:31 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:18:31 - INFO - 
Epoch 9/50 - 310.61s
2025-12-28 03:18:31 - INFO -   Train Loss: 0.0756, Train Acc: 0.9092
2025-12-28 03:18:31 - INFO -   Val Loss: 0.3170
2025-12-28 03:18:31 - INFO -   Val Accuracy: 0.6791
2025-12-28 03:18:31 - INFO -   Val Balanced Acc: 0.7147
2025-12-28 03:18:31 - INFO -   Val F1 (weighted): 0.6995
2025-12-28 03:18:31 - INFO -   Val F1 (macro): 0.5486
2025-12-28 03:18:31 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:18:31 - INFO -   LR: 0.000092
2025-12-28 03:18:31 - INFO -   No improvement (patience: 4/10)
2025-12-28 03:23:41 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:23:41 - INFO - 
Epoch 10/50 - 310.25s
2025-12-28 03:23:41 - INFO -   Train Loss: 0.0668, Train Acc: 0.9168
2025-12-28 03:23:41 - INFO -   Val Loss: 0.2725
2025-12-28 03:23:41 - INFO -   Val Accuracy: 0.6245
2025-12-28 03:23:41 - INFO -   Val Balanced Acc: 0.6956
2025-12-28 03:23:41 - INFO -   Val F1 (weighted): 0.6442
2025-12-28 03:23:41 - INFO -   Val F1 (macro): 0.6379
2025-12-28 03:23:41 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:23:41 - INFO -   LR: 0.000090
2025-12-28 03:23:41 - INFO -   No improvement (patience: 5/10)
2025-12-28 03:28:52 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:28:52 - INFO - 
Epoch 11/50 - 310.52s
2025-12-28 03:28:52 - INFO -   Train Loss: 0.0615, Train Acc: 0.9224
2025-12-28 03:28:52 - INFO -   Val Loss: 0.2537
2025-12-28 03:28:52 - INFO -   Val Accuracy: 0.7177
2025-12-28 03:28:52 - INFO -   Val Balanced Acc: 0.7188
2025-12-28 03:28:52 - INFO -   Val F1 (weighted): 0.7277
2025-12-28 03:28:52 - INFO -   Val F1 (macro): 0.6670
2025-12-28 03:28:52 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:28:52 - INFO -   LR: 0.000089
2025-12-28 03:28:52 - INFO -   No improvement (patience: 6/10)
2025-12-28 03:34:02 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:34:02 - INFO - 
Epoch 12/50 - 310.47s
2025-12-28 03:34:02 - INFO -   Train Loss: 0.0557, Train Acc: 0.9322
2025-12-28 03:34:02 - INFO -   Val Loss: 0.2333
2025-12-28 03:34:02 - INFO -   Val Accuracy: 0.7415
2025-12-28 03:34:02 - INFO -   Val Balanced Acc: 0.7401
2025-12-28 03:34:02 - INFO -   Val F1 (weighted): 0.7492
2025-12-28 03:34:02 - INFO -   Val F1 (macro): 0.7157
2025-12-28 03:34:02 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:34:02 - INFO -   LR: 0.000086
2025-12-28 03:34:04 - INFO -   Saved best model (balanced_accuracy: 0.7401)
2025-12-28 03:39:15 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:39:15 - INFO - 
Epoch 13/50 - 310.71s
2025-12-28 03:39:15 - INFO -   Train Loss: 0.0524, Train Acc: 0.9355
2025-12-28 03:39:15 - INFO -   Val Loss: 0.2874
2025-12-28 03:39:15 - INFO -   Val Accuracy: 0.6594
2025-12-28 03:39:15 - INFO -   Val Balanced Acc: 0.7241
2025-12-28 03:39:15 - INFO -   Val F1 (weighted): 0.6762
2025-12-28 03:39:15 - INFO -   Val F1 (macro): 0.6493
2025-12-28 03:39:15 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:39:15 - INFO -   LR: 0.000084
2025-12-28 03:39:15 - INFO -   No improvement (patience: 1/10)
2025-12-28 03:44:25 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:44:25 - INFO - 
Epoch 14/50 - 310.29s
2025-12-28 03:44:25 - INFO -   Train Loss: 0.0493, Train Acc: 0.9382
2025-12-28 03:44:25 - INFO -   Val Loss: 0.2394
2025-12-28 03:44:25 - INFO -   Val Accuracy: 0.6972
2025-12-28 03:44:25 - INFO -   Val Balanced Acc: 0.7382
2025-12-28 03:44:25 - INFO -   Val F1 (weighted): 0.7095
2025-12-28 03:44:25 - INFO -   Val F1 (macro): 0.6898
2025-12-28 03:44:25 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:44:25 - INFO -   LR: 0.000082
2025-12-28 03:44:25 - INFO -   No improvement (patience: 2/10)
2025-12-28 03:49:35 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:49:35 - INFO - 
Epoch 15/50 - 310.13s
2025-12-28 03:49:35 - INFO -   Train Loss: 0.0434, Train Acc: 0.9435
2025-12-28 03:49:35 - INFO -   Val Loss: 0.2252
2025-12-28 03:49:35 - INFO -   Val Accuracy: 0.7111
2025-12-28 03:49:35 - INFO -   Val Balanced Acc: 0.7556
2025-12-28 03:49:35 - INFO -   Val F1 (weighted): 0.7216
2025-12-28 03:49:35 - INFO -   Val F1 (macro): 0.6970
2025-12-28 03:49:35 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:49:35 - INFO -   LR: 0.000079
2025-12-28 03:49:37 - INFO -   Saved best model (balanced_accuracy: 0.7556)
2025-12-28 03:54:50 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 03:54:50 - INFO - 
Epoch 16/50 - 313.20s
2025-12-28 03:54:50 - INFO -   Train Loss: 0.0423, Train Acc: 0.9465
2025-12-28 03:54:50 - INFO -   Val Loss: 0.2288
2025-12-28 03:54:50 - INFO -   Val Accuracy: 0.7320
2025-12-28 03:54:50 - INFO -   Val Balanced Acc: 0.7568
2025-12-28 03:54:50 - INFO -   Val F1 (weighted): 0.7382
2025-12-28 03:54:50 - INFO -   Val F1 (macro): 0.6905
2025-12-28 03:54:50 - INFO -   Val AUC (macro): 0.0000
2025-12-28 03:54:50 - INFO -   LR: 0.000077
2025-12-28 03:54:52 - INFO -   Saved best model (balanced_accuracy: 0.7568)
2025-12-28 04:00:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:00:08 - INFO - 
Epoch 17/50 - 315.68s
2025-12-28 04:00:08 - INFO -   Train Loss: 0.0377, Train Acc: 0.9508
2025-12-28 04:00:08 - INFO -   Val Loss: 0.2421
2025-12-28 04:00:08 - INFO -   Val Accuracy: 0.7353
2025-12-28 04:00:08 - INFO -   Val Balanced Acc: 0.7711
2025-12-28 04:00:08 - INFO -   Val F1 (weighted): 0.7432
2025-12-28 04:00:08 - INFO -   Val F1 (macro): 0.6950
2025-12-28 04:00:08 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:00:08 - INFO -   LR: 0.000074
2025-12-28 04:00:10 - INFO -   Saved best model (balanced_accuracy: 0.7711)
2025-12-28 04:05:27 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:05:27 - INFO - 
Epoch 18/50 - 317.16s
2025-12-28 04:05:27 - INFO -   Train Loss: 0.0365, Train Acc: 0.9484
2025-12-28 04:05:27 - INFO -   Val Loss: 0.2590
2025-12-28 04:05:27 - INFO -   Val Accuracy: 0.7037
2025-12-28 04:05:27 - INFO -   Val Balanced Acc: 0.7485
2025-12-28 04:05:27 - INFO -   Val F1 (weighted): 0.7161
2025-12-28 04:05:27 - INFO -   Val F1 (macro): 0.7011
2025-12-28 04:05:27 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:05:27 - INFO -   LR: 0.000071
2025-12-28 04:05:27 - INFO -   No improvement (patience: 1/10)
2025-12-28 04:10:43 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:10:43 - INFO - 
Epoch 19/50 - 315.73s
2025-12-28 04:10:43 - INFO -   Train Loss: 0.0339, Train Acc: 0.9531
2025-12-28 04:10:43 - INFO -   Val Loss: 0.2823
2025-12-28 04:10:43 - INFO -   Val Accuracy: 0.6286
2025-12-28 04:10:43 - INFO -   Val Balanced Acc: 0.7252
2025-12-28 04:10:43 - INFO -   Val F1 (weighted): 0.6472
2025-12-28 04:10:43 - INFO -   Val F1 (macro): 0.6464
2025-12-28 04:10:43 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:10:43 - INFO -   LR: 0.000068
2025-12-28 04:10:43 - INFO -   No improvement (patience: 2/10)
2025-12-28 04:15:58 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:15:58 - INFO - 
Epoch 20/50 - 314.96s
2025-12-28 04:15:58 - INFO -   Train Loss: 0.0281, Train Acc: 0.9579
2025-12-28 04:15:58 - INFO -   Val Loss: 0.2491
2025-12-28 04:15:58 - INFO -   Val Accuracy: 0.7082
2025-12-28 04:15:58 - INFO -   Val Balanced Acc: 0.7539
2025-12-28 04:15:58 - INFO -   Val F1 (weighted): 0.7143
2025-12-28 04:15:58 - INFO -   Val F1 (macro): 0.7120
2025-12-28 04:15:58 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:15:58 - INFO -   LR: 0.000065
2025-12-28 04:15:58 - INFO -   No improvement (patience: 3/10)
2025-12-28 04:21:09 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:21:09 - INFO - 
Epoch 21/50 - 311.71s
2025-12-28 04:21:09 - INFO -   Train Loss: 0.0265, Train Acc: 0.9627
2025-12-28 04:21:09 - INFO -   Val Loss: 0.2131
2025-12-28 04:21:09 - INFO -   Val Accuracy: 0.7784
2025-12-28 04:21:09 - INFO -   Val Balanced Acc: 0.7590
2025-12-28 04:21:09 - INFO -   Val F1 (weighted): 0.7813
2025-12-28 04:21:09 - INFO -   Val F1 (macro): 0.7416
2025-12-28 04:21:09 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:21:09 - INFO -   LR: 0.000062
2025-12-28 04:21:09 - INFO -   No improvement (patience: 4/10)
2025-12-28 04:26:22 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:26:22 - INFO - 
Epoch 22/50 - 312.70s
2025-12-28 04:26:22 - INFO -   Train Loss: 0.0259, Train Acc: 0.9632
2025-12-28 04:26:22 - INFO -   Val Loss: 0.2195
2025-12-28 04:26:22 - INFO -   Val Accuracy: 0.7189
2025-12-28 04:26:22 - INFO -   Val Balanced Acc: 0.7728
2025-12-28 04:26:22 - INFO -   Val F1 (weighted): 0.7261
2025-12-28 04:26:22 - INFO -   Val F1 (macro): 0.7088
2025-12-28 04:26:22 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:26:22 - INFO -   LR: 0.000059
2025-12-28 04:26:24 - INFO -   Saved best model (balanced_accuracy: 0.7728)
2025-12-28 04:31:40 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:31:40 - INFO - 
Epoch 23/50 - 315.78s
2025-12-28 04:31:40 - INFO -   Train Loss: 0.0239, Train Acc: 0.9656
2025-12-28 04:31:40 - INFO -   Val Loss: 0.2059
2025-12-28 04:31:40 - INFO -   Val Accuracy: 0.6816
2025-12-28 04:31:40 - INFO -   Val Balanced Acc: 0.7660
2025-12-28 04:31:40 - INFO -   Val F1 (weighted): 0.6906
2025-12-28 04:31:40 - INFO -   Val F1 (macro): 0.7314
2025-12-28 04:31:40 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:31:40 - INFO -   LR: 0.000056
2025-12-28 04:31:40 - INFO -   No improvement (patience: 1/10)
2025-12-28 04:36:56 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:36:56 - INFO - 
Epoch 24/50 - 315.45s
2025-12-28 04:36:56 - INFO -   Train Loss: 0.0219, Train Acc: 0.9674
2025-12-28 04:36:56 - INFO -   Val Loss: 0.2039
2025-12-28 04:36:56 - INFO -   Val Accuracy: 0.7661
2025-12-28 04:36:56 - INFO -   Val Balanced Acc: 0.7719
2025-12-28 04:36:56 - INFO -   Val F1 (weighted): 0.7728
2025-12-28 04:36:56 - INFO -   Val F1 (macro): 0.7346
2025-12-28 04:36:56 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:36:56 - INFO -   LR: 0.000053
2025-12-28 04:36:56 - INFO -   No improvement (patience: 2/10)
2025-12-28 04:42:11 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:42:11 - INFO - 
Epoch 25/50 - 315.12s
2025-12-28 04:42:11 - INFO -   Train Loss: 0.0188, Train Acc: 0.9696
2025-12-28 04:42:11 - INFO -   Val Loss: 0.2156
2025-12-28 04:42:11 - INFO -   Val Accuracy: 0.7915
2025-12-28 04:42:11 - INFO -   Val Balanced Acc: 0.7769
2025-12-28 04:42:11 - INFO -   Val F1 (weighted): 0.7955
2025-12-28 04:42:11 - INFO -   Val F1 (macro): 0.7632
2025-12-28 04:42:11 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:42:11 - INFO -   LR: 0.000050
2025-12-28 04:42:13 - INFO -   Saved best model (balanced_accuracy: 0.7769)
2025-12-28 04:47:28 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:47:28 - INFO - 
Epoch 26/50 - 315.11s
2025-12-28 04:47:28 - INFO -   Train Loss: 0.0173, Train Acc: 0.9719
2025-12-28 04:47:28 - INFO -   Val Loss: 0.2156
2025-12-28 04:47:28 - INFO -   Val Accuracy: 0.7727
2025-12-28 04:47:28 - INFO -   Val Balanced Acc: 0.7851
2025-12-28 04:47:28 - INFO -   Val F1 (weighted): 0.7800
2025-12-28 04:47:28 - INFO -   Val F1 (macro): 0.7791
2025-12-28 04:47:28 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:47:28 - INFO -   LR: 0.000047
2025-12-28 04:47:30 - INFO -   Saved best model (balanced_accuracy: 0.7851)
2025-12-28 04:52:44 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:52:44 - INFO - 
Epoch 27/50 - 314.16s
2025-12-28 04:52:44 - INFO -   Train Loss: 0.0160, Train Acc: 0.9727
2025-12-28 04:52:44 - INFO -   Val Loss: 0.2454
2025-12-28 04:52:44 - INFO -   Val Accuracy: 0.7279
2025-12-28 04:52:44 - INFO -   Val Balanced Acc: 0.7727
2025-12-28 04:52:44 - INFO -   Val F1 (weighted): 0.7359
2025-12-28 04:52:44 - INFO -   Val F1 (macro): 0.7387
2025-12-28 04:52:44 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:52:44 - INFO -   LR: 0.000044
2025-12-28 04:52:44 - INFO -   No improvement (patience: 1/10)
2025-12-28 04:57:58 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 04:57:58 - INFO - 
Epoch 28/50 - 314.02s
2025-12-28 04:57:58 - INFO -   Train Loss: 0.0137, Train Acc: 0.9766
2025-12-28 04:57:58 - INFO -   Val Loss: 0.2499
2025-12-28 04:57:58 - INFO -   Val Accuracy: 0.7600
2025-12-28 04:57:58 - INFO -   Val Balanced Acc: 0.7723
2025-12-28 04:57:58 - INFO -   Val F1 (weighted): 0.7659
2025-12-28 04:57:58 - INFO -   Val F1 (macro): 0.7299
2025-12-28 04:57:58 - INFO -   Val AUC (macro): 0.0000
2025-12-28 04:57:58 - INFO -   LR: 0.000041
2025-12-28 04:57:58 - INFO -   No improvement (patience: 2/10)
2025-12-28 05:03:11 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:03:11 - INFO - 
Epoch 29/50 - 312.96s
2025-12-28 05:03:11 - INFO -   Train Loss: 0.0140, Train Acc: 0.9764
2025-12-28 05:03:11 - INFO -   Val Loss: 0.2298
2025-12-28 05:03:11 - INFO -   Val Accuracy: 0.7275
2025-12-28 05:03:11 - INFO -   Val Balanced Acc: 0.7694
2025-12-28 05:03:11 - INFO -   Val F1 (weighted): 0.7357
2025-12-28 05:03:11 - INFO -   Val F1 (macro): 0.7359
2025-12-28 05:03:11 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:03:11 - INFO -   LR: 0.000038
2025-12-28 05:03:11 - INFO -   No improvement (patience: 3/10)
2025-12-28 05:08:25 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:08:25 - INFO - 
Epoch 30/50 - 313.48s
2025-12-28 05:08:25 - INFO -   Train Loss: 0.0114, Train Acc: 0.9798
2025-12-28 05:08:25 - INFO -   Val Loss: 0.2334
2025-12-28 05:08:25 - INFO -   Val Accuracy: 0.7062
2025-12-28 05:08:25 - INFO -   Val Balanced Acc: 0.7654
2025-12-28 05:08:25 - INFO -   Val F1 (weighted): 0.7116
2025-12-28 05:08:25 - INFO -   Val F1 (macro): 0.7345
2025-12-28 05:08:25 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:08:25 - INFO -   LR: 0.000035
2025-12-28 05:08:25 - INFO -   No improvement (patience: 4/10)
2025-12-28 05:13:40 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:13:40 - INFO - 
Epoch 31/50 - 314.86s
2025-12-28 05:13:40 - INFO -   Train Loss: 0.0102, Train Acc: 0.9814
2025-12-28 05:13:40 - INFO -   Val Loss: 0.2020
2025-12-28 05:13:40 - INFO -   Val Accuracy: 0.7899
2025-12-28 05:13:40 - INFO -   Val Balanced Acc: 0.7948
2025-12-28 05:13:40 - INFO -   Val F1 (weighted): 0.7963
2025-12-28 05:13:40 - INFO -   Val F1 (macro): 0.7693
2025-12-28 05:13:40 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:13:40 - INFO -   LR: 0.000032
2025-12-28 05:13:42 - INFO -   Saved best model (balanced_accuracy: 0.7948)
2025-12-28 05:18:56 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:18:56 - INFO - 
Epoch 32/50 - 314.11s
2025-12-28 05:18:56 - INFO -   Train Loss: 0.0099, Train Acc: 0.9805
2025-12-28 05:18:56 - INFO -   Val Loss: 0.1981
2025-12-28 05:18:56 - INFO -   Val Accuracy: 0.8231
2025-12-28 05:18:56 - INFO -   Val Balanced Acc: 0.8128
2025-12-28 05:18:56 - INFO -   Val F1 (weighted): 0.8254
2025-12-28 05:18:56 - INFO -   Val F1 (macro): 0.8040
2025-12-28 05:18:56 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:18:56 - INFO -   LR: 0.000029
2025-12-28 05:18:58 - INFO -   Saved best model (balanced_accuracy: 0.8128)
2025-12-28 05:24:11 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:24:11 - INFO - 
Epoch 33/50 - 313.88s
2025-12-28 05:24:11 - INFO -   Train Loss: 0.0084, Train Acc: 0.9833
2025-12-28 05:24:11 - INFO -   Val Loss: 0.2261
2025-12-28 05:24:11 - INFO -   Val Accuracy: 0.7747
2025-12-28 05:24:11 - INFO -   Val Balanced Acc: 0.7847
2025-12-28 05:24:11 - INFO -   Val F1 (weighted): 0.7806
2025-12-28 05:24:11 - INFO -   Val F1 (macro): 0.7725
2025-12-28 05:24:11 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:24:11 - INFO -   LR: 0.000026
2025-12-28 05:24:11 - INFO -   No improvement (patience: 1/10)
2025-12-28 05:29:26 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:29:26 - INFO - 
Epoch 34/50 - 314.83s
2025-12-28 05:29:26 - INFO -   Train Loss: 0.0076, Train Acc: 0.9838
2025-12-28 05:29:26 - INFO -   Val Loss: 0.2349
2025-12-28 05:29:26 - INFO -   Val Accuracy: 0.8084
2025-12-28 05:29:26 - INFO -   Val Balanced Acc: 0.7972
2025-12-28 05:29:26 - INFO -   Val F1 (weighted): 0.8109
2025-12-28 05:29:26 - INFO -   Val F1 (macro): 0.7853
2025-12-28 05:29:26 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:29:26 - INFO -   LR: 0.000023
2025-12-28 05:29:26 - INFO -   No improvement (patience: 2/10)
2025-12-28 05:34:42 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:34:42 - INFO - 
Epoch 35/50 - 315.81s
2025-12-28 05:34:42 - INFO -   Train Loss: 0.0070, Train Acc: 0.9854
2025-12-28 05:34:42 - INFO -   Val Loss: 0.2253
2025-12-28 05:34:42 - INFO -   Val Accuracy: 0.7743
2025-12-28 05:34:42 - INFO -   Val Balanced Acc: 0.7887
2025-12-28 05:34:42 - INFO -   Val F1 (weighted): 0.7802
2025-12-28 05:34:42 - INFO -   Val F1 (macro): 0.7723
2025-12-28 05:34:42 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:34:42 - INFO -   LR: 0.000021
2025-12-28 05:34:42 - INFO -   No improvement (patience: 3/10)
2025-12-28 05:39:56 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:39:56 - INFO - 
Epoch 36/50 - 314.01s
2025-12-28 05:39:56 - INFO -   Train Loss: 0.0069, Train Acc: 0.9860
2025-12-28 05:39:56 - INFO -   Val Loss: 0.2373
2025-12-28 05:39:56 - INFO -   Val Accuracy: 0.8063
2025-12-28 05:39:56 - INFO -   Val Balanced Acc: 0.7921
2025-12-28 05:39:56 - INFO -   Val F1 (weighted): 0.8099
2025-12-28 05:39:56 - INFO -   Val F1 (macro): 0.7830
2025-12-28 05:39:56 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:39:56 - INFO -   LR: 0.000018
2025-12-28 05:39:56 - INFO -   No improvement (patience: 4/10)
2025-12-28 05:45:08 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:45:08 - INFO - 
Epoch 37/50 - 311.67s
2025-12-28 05:45:08 - INFO -   Train Loss: 0.0047, Train Acc: 0.9877
2025-12-28 05:45:08 - INFO -   Val Loss: 0.2246
2025-12-28 05:45:08 - INFO -   Val Accuracy: 0.8174
2025-12-28 05:45:08 - INFO -   Val Balanced Acc: 0.7976
2025-12-28 05:45:08 - INFO -   Val F1 (weighted): 0.8209
2025-12-28 05:45:08 - INFO -   Val F1 (macro): 0.7872
2025-12-28 05:45:08 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:45:08 - INFO -   LR: 0.000016
2025-12-28 05:45:08 - INFO -   No improvement (patience: 5/10)
2025-12-28 05:50:25 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:50:25 - INFO - 
Epoch 38/50 - 316.81s
2025-12-28 05:50:25 - INFO -   Train Loss: 0.0048, Train Acc: 0.9887
2025-12-28 05:50:25 - INFO -   Val Loss: 0.2344
2025-12-28 05:50:25 - INFO -   Val Accuracy: 0.8006
2025-12-28 05:50:25 - INFO -   Val Balanced Acc: 0.7915
2025-12-28 05:50:25 - INFO -   Val F1 (weighted): 0.8044
2025-12-28 05:50:25 - INFO -   Val F1 (macro): 0.7827
2025-12-28 05:50:25 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:50:25 - INFO -   LR: 0.000014
2025-12-28 05:50:25 - INFO -   No improvement (patience: 6/10)
2025-12-28 05:55:42 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 05:55:42 - INFO - 
Epoch 39/50 - 317.16s
2025-12-28 05:55:42 - INFO -   Train Loss: 0.0053, Train Acc: 0.9873
2025-12-28 05:55:42 - INFO -   Val Loss: 0.2206
2025-12-28 05:55:42 - INFO -   Val Accuracy: 0.8289
2025-12-28 05:55:42 - INFO -   Val Balanced Acc: 0.7959
2025-12-28 05:55:42 - INFO -   Val F1 (weighted): 0.8310
2025-12-28 05:55:42 - INFO -   Val F1 (macro): 0.8006
2025-12-28 05:55:42 - INFO -   Val AUC (macro): 0.0000
2025-12-28 05:55:42 - INFO -   LR: 0.000011
2025-12-28 05:55:42 - INFO -   No improvement (patience: 7/10)
2025-12-28 06:00:59 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 06:00:59 - INFO - 
Epoch 40/50 - 317.12s
2025-12-28 06:00:59 - INFO -   Train Loss: 0.0044, Train Acc: 0.9890
2025-12-28 06:00:59 - INFO -   Val Loss: 0.2242
2025-12-28 06:00:59 - INFO -   Val Accuracy: 0.8248
2025-12-28 06:00:59 - INFO -   Val Balanced Acc: 0.7937
2025-12-28 06:00:59 - INFO -   Val F1 (weighted): 0.8272
2025-12-28 06:00:59 - INFO -   Val F1 (macro): 0.7960
2025-12-28 06:00:59 - INFO -   Val AUC (macro): 0.0000
2025-12-28 06:00:59 - INFO -   LR: 0.000010
2025-12-28 06:00:59 - INFO -   No improvement (patience: 8/10)
2025-12-28 06:06:15 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 06:06:15 - INFO - 
Epoch 41/50 - 315.98s
2025-12-28 06:06:15 - INFO -   Train Loss: 0.0034, Train Acc: 0.9912
2025-12-28 06:06:15 - INFO -   Val Loss: 0.2362
2025-12-28 06:06:15 - INFO -   Val Accuracy: 0.8223
2025-12-28 06:06:15 - INFO -   Val Balanced Acc: 0.7992
2025-12-28 06:06:15 - INFO -   Val F1 (weighted): 0.8253
2025-12-28 06:06:15 - INFO -   Val F1 (macro): 0.7978
2025-12-28 06:06:15 - INFO -   Val AUC (macro): 0.0000
2025-12-28 06:06:15 - INFO -   LR: 0.000008
2025-12-28 06:06:15 - INFO -   No improvement (patience: 9/10)
2025-12-28 06:11:33 - WARNING - AUC calculation failed: Target scores need to be probabilities for multiclass roc_auc, i.e. they should sum up to 1.0 over classes
2025-12-28 06:11:33 - INFO - 
Epoch 42/50 - 317.85s
2025-12-28 06:11:33 - INFO -   Train Loss: 0.0039, Train Acc: 0.9911
2025-12-28 06:11:33 - INFO -   Val Loss: 0.2265
2025-12-28 06:11:33 - INFO -   Val Accuracy: 0.8272
2025-12-28 06:11:33 - INFO -   Val Balanced Acc: 0.8037
2025-12-28 06:11:33 - INFO -   Val F1 (weighted): 0.8300
2025-12-28 06:11:33 - INFO -   Val F1 (macro): 0.8012
2025-12-28 06:11:33 - INFO -   Val AUC (macro): 0.0000
2025-12-28 06:11:33 - INFO -   LR: 0.000006
2025-12-28 06:11:33 - INFO -   No improvement (patience: 10/10)
2025-12-28 06:11:33 - INFO - 
Early stopping at epoch 42
2025-12-28 06:11:33 - INFO - 
================================================================================
2025-12-28 06:11:33 - INFO - TRAINING COMPLETE
2025-12-28 06:11:33 - INFO - ================================================================================
2025-12-28 06:11:33 - INFO - Total time: 227.98 minutes
2025-12-28 06:11:33 - INFO - Best balanced_accuracy: 0.8128 (epoch 32)
2025-12-28 06:11:33 - INFO - Average time per epoch: 325.69 seconds
2025-12-28 06:11:33 - INFO - Model saved to: models/swin_fold4_20251228_022330
2025-12-28 06:11:33 - INFO - 
Results saved to: models/swin_fold4_20251228_022330/final_results.json
