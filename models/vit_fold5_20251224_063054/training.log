2025-12-24 06:30:54 - INFO - Logging initialized. Log file: models/vit_fold5_20251224_063054/training.log
2025-12-24 06:30:54 - INFO - ================================================================================
2025-12-24 06:30:54 - INFO - OPTIMIZED TRAINING CONFIGURATION
2025-12-24 06:30:54 - INFO - ================================================================================
2025-12-24 06:30:54 - INFO - Model: vit
2025-12-24 06:30:54 - INFO - Dataset: Combined MILK10k + ISIC2019
2025-12-24 06:30:54 - INFO - Fold: 5
2025-12-24 06:30:54 - INFO - Batch size: 16
2025-12-24 06:30:54 - INFO - Effective batch size: 16
2025-12-24 06:30:54 - INFO - Epochs: 50
2025-12-24 06:30:54 - INFO - Learning rate: 0.0001
2025-12-24 06:30:54 - INFO - Workers: 8
2025-12-24 06:30:54 - INFO - Mixed precision: True
2025-12-24 06:30:54 - INFO - Gradient accumulation: 1
2025-12-24 06:30:54 - INFO - Prefetch factor: 2
2025-12-24 06:30:54 - INFO - Focal loss: True
2025-12-24 06:30:54 - INFO - Skin tone sampling: True
2025-12-24 06:30:54 - INFO - Device: cuda
2025-12-24 06:30:54 - INFO - Output: models/vit_fold5_20251224_063054
2025-12-24 06:30:54 - INFO - ================================================================================
2025-12-24 06:30:54 - INFO - 
Creating data loaders...
2025-12-24 06:30:55 - INFO - Train samples: 21937
2025-12-24 06:30:55 - INFO - Val samples: 2437
2025-12-24 06:30:55 - INFO - 
Creating vit model...
2025-12-24 06:30:57 - INFO - 
Starting training...

2025-12-24 06:34:53 - INFO - 
Epoch 1/50 - 236.52s
2025-12-24 06:34:53 - INFO -   Train Loss: 0.7639, Train Acc: 0.4466
2025-12-24 06:34:53 - INFO -   Val Loss: 0.5824
2025-12-24 06:34:53 - INFO -   Val Accuracy: 0.3906
2025-12-24 06:34:53 - INFO -   Val Balanced Acc: 0.4872
2025-12-24 06:34:53 - INFO -   Val F1 (weighted): 0.4037
2025-12-24 06:34:53 - INFO -   Val F1 (macro): 0.2973
2025-12-24 06:34:53 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:34:53 - INFO -   LR: 0.000100
2025-12-24 06:34:56 - INFO -   Saved best model (balanced_accuracy: 0.4872)
2025-12-24 06:38:29 - INFO - 
Epoch 2/50 - 213.56s
2025-12-24 06:38:29 - INFO -   Train Loss: 0.4530, Train Acc: 0.6230
2025-12-24 06:38:29 - INFO -   Val Loss: 0.4825
2025-12-24 06:38:29 - INFO -   Val Accuracy: 0.4719
2025-12-24 06:38:29 - INFO -   Val Balanced Acc: 0.5526
2025-12-24 06:38:29 - INFO -   Val F1 (weighted): 0.4949
2025-12-24 06:38:29 - INFO -   Val F1 (macro): 0.4133
2025-12-24 06:38:29 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:38:29 - INFO -   LR: 0.000100
2025-12-24 06:38:31 - INFO -   Saved best model (balanced_accuracy: 0.5526)
2025-12-24 06:42:05 - INFO - 
Epoch 3/50 - 213.56s
2025-12-24 06:42:05 - INFO -   Train Loss: 0.3777, Train Acc: 0.6711
2025-12-24 06:42:05 - INFO -   Val Loss: 0.5331
2025-12-24 06:42:05 - INFO -   Val Accuracy: 0.4809
2025-12-24 06:42:05 - INFO -   Val Balanced Acc: 0.5359
2025-12-24 06:42:05 - INFO -   Val F1 (weighted): 0.5314
2025-12-24 06:42:05 - INFO -   Val F1 (macro): 0.3641
2025-12-24 06:42:05 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:42:05 - INFO -   LR: 0.000099
2025-12-24 06:42:05 - INFO -   No improvement (patience: 1/10)
2025-12-24 06:45:37 - INFO - 
Epoch 4/50 - 212.53s
2025-12-24 06:45:37 - INFO -   Train Loss: 0.3283, Train Acc: 0.7049
2025-12-24 06:45:37 - INFO -   Val Loss: 0.4948
2025-12-24 06:45:37 - INFO -   Val Accuracy: 0.3915
2025-12-24 06:45:37 - INFO -   Val Balanced Acc: 0.5340
2025-12-24 06:45:37 - INFO -   Val F1 (weighted): 0.3954
2025-12-24 06:45:37 - INFO -   Val F1 (macro): 0.3861
2025-12-24 06:45:37 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:45:37 - INFO -   LR: 0.000098
2025-12-24 06:45:37 - INFO -   No improvement (patience: 2/10)
2025-12-24 06:49:11 - INFO - 
Epoch 5/50 - 213.51s
2025-12-24 06:49:11 - INFO -   Train Loss: 0.2921, Train Acc: 0.7318
2025-12-24 06:49:11 - INFO -   Val Loss: 0.4403
2025-12-24 06:49:11 - INFO -   Val Accuracy: 0.5564
2025-12-24 06:49:11 - INFO -   Val Balanced Acc: 0.5766
2025-12-24 06:49:11 - INFO -   Val F1 (weighted): 0.5893
2025-12-24 06:49:11 - INFO -   Val F1 (macro): 0.4376
2025-12-24 06:49:11 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:49:11 - INFO -   LR: 0.000098
2025-12-24 06:49:13 - INFO -   Saved best model (balanced_accuracy: 0.5766)
2025-12-24 06:52:45 - INFO - 
Epoch 6/50 - 212.85s
2025-12-24 06:52:45 - INFO -   Train Loss: 0.2587, Train Acc: 0.7589
2025-12-24 06:52:45 - INFO -   Val Loss: 0.4862
2025-12-24 06:52:45 - INFO -   Val Accuracy: 0.5421
2025-12-24 06:52:45 - INFO -   Val Balanced Acc: 0.5838
2025-12-24 06:52:45 - INFO -   Val F1 (weighted): 0.5787
2025-12-24 06:52:45 - INFO -   Val F1 (macro): 0.4166
2025-12-24 06:52:45 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:52:45 - INFO -   LR: 0.000096
2025-12-24 06:52:47 - INFO -   Saved best model (balanced_accuracy: 0.5838)
2025-12-24 06:56:20 - INFO - 
Epoch 7/50 - 213.32s
2025-12-24 06:56:20 - INFO -   Train Loss: 0.2477, Train Acc: 0.7598
2025-12-24 06:56:20 - INFO -   Val Loss: 0.4075
2025-12-24 06:56:20 - INFO -   Val Accuracy: 0.5363
2025-12-24 06:56:20 - INFO -   Val Balanced Acc: 0.5960
2025-12-24 06:56:20 - INFO -   Val F1 (weighted): 0.5736
2025-12-24 06:56:20 - INFO -   Val F1 (macro): 0.4451
2025-12-24 06:56:20 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:56:20 - INFO -   LR: 0.000095
2025-12-24 06:56:22 - INFO -   Saved best model (balanced_accuracy: 0.5960)
2025-12-24 06:59:54 - INFO - 
Epoch 8/50 - 212.39s
2025-12-24 06:59:54 - INFO -   Train Loss: 0.2195, Train Acc: 0.7796
2025-12-24 06:59:54 - INFO -   Val Loss: 0.4067
2025-12-24 06:59:54 - INFO -   Val Accuracy: 0.5905
2025-12-24 06:59:54 - INFO -   Val Balanced Acc: 0.6197
2025-12-24 06:59:54 - INFO -   Val F1 (weighted): 0.6148
2025-12-24 06:59:54 - INFO -   Val F1 (macro): 0.4674
2025-12-24 06:59:54 - INFO -   Val AUC (macro): 0.0000
2025-12-24 06:59:54 - INFO -   LR: 0.000094
2025-12-24 06:59:56 - INFO -   Saved best model (balanced_accuracy: 0.6197)
2025-12-24 07:03:29 - INFO - 
Epoch 9/50 - 213.22s
2025-12-24 07:03:29 - INFO -   Train Loss: 0.1947, Train Acc: 0.7992
2025-12-24 07:03:29 - INFO -   Val Loss: 0.4053
2025-12-24 07:03:29 - INFO -   Val Accuracy: 0.4752
2025-12-24 07:03:29 - INFO -   Val Balanced Acc: 0.5937
2025-12-24 07:03:29 - INFO -   Val F1 (weighted): 0.4833
2025-12-24 07:03:29 - INFO -   Val F1 (macro): 0.4774
2025-12-24 07:03:29 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:03:29 - INFO -   LR: 0.000092
2025-12-24 07:03:29 - INFO -   No improvement (patience: 1/10)
2025-12-24 07:07:00 - INFO - 
Epoch 10/50 - 210.86s
2025-12-24 07:07:00 - INFO -   Train Loss: 0.1800, Train Acc: 0.8100
2025-12-24 07:07:00 - INFO -   Val Loss: 0.3788
2025-12-24 07:07:00 - INFO -   Val Accuracy: 0.5585
2025-12-24 07:07:00 - INFO -   Val Balanced Acc: 0.6382
2025-12-24 07:07:00 - INFO -   Val F1 (weighted): 0.5819
2025-12-24 07:07:00 - INFO -   Val F1 (macro): 0.4943
2025-12-24 07:07:00 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:07:00 - INFO -   LR: 0.000090
2025-12-24 07:07:02 - INFO -   Saved best model (balanced_accuracy: 0.6382)
2025-12-24 07:10:32 - INFO - 
Epoch 11/50 - 210.04s
2025-12-24 07:10:32 - INFO -   Train Loss: 0.1640, Train Acc: 0.8210
2025-12-24 07:10:32 - INFO -   Val Loss: 0.4505
2025-12-24 07:10:32 - INFO -   Val Accuracy: 0.5031
2025-12-24 07:10:32 - INFO -   Val Balanced Acc: 0.6098
2025-12-24 07:10:32 - INFO -   Val F1 (weighted): 0.5297
2025-12-24 07:10:32 - INFO -   Val F1 (macro): 0.4605
2025-12-24 07:10:32 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:10:32 - INFO -   LR: 0.000089
2025-12-24 07:10:32 - INFO -   No improvement (patience: 1/10)
2025-12-24 07:14:08 - INFO - 
Epoch 12/50 - 215.99s
2025-12-24 07:14:08 - INFO -   Train Loss: 0.1542, Train Acc: 0.8339
2025-12-24 07:14:08 - INFO -   Val Loss: 0.3631
2025-12-24 07:14:08 - INFO -   Val Accuracy: 0.5897
2025-12-24 07:14:08 - INFO -   Val Balanced Acc: 0.6312
2025-12-24 07:14:08 - INFO -   Val F1 (weighted): 0.6108
2025-12-24 07:14:08 - INFO -   Val F1 (macro): 0.5310
2025-12-24 07:14:08 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:14:08 - INFO -   LR: 0.000086
2025-12-24 07:14:08 - INFO -   No improvement (patience: 2/10)
2025-12-24 07:17:44 - INFO - 
Epoch 13/50 - 216.16s
2025-12-24 07:17:44 - INFO -   Train Loss: 0.1351, Train Acc: 0.8466
2025-12-24 07:17:44 - INFO -   Val Loss: 0.3817
2025-12-24 07:17:44 - INFO -   Val Accuracy: 0.6081
2025-12-24 07:17:44 - INFO -   Val Balanced Acc: 0.6523
2025-12-24 07:17:44 - INFO -   Val F1 (weighted): 0.6287
2025-12-24 07:17:44 - INFO -   Val F1 (macro): 0.5160
2025-12-24 07:17:44 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:17:44 - INFO -   LR: 0.000084
2025-12-24 07:17:46 - INFO -   Saved best model (balanced_accuracy: 0.6523)
2025-12-24 07:21:23 - INFO - 
Epoch 14/50 - 217.34s
2025-12-24 07:21:23 - INFO -   Train Loss: 0.1290, Train Acc: 0.8539
2025-12-24 07:21:23 - INFO -   Val Loss: 0.3657
2025-12-24 07:21:23 - INFO -   Val Accuracy: 0.5720
2025-12-24 07:21:23 - INFO -   Val Balanced Acc: 0.6402
2025-12-24 07:21:23 - INFO -   Val F1 (weighted): 0.6009
2025-12-24 07:21:23 - INFO -   Val F1 (macro): 0.5524
2025-12-24 07:21:23 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:21:23 - INFO -   LR: 0.000082
2025-12-24 07:21:23 - INFO -   No improvement (patience: 1/10)
2025-12-24 07:25:02 - INFO - 
Epoch 15/50 - 218.91s
2025-12-24 07:25:02 - INFO -   Train Loss: 0.1167, Train Acc: 0.8632
2025-12-24 07:25:02 - INFO -   Val Loss: 0.3786
2025-12-24 07:25:02 - INFO -   Val Accuracy: 0.6176
2025-12-24 07:25:02 - INFO -   Val Balanced Acc: 0.6282
2025-12-24 07:25:02 - INFO -   Val F1 (weighted): 0.6295
2025-12-24 07:25:02 - INFO -   Val F1 (macro): 0.5254
2025-12-24 07:25:02 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:25:02 - INFO -   LR: 0.000079
2025-12-24 07:25:02 - INFO -   No improvement (patience: 2/10)
2025-12-24 07:28:36 - INFO - 
Epoch 16/50 - 214.22s
2025-12-24 07:28:36 - INFO -   Train Loss: 0.1077, Train Acc: 0.8738
2025-12-24 07:28:36 - INFO -   Val Loss: 0.3800
2025-12-24 07:28:36 - INFO -   Val Accuracy: 0.5593
2025-12-24 07:28:36 - INFO -   Val Balanced Acc: 0.6118
2025-12-24 07:28:36 - INFO -   Val F1 (weighted): 0.5866
2025-12-24 07:28:36 - INFO -   Val F1 (macro): 0.5325
2025-12-24 07:28:36 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:28:36 - INFO -   LR: 0.000077
2025-12-24 07:28:36 - INFO -   No improvement (patience: 3/10)
2025-12-24 07:32:13 - INFO - 
Epoch 17/50 - 216.74s
2025-12-24 07:32:13 - INFO -   Train Loss: 0.0975, Train Acc: 0.8810
2025-12-24 07:32:13 - INFO -   Val Loss: 0.4014
2025-12-24 07:32:13 - INFO -   Val Accuracy: 0.5392
2025-12-24 07:32:13 - INFO -   Val Balanced Acc: 0.6027
2025-12-24 07:32:13 - INFO -   Val F1 (weighted): 0.5579
2025-12-24 07:32:13 - INFO -   Val F1 (macro): 0.5325
2025-12-24 07:32:13 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:32:13 - INFO -   LR: 0.000074
2025-12-24 07:32:13 - INFO -   No improvement (patience: 4/10)
2025-12-24 07:35:50 - INFO - 
Epoch 18/50 - 216.89s
2025-12-24 07:35:50 - INFO -   Train Loss: 0.0951, Train Acc: 0.8844
2025-12-24 07:35:50 - INFO -   Val Loss: 0.3579
2025-12-24 07:35:50 - INFO -   Val Accuracy: 0.5687
2025-12-24 07:35:50 - INFO -   Val Balanced Acc: 0.6322
2025-12-24 07:35:50 - INFO -   Val F1 (weighted): 0.5951
2025-12-24 07:35:50 - INFO -   Val F1 (macro): 0.5311
2025-12-24 07:35:50 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:35:50 - INFO -   LR: 0.000071
2025-12-24 07:35:50 - INFO -   No improvement (patience: 5/10)
2025-12-24 07:39:25 - INFO - 
Epoch 19/50 - 215.10s
2025-12-24 07:39:25 - INFO -   Train Loss: 0.0818, Train Acc: 0.8927
2025-12-24 07:39:25 - INFO -   Val Loss: 0.3348
2025-12-24 07:39:25 - INFO -   Val Accuracy: 0.6192
2025-12-24 07:39:25 - INFO -   Val Balanced Acc: 0.6662
2025-12-24 07:39:25 - INFO -   Val F1 (weighted): 0.6400
2025-12-24 07:39:25 - INFO -   Val F1 (macro): 0.5907
2025-12-24 07:39:25 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:39:25 - INFO -   LR: 0.000068
2025-12-24 07:39:27 - INFO -   Saved best model (balanced_accuracy: 0.6662)
2025-12-24 07:43:02 - INFO - 
Epoch 20/50 - 214.99s
2025-12-24 07:43:02 - INFO -   Train Loss: 0.0772, Train Acc: 0.9038
2025-12-24 07:43:02 - INFO -   Val Loss: 0.3682
2025-12-24 07:43:02 - INFO -   Val Accuracy: 0.5732
2025-12-24 07:43:02 - INFO -   Val Balanced Acc: 0.6403
2025-12-24 07:43:02 - INFO -   Val F1 (weighted): 0.5978
2025-12-24 07:43:02 - INFO -   Val F1 (macro): 0.5322
2025-12-24 07:43:02 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:43:02 - INFO -   LR: 0.000065
2025-12-24 07:43:02 - INFO -   No improvement (patience: 1/10)
2025-12-24 07:46:35 - INFO - 
Epoch 21/50 - 212.71s
2025-12-24 07:46:35 - INFO -   Train Loss: 0.0689, Train Acc: 0.9055
2025-12-24 07:46:35 - INFO -   Val Loss: 0.3412
2025-12-24 07:46:35 - INFO -   Val Accuracy: 0.6422
2025-12-24 07:46:35 - INFO -   Val Balanced Acc: 0.6538
2025-12-24 07:46:35 - INFO -   Val F1 (weighted): 0.6634
2025-12-24 07:46:35 - INFO -   Val F1 (macro): 0.6060
2025-12-24 07:46:35 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:46:35 - INFO -   LR: 0.000062
2025-12-24 07:46:35 - INFO -   No improvement (patience: 2/10)
2025-12-24 07:50:07 - INFO - 
Epoch 22/50 - 212.50s
2025-12-24 07:50:07 - INFO -   Train Loss: 0.0649, Train Acc: 0.9156
2025-12-24 07:50:07 - INFO -   Val Loss: 0.3420
2025-12-24 07:50:07 - INFO -   Val Accuracy: 0.5831
2025-12-24 07:50:07 - INFO -   Val Balanced Acc: 0.6761
2025-12-24 07:50:07 - INFO -   Val F1 (weighted): 0.6045
2025-12-24 07:50:07 - INFO -   Val F1 (macro): 0.5802
2025-12-24 07:50:07 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:50:07 - INFO -   LR: 0.000059
2025-12-24 07:50:10 - INFO -   Saved best model (balanced_accuracy: 0.6761)
2025-12-24 07:53:42 - INFO - 
Epoch 23/50 - 212.27s
2025-12-24 07:53:42 - INFO -   Train Loss: 0.0601, Train Acc: 0.9192
2025-12-24 07:53:42 - INFO -   Val Loss: 0.3297
2025-12-24 07:53:42 - INFO -   Val Accuracy: 0.6217
2025-12-24 07:53:42 - INFO -   Val Balanced Acc: 0.6898
2025-12-24 07:53:42 - INFO -   Val F1 (weighted): 0.6338
2025-12-24 07:53:42 - INFO -   Val F1 (macro): 0.6086
2025-12-24 07:53:42 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:53:42 - INFO -   LR: 0.000056
2025-12-24 07:53:44 - INFO -   Saved best model (balanced_accuracy: 0.6898)
2025-12-24 07:57:17 - INFO - 
Epoch 24/50 - 213.48s
2025-12-24 07:57:17 - INFO -   Train Loss: 0.0529, Train Acc: 0.9247
2025-12-24 07:57:17 - INFO -   Val Loss: 0.3544
2025-12-24 07:57:17 - INFO -   Val Accuracy: 0.6106
2025-12-24 07:57:17 - INFO -   Val Balanced Acc: 0.6699
2025-12-24 07:57:17 - INFO -   Val F1 (weighted): 0.6275
2025-12-24 07:57:17 - INFO -   Val F1 (macro): 0.6086
2025-12-24 07:57:17 - INFO -   Val AUC (macro): 0.0000
2025-12-24 07:57:17 - INFO -   LR: 0.000053
2025-12-24 07:57:17 - INFO -   No improvement (patience: 1/10)
2025-12-24 08:00:54 - INFO - 
Epoch 25/50 - 216.51s
2025-12-24 08:00:54 - INFO -   Train Loss: 0.0520, Train Acc: 0.9296
2025-12-24 08:00:54 - INFO -   Val Loss: 0.3291
2025-12-24 08:00:54 - INFO -   Val Accuracy: 0.6295
2025-12-24 08:00:54 - INFO -   Val Balanced Acc: 0.6641
2025-12-24 08:00:54 - INFO -   Val F1 (weighted): 0.6470
2025-12-24 08:00:54 - INFO -   Val F1 (macro): 0.5862
2025-12-24 08:00:54 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:00:54 - INFO -   LR: 0.000050
2025-12-24 08:00:54 - INFO -   No improvement (patience: 2/10)
2025-12-24 08:04:29 - INFO - 
Epoch 26/50 - 215.32s
2025-12-24 08:04:29 - INFO -   Train Loss: 0.0460, Train Acc: 0.9353
2025-12-24 08:04:29 - INFO -   Val Loss: 0.3266
2025-12-24 08:04:29 - INFO -   Val Accuracy: 0.6758
2025-12-24 08:04:29 - INFO -   Val Balanced Acc: 0.6779
2025-12-24 08:04:29 - INFO -   Val F1 (weighted): 0.6854
2025-12-24 08:04:29 - INFO -   Val F1 (macro): 0.6407
2025-12-24 08:04:29 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:04:29 - INFO -   LR: 0.000047
2025-12-24 08:04:29 - INFO -   No improvement (patience: 3/10)
2025-12-24 08:08:04 - INFO - 
Epoch 27/50 - 214.39s
2025-12-24 08:08:04 - INFO -   Train Loss: 0.0404, Train Acc: 0.9424
2025-12-24 08:08:04 - INFO -   Val Loss: 0.3343
2025-12-24 08:08:04 - INFO -   Val Accuracy: 0.6693
2025-12-24 08:08:04 - INFO -   Val Balanced Acc: 0.6700
2025-12-24 08:08:04 - INFO -   Val F1 (weighted): 0.6836
2025-12-24 08:08:04 - INFO -   Val F1 (macro): 0.6168
2025-12-24 08:08:04 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:08:04 - INFO -   LR: 0.000044
2025-12-24 08:08:04 - INFO -   No improvement (patience: 4/10)
2025-12-24 08:11:36 - INFO - 
Epoch 28/50 - 212.91s
2025-12-24 08:11:36 - INFO -   Train Loss: 0.0379, Train Acc: 0.9461
2025-12-24 08:11:36 - INFO -   Val Loss: 0.3408
2025-12-24 08:11:36 - INFO -   Val Accuracy: 0.6241
2025-12-24 08:11:36 - INFO -   Val Balanced Acc: 0.6854
2025-12-24 08:11:36 - INFO -   Val F1 (weighted): 0.6359
2025-12-24 08:11:36 - INFO -   Val F1 (macro): 0.5830
2025-12-24 08:11:36 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:11:36 - INFO -   LR: 0.000041
2025-12-24 08:11:36 - INFO -   No improvement (patience: 5/10)
2025-12-24 08:15:07 - INFO - 
Epoch 29/50 - 210.65s
2025-12-24 08:15:07 - INFO -   Train Loss: 0.0333, Train Acc: 0.9514
2025-12-24 08:15:07 - INFO -   Val Loss: 0.3366
2025-12-24 08:15:07 - INFO -   Val Accuracy: 0.6602
2025-12-24 08:15:07 - INFO -   Val Balanced Acc: 0.6753
2025-12-24 08:15:07 - INFO -   Val F1 (weighted): 0.6719
2025-12-24 08:15:07 - INFO -   Val F1 (macro): 0.6142
2025-12-24 08:15:07 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:15:07 - INFO -   LR: 0.000038
2025-12-24 08:15:07 - INFO -   No improvement (patience: 6/10)
2025-12-24 08:18:38 - INFO - 
Epoch 30/50 - 211.32s
2025-12-24 08:18:38 - INFO -   Train Loss: 0.0326, Train Acc: 0.9507
2025-12-24 08:18:38 - INFO -   Val Loss: 0.3377
2025-12-24 08:18:38 - INFO -   Val Accuracy: 0.6594
2025-12-24 08:18:38 - INFO -   Val Balanced Acc: 0.6746
2025-12-24 08:18:38 - INFO -   Val F1 (weighted): 0.6716
2025-12-24 08:18:38 - INFO -   Val F1 (macro): 0.6088
2025-12-24 08:18:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:18:38 - INFO -   LR: 0.000035
2025-12-24 08:18:38 - INFO -   No improvement (patience: 7/10)
2025-12-24 08:22:09 - INFO - 
Epoch 31/50 - 210.24s
2025-12-24 08:22:09 - INFO -   Train Loss: 0.0263, Train Acc: 0.9597
2025-12-24 08:22:09 - INFO -   Val Loss: 0.3331
2025-12-24 08:22:09 - INFO -   Val Accuracy: 0.6537
2025-12-24 08:22:09 - INFO -   Val Balanced Acc: 0.6685
2025-12-24 08:22:09 - INFO -   Val F1 (weighted): 0.6630
2025-12-24 08:22:09 - INFO -   Val F1 (macro): 0.6358
2025-12-24 08:22:09 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:22:09 - INFO -   LR: 0.000032
2025-12-24 08:22:09 - INFO -   No improvement (patience: 8/10)
2025-12-24 08:25:38 - INFO - 
Epoch 32/50 - 209.13s
2025-12-24 08:25:38 - INFO -   Train Loss: 0.0252, Train Acc: 0.9590
2025-12-24 08:25:38 - INFO -   Val Loss: 0.3125
2025-12-24 08:25:38 - INFO -   Val Accuracy: 0.7062
2025-12-24 08:25:38 - INFO -   Val Balanced Acc: 0.7097
2025-12-24 08:25:38 - INFO -   Val F1 (weighted): 0.7148
2025-12-24 08:25:38 - INFO -   Val F1 (macro): 0.6663
2025-12-24 08:25:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:25:38 - INFO -   LR: 0.000029
2025-12-24 08:25:40 - INFO -   Saved best model (balanced_accuracy: 0.7097)
2025-12-24 08:29:10 - INFO - 
Epoch 33/50 - 210.12s
2025-12-24 08:29:10 - INFO -   Train Loss: 0.0235, Train Acc: 0.9626
2025-12-24 08:29:10 - INFO -   Val Loss: 0.3255
2025-12-24 08:29:10 - INFO -   Val Accuracy: 0.6680
2025-12-24 08:29:10 - INFO -   Val Balanced Acc: 0.6729
2025-12-24 08:29:10 - INFO -   Val F1 (weighted): 0.6774
2025-12-24 08:29:10 - INFO -   Val F1 (macro): 0.6442
2025-12-24 08:29:10 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:29:10 - INFO -   LR: 0.000026
2025-12-24 08:29:10 - INFO -   No improvement (patience: 1/10)
2025-12-24 08:32:39 - INFO - 
Epoch 34/50 - 208.94s
2025-12-24 08:32:39 - INFO -   Train Loss: 0.0194, Train Acc: 0.9663
2025-12-24 08:32:39 - INFO -   Val Loss: 0.3237
2025-12-24 08:32:39 - INFO -   Val Accuracy: 0.6578
2025-12-24 08:32:39 - INFO -   Val Balanced Acc: 0.7098
2025-12-24 08:32:39 - INFO -   Val F1 (weighted): 0.6695
2025-12-24 08:32:39 - INFO -   Val F1 (macro): 0.6696
2025-12-24 08:32:39 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:32:39 - INFO -   LR: 0.000023
2025-12-24 08:32:41 - INFO -   Saved best model (balanced_accuracy: 0.7098)
2025-12-24 08:36:10 - INFO - 
Epoch 35/50 - 208.95s
2025-12-24 08:36:10 - INFO -   Train Loss: 0.0177, Train Acc: 0.9690
2025-12-24 08:36:10 - INFO -   Val Loss: 0.3261
2025-12-24 08:36:10 - INFO -   Val Accuracy: 0.6721
2025-12-24 08:36:10 - INFO -   Val Balanced Acc: 0.7100
2025-12-24 08:36:10 - INFO -   Val F1 (weighted): 0.6832
2025-12-24 08:36:10 - INFO -   Val F1 (macro): 0.6879
2025-12-24 08:36:10 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:36:10 - INFO -   LR: 0.000021
2025-12-24 08:36:12 - INFO -   Saved best model (balanced_accuracy: 0.7100)
2025-12-24 08:39:42 - INFO - 
Epoch 36/50 - 210.01s
2025-12-24 08:39:42 - INFO -   Train Loss: 0.0166, Train Acc: 0.9721
2025-12-24 08:39:42 - INFO -   Val Loss: 0.3285
2025-12-24 08:39:42 - INFO -   Val Accuracy: 0.6996
2025-12-24 08:39:42 - INFO -   Val Balanced Acc: 0.7090
2025-12-24 08:39:42 - INFO -   Val F1 (weighted): 0.7095
2025-12-24 08:39:42 - INFO -   Val F1 (macro): 0.6877
2025-12-24 08:39:42 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:39:42 - INFO -   LR: 0.000018
2025-12-24 08:39:42 - INFO -   No improvement (patience: 1/10)
2025-12-24 08:43:11 - INFO - 
Epoch 37/50 - 209.01s
2025-12-24 08:43:11 - INFO -   Train Loss: 0.0174, Train Acc: 0.9725
2025-12-24 08:43:11 - INFO -   Val Loss: 0.3530
2025-12-24 08:43:11 - INFO -   Val Accuracy: 0.6553
2025-12-24 08:43:11 - INFO -   Val Balanced Acc: 0.6891
2025-12-24 08:43:11 - INFO -   Val F1 (weighted): 0.6600
2025-12-24 08:43:11 - INFO -   Val F1 (macro): 0.6599
2025-12-24 08:43:11 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:43:11 - INFO -   LR: 0.000016
2025-12-24 08:43:11 - INFO -   No improvement (patience: 2/10)
2025-12-24 08:46:40 - INFO - 
Epoch 38/50 - 208.95s
2025-12-24 08:46:40 - INFO -   Train Loss: 0.0129, Train Acc: 0.9756
2025-12-24 08:46:40 - INFO -   Val Loss: 0.3208
2025-12-24 08:46:40 - INFO -   Val Accuracy: 0.7091
2025-12-24 08:46:40 - INFO -   Val Balanced Acc: 0.7024
2025-12-24 08:46:40 - INFO -   Val F1 (weighted): 0.7179
2025-12-24 08:46:40 - INFO -   Val F1 (macro): 0.6914
2025-12-24 08:46:40 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:46:40 - INFO -   LR: 0.000014
2025-12-24 08:46:40 - INFO -   No improvement (patience: 3/10)
2025-12-24 08:50:09 - INFO - 
Epoch 39/50 - 209.18s
2025-12-24 08:50:09 - INFO -   Train Loss: 0.0115, Train Acc: 0.9778
2025-12-24 08:50:09 - INFO -   Val Loss: 0.3511
2025-12-24 08:50:09 - INFO -   Val Accuracy: 0.6935
2025-12-24 08:50:09 - INFO -   Val Balanced Acc: 0.6968
2025-12-24 08:50:09 - INFO -   Val F1 (weighted): 0.7030
2025-12-24 08:50:09 - INFO -   Val F1 (macro): 0.6807
2025-12-24 08:50:09 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:50:09 - INFO -   LR: 0.000011
2025-12-24 08:50:09 - INFO -   No improvement (patience: 4/10)
2025-12-24 08:53:39 - INFO - 
Epoch 40/50 - 210.33s
2025-12-24 08:53:39 - INFO -   Train Loss: 0.0109, Train Acc: 0.9789
2025-12-24 08:53:39 - INFO -   Val Loss: 0.3534
2025-12-24 08:53:39 - INFO -   Val Accuracy: 0.7078
2025-12-24 08:53:39 - INFO -   Val Balanced Acc: 0.7067
2025-12-24 08:53:39 - INFO -   Val F1 (weighted): 0.7159
2025-12-24 08:53:39 - INFO -   Val F1 (macro): 0.7063
2025-12-24 08:53:39 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:53:39 - INFO -   LR: 0.000010
2025-12-24 08:53:39 - INFO -   No improvement (patience: 5/10)
2025-12-24 08:57:09 - INFO - 
Epoch 41/50 - 209.61s
2025-12-24 08:57:09 - INFO -   Train Loss: 0.0102, Train Acc: 0.9818
2025-12-24 08:57:09 - INFO -   Val Loss: 0.3443
2025-12-24 08:57:09 - INFO -   Val Accuracy: 0.6795
2025-12-24 08:57:09 - INFO -   Val Balanced Acc: 0.6949
2025-12-24 08:57:09 - INFO -   Val F1 (weighted): 0.6882
2025-12-24 08:57:09 - INFO -   Val F1 (macro): 0.6852
2025-12-24 08:57:09 - INFO -   Val AUC (macro): 0.0000
2025-12-24 08:57:09 - INFO -   LR: 0.000008
2025-12-24 08:57:09 - INFO -   No improvement (patience: 6/10)
2025-12-24 09:00:38 - INFO - 
Epoch 42/50 - 209.15s
2025-12-24 09:00:38 - INFO -   Train Loss: 0.0088, Train Acc: 0.9824
2025-12-24 09:00:38 - INFO -   Val Loss: 0.3310
2025-12-24 09:00:38 - INFO -   Val Accuracy: 0.7218
2025-12-24 09:00:38 - INFO -   Val Balanced Acc: 0.7046
2025-12-24 09:00:38 - INFO -   Val F1 (weighted): 0.7284
2025-12-24 09:00:38 - INFO -   Val F1 (macro): 0.6987
2025-12-24 09:00:38 - INFO -   Val AUC (macro): 0.0000
2025-12-24 09:00:38 - INFO -   LR: 0.000006
2025-12-24 09:00:38 - INFO -   No improvement (patience: 7/10)
2025-12-24 09:04:08 - INFO - 
Epoch 43/50 - 210.07s
2025-12-24 09:04:08 - INFO -   Train Loss: 0.0088, Train Acc: 0.9828
2025-12-24 09:04:08 - INFO -   Val Loss: 0.3423
2025-12-24 09:04:08 - INFO -   Val Accuracy: 0.7197
2025-12-24 09:04:08 - INFO -   Val Balanced Acc: 0.6946
2025-12-24 09:04:08 - INFO -   Val F1 (weighted): 0.7261
2025-12-24 09:04:08 - INFO -   Val F1 (macro): 0.6980
2025-12-24 09:04:08 - INFO -   Val AUC (macro): 0.0000
2025-12-24 09:04:08 - INFO -   LR: 0.000005
2025-12-24 09:04:08 - INFO -   No improvement (patience: 8/10)
2025-12-24 09:07:36 - INFO - 
Epoch 44/50 - 208.58s
2025-12-24 09:07:36 - INFO -   Train Loss: 0.0074, Train Acc: 0.9838
2025-12-24 09:07:36 - INFO -   Val Loss: 0.3595
2025-12-24 09:07:36 - INFO -   Val Accuracy: 0.7222
2025-12-24 09:07:36 - INFO -   Val Balanced Acc: 0.6863
2025-12-24 09:07:36 - INFO -   Val F1 (weighted): 0.7280
2025-12-24 09:07:36 - INFO -   Val F1 (macro): 0.7004
2025-12-24 09:07:36 - INFO -   Val AUC (macro): 0.0000
2025-12-24 09:07:36 - INFO -   LR: 0.000004
2025-12-24 09:07:36 - INFO -   No improvement (patience: 9/10)
2025-12-24 09:11:06 - INFO - 
Epoch 45/50 - 209.27s
2025-12-24 09:11:06 - INFO -   Train Loss: 0.0068, Train Acc: 0.9842
2025-12-24 09:11:06 - INFO -   Val Loss: 0.3562
2025-12-24 09:11:06 - INFO -   Val Accuracy: 0.7292
2025-12-24 09:11:06 - INFO -   Val Balanced Acc: 0.6980
2025-12-24 09:11:06 - INFO -   Val F1 (weighted): 0.7354
2025-12-24 09:11:06 - INFO -   Val F1 (macro): 0.7103
2025-12-24 09:11:06 - INFO -   Val AUC (macro): 0.0000
2025-12-24 09:11:06 - INFO -   LR: 0.000002
2025-12-24 09:11:06 - INFO -   No improvement (patience: 10/10)
2025-12-24 09:11:06 - INFO - 
Early stopping at epoch 45
2025-12-24 09:11:06 - INFO - 
================================================================================
2025-12-24 09:11:06 - INFO - TRAINING COMPLETE
2025-12-24 09:11:06 - INFO - ================================================================================
2025-12-24 09:11:06 - INFO - Total time: 160.15 minutes
2025-12-24 09:11:06 - INFO - Best balanced_accuracy: 0.7100 (epoch 35)
2025-12-24 09:11:06 - INFO - Average time per epoch: 213.53 seconds
2025-12-24 09:11:06 - INFO - Model saved to: models/vit_fold5_20251224_063054
2025-12-24 09:11:06 - INFO - 
Results saved to: models/vit_fold5_20251224_063054/final_results.json
